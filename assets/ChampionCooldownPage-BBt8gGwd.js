import{r as V,j as e,A as Ge,E as Ne,F as Ke,K as Ue,G as We,I as Ze,J as qe,L as Je,M as Xe,N as ye,Q as we,d as z,U as ft,z as Dt}from"/cooldown/assets/react-vendor-CopeUkDP.js";import{C as xt,a as pt}from"/cooldown/assets/useDebouncedValue-DgzLwMKY.js";import{m as _,n as he,u as ne,B as xe,C as se,o as I,p as Bt,a as Ye,P as Mt,q as tt,D as It,c as Ft,V as Ot,d as zt,e as Ht,S as gt,f as rt,h as st,i as nt,T as ze,r as le,s as at,t as Gt,v as Be}from"/cooldown/assets/index-Cs7-zRHv.js";import{C as Ee}from"/cooldown/assets/ChampionSelector-DXkhYwoo.js";import{g as Le,h as Re,X as _e,T as ot,f as Kt,S as Ut,R as Wt}from"/cooldown/assets/lucide-icons-DTvcjo7T.js";import{u as bt,V as Zt,T as qt,a as Jt,b as lt}from"/cooldown/assets/VersionContext-B6f6l6-C.js";const pe=V.forwardRef(({className:t,...r},n)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:n,className:_("w-full caption-bottom text-sm",t),...r})}));pe.displayName="Table";const ge=V.forwardRef(({className:t,...r},n)=>e.jsx("thead",{ref:n,className:_("[&_tr]:border-b",t),...r}));ge.displayName="TableHeader";const be=V.forwardRef(({className:t,...r},n)=>e.jsx("tbody",{ref:n,className:_("[&_tr:last-child]:border-0",t),...r}));be.displayName="TableBody";const Xt=V.forwardRef(({className:t,...r},n)=>e.jsx("tfoot",{ref:n,className:_("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...r}));Xt.displayName="TableFooter";const J=V.forwardRef(({className:t,...r},n)=>e.jsx("tr",{ref:n,className:_("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...r}));J.displayName="TableRow";const K=V.forwardRef(({className:t,...r},n)=>e.jsx("th",{ref:n,className:_("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...r}));K.displayName="TableHead";const B=V.forwardRef(({className:t,...r},n)=>e.jsx("td",{ref:n,className:_("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...r}));B.displayName="TableCell";const Yt=V.forwardRef(({className:t,...r},n)=>e.jsx("caption",{ref:n,className:_("mt-4 text-sm text-muted-foreground",t),...r}));Yt.displayName="TableCaption";function ht(t="ko_KR"){const r=he(t);return[{key:"hp",label:r.stats.health,format:n=>Math.round(n)},{key:"hpperlevel",label:r.stats.healthPerLevel,format:n=>n.toFixed(1)},{key:"mp",label:r.stats.mana,format:n=>Math.round(n)},{key:"mpperlevel",label:r.stats.manaPerLevel,format:n=>n.toFixed(1)},{key:"movespeed",label:r.stats.movespeed,format:n=>Math.round(n)},{key:"armor",label:r.stats.armor,format:n=>Math.round(n)},{key:"armorperlevel",label:r.stats.armorPerLevel,format:n=>n.toFixed(1)},{key:"spellblock",label:r.stats.spellblock,format:n=>Math.round(n)},{key:"spellblockperlevel",label:r.stats.spellblockPerLevel,format:n=>n.toFixed(1)},{key:"attackdamage",label:r.stats.attackdamage,format:n=>Math.round(n)},{key:"attackdamageperlevel",label:r.stats.attackdamagePerLevel,format:n=>n.toFixed(1)},{key:"attackspeed",label:r.stats.attackspeed,format:n=>n.toFixed(3)},{key:"attackspeedperlevel",label:r.stats.attackspeedPerLevel,format:n=>`${(n*100).toFixed(1)}%`},{key:"attackrange",label:r.stats.attackrange,format:n=>Math.round(n)},{key:"crit",label:r.stats.crit,format:n=>`${(n*100).toFixed(1)}%`},{key:"critperlevel",label:r.stats.critPerLevel,format:n=>`${(n*100).toFixed(1)}%`},{key:"hpregen",label:r.stats.hpregen,format:n=>n.toFixed(1)},{key:"hpregenperlevel",label:r.stats.hpregenPerLevel,format:n=>n.toFixed(1)},{key:"mpregen",label:r.stats.mpregen,format:n=>n.toFixed(1)},{key:"mpregenperlevel",label:r.stats.mpregenPerLevel,format:n=>n.toFixed(1)}]}const ve=["Q","W","E","R"];function Qt({champions:t,version:r,championList:n,onAddChampion:s,onRemoveChampion:a,onReorderChampions:m}){const{t:o,lang:d}=ne(),[b,u]=V.useState(!1),p=ht(d),S=Ge(Ne(We,{activationConstraint:{distance:8}}),Ne(Ue,{coordinateGetter:Ke})),k=v=>{},N=v=>{const{active:x,over:f}=v;if(f&&x.id!==f.id&&m){const c=t.findIndex(j=>j.id===x.id),l=t.findIndex(j=>j.id===f.id);c!==-1&&l!==-1&&m(c,l)}},C=({champion:v,children:x,className:f})=>{const{setNodeRef:c,transform:l,transition:j,isDragging:i}=ye({id:v.id,disabled:!0}),y={transform:l?we.Transform.toString(l):void 0,transition:i?j:void 0,opacity:i?.5:1};return e.jsx(B,{ref:c,style:y,className:f,children:x})},T=({champion:v,index:x})=>{const{attributes:f,listeners:c,setNodeRef:l,transform:j,transition:i,isDragging:h}=ye({id:v.id}),w={transform:j?we.Transform.toString(j):void 0,transition:h?i:void 0,opacity:h?.5:1};return e.jsx(K,{ref:l,style:w,className:_("text-center p-1.5 text-[11px] font-semibold text-foreground w-[100px] min-w-[100px] select-none",x<t.length-1&&"border-r border-border/30",h&&"z-50"),children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-1.5 relative",children:[m&&e.jsx("button",{...f,...c,className:"cursor-grab active:cursor-grabbing p-1 opacity-60 hover:opacity-100 transition-opacity absolute -left-2 top-1/2 -translate-y-1/2","aria-label":"Drag to reorder",children:e.jsx(Re,{className:"h-4 w-4 text-muted-foreground"})}),e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:se(r,v.id),alt:v.name,className:"w-8 h-8 rounded-full"}),a&&e.jsx(xe,{variant:"ghost",size:"icon",className:_("absolute -top-1 -right-1 h-4 w-4 rounded-full","bg-destructive/90 hover:bg-destructive text-white","hover:scale-110 transition-transform","shadow-md"),onClick:g=>{g.stopPropagation(),a(v.id)},"aria-label":`Remove ${v.name}`,children:e.jsx(_e,{className:"h-2.5 w-2.5"})})]}),e.jsx("div",{className:"text-[10px] font-semibold leading-tight text-center break-words text-foreground",children:v.name})]})})};return e.jsxs("div",{className:"relative",children:[e.jsx(Ze,{sensors:S,collisionDetection:qe,onDragStart:k,onDragEnd:N,children:e.jsx("div",{className:"border border-border/30 rounded-lg overflow-hidden",children:e.jsxs(pe,{className:"border-collapse table-fixed w-auto",children:[e.jsx(ge,{children:e.jsxs(J,{className:"border-b border-border/30 select-none",children:[e.jsx(K,{className:"text-left p-1.5 pl-2 text-[11px] font-semibold text-foreground sticky left-0 bg-card z-20 w-[90px] min-w-[90px] border-r border-border/30 select-none",style:{left:0},children:o.stats.label}),e.jsx(Je,{items:t.map(v=>v.id),strategy:Xe,children:t.map((v,x)=>e.jsx(T,{champion:v,index:x},v.id))}),s&&e.jsx(K,{className:"text-center p-1.5 text-[11px] font-semibold text-foreground w-[100px] min-w-[100px] border-l border-border/30 select-none",children:e.jsxs(xe,{onClick:()=>u(!0),variant:"outline",className:"w-full flex flex-row items-center justify-center gap-2 p-1.5 h-auto border-2 border-dashed border-muted-foreground/30 hover:border-primary/50 hover:bg-muted/30 group",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-muted/30 flex items-center justify-center group-hover:bg-primary/10 transition-colors",children:e.jsx(Le,{className:"w-4 h-4 text-muted-foreground group-hover:text-primary transition-colors"})}),e.jsx("div",{className:"text-[10px] text-muted-foreground group-hover:text-primary transition-colors whitespace-nowrap",children:"추가"})]})})]})}),e.jsx(be,{children:p.map(v=>{const x=t.map(l=>{var j;return((j=l.stats)==null?void 0:j[v.key])??0}),f=Math.max(...x),c=Math.min(...x);return e.jsxs(J,{className:"border-b border-border/30 hover:bg-muted/30 transition-colors",children:[e.jsx(B,{className:"p-1.5 pl-2 text-[11px] font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",style:{wordBreak:"keep-all",left:0},children:v.label}),t.map((l,j)=>{var w;const i=((w=l.stats)==null?void 0:w[v.key])??0,h=i===f&&f!==c,y=i===c&&f!==c;return e.jsx(C,{champion:l,className:_("p-1.5 text-[11px] text-center",j<t.length-1&&"border-r border-border/30",h&&"text-primary font-semibold",y&&"text-muted-foreground"),children:v.format(i)},l.id)}),s&&e.jsx(B,{className:"p-1.5 text-center border-l border-border/30",children:e.jsx("div",{className:"w-full h-full min-h-[24px]"})})]},v.key)})})]})})}),b&&s&&n&&e.jsx(Ee,{championList:n,selectedChampions:t,onSelect:v=>{s(v)},onClose:()=>u(!1)})]})}function er({champions:t,version:r,vsMode:n}){const{t:s,lang:a}=ne(),m=ht(a);if(n&&t.length===2){const o=n.championA,d=n.championB;return e.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:e.jsx("div",{className:"min-w-full",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"border border-border/30 rounded-lg overflow-hidden",children:e.jsxs(pe,{className:"border-collapse table-fixed w-auto min-w-full",children:[e.jsx(ge,{children:e.jsxs(J,{className:"border-b border-border/30 select-none",children:[e.jsx(K,{className:"text-left p-1.5 pl-2 text-[10px] font-semibold text-foreground sticky left-0 bg-card z-20 w-[50px] min-w-[50px] border-r border-border/30 select-none",style:{left:0},children:s.stats.label}),e.jsx(K,{className:"text-center p-1.5 text-[10px] font-semibold text-foreground w-1/2 border-r border-border/30 select-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-0.5",children:[e.jsx("img",{src:se(r,o.id),alt:o.name,className:"w-6 h-6 rounded-full",draggable:"false"}),e.jsx("div",{className:"text-xs font-semibold leading-tight text-center text-foreground",children:o.name})]})}),e.jsx(K,{className:"text-center p-1.5 text-[10px] font-semibold text-foreground w-[40px] min-w-[40px] border-r border-border/30 bg-muted/20 select-none",children:e.jsx("div",{className:"text-[9px] font-bold",children:"VS"})}),e.jsx(K,{className:"text-center p-1.5 text-[10px] font-semibold text-foreground w-1/2 select-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-0.5",children:[e.jsx("img",{src:se(r,d.id),alt:d.name,className:"w-6 h-6 rounded-full",draggable:"false"}),e.jsx("div",{className:"text-xs font-semibold leading-tight text-center text-foreground",children:d.name})]})})]})}),e.jsx(be,{children:m.map(b=>{var N,C;const u=((N=o.stats)==null?void 0:N[b.key])??0,p=((C=d.stats)==null?void 0:C[b.key])??0,S=Math.max(u,p),k=Math.min(u,p);return e.jsxs(J,{className:"border-b border-border/30 hover:bg-muted/30 transition-colors",children:[e.jsx(B,{className:"p-1.5 pl-2 text-[10px] font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",style:{wordBreak:"keep-all",left:0},children:b.label}),e.jsx(B,{className:_("p-1.5 text-[10px] text-center border-r border-border/30",u===S&&S!==k&&"text-primary font-semibold",u===k&&S!==k&&"text-muted-foreground"),children:b.format(u)}),e.jsx(B,{className:"p-1.5 border-r border-border/30 bg-muted/20 select-none"}),e.jsx(B,{className:_("p-1.5 text-[10px] text-center",p===S&&S!==k&&"text-primary font-semibold",p===k&&S!==k&&"text-muted-foreground"),children:b.format(p)})]},b.key)})})]})})})})})}return e.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:e.jsx("div",{className:"min-w-full",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"border border-border/30 rounded-lg overflow-hidden",children:e.jsxs(pe,{className:"border-collapse table-fixed w-auto min-w-full",children:[e.jsx(ge,{children:e.jsxs(J,{className:"border-b border-border/30 select-none",children:[e.jsx(K,{className:"text-left p-1.5 pl-2 text-[11px] font-semibold text-foreground sticky left-0 bg-card z-20 w-[70px] min-w-[70px] border-r border-border/30 select-none",style:{left:0},children:s.stats.label}),t.map(o=>e.jsx(K,{className:"text-center p-1.5 text-[11px] font-semibold text-foreground w-full select-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-1",children:[e.jsx("img",{src:se(r,o.id),alt:o.name,className:"w-8 h-8 rounded-full",draggable:"false"}),e.jsx("div",{className:"text-sm font-semibold leading-tight text-center text-foreground",children:o.name})]})},o.id))]})}),e.jsx(be,{children:m.map(o=>{const d=t.map(p=>{var S;return((S=p.stats)==null?void 0:S[o.key])??0}),b=Math.max(...d),u=Math.min(...d);return e.jsxs(J,{className:"border-b border-border/30 hover:bg-muted/30 transition-colors",children:[e.jsx(B,{className:"p-1.5 pl-2 text-[11px] font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",style:{wordBreak:"keep-all",left:0},children:o.label}),t.map(p=>{var C;const S=((C=p.stats)==null?void 0:C[o.key])??0,k=S===b&&b!==u,N=S===u&&b!==u;return e.jsx(B,{className:_("p-1.5 text-[11px] text-center",k&&"text-primary font-semibold",N&&"text-muted-foreground"),children:o.format(S)},p.id)})]},o.key)})})]})})})})})}async function tr(t,r,n){const s={};let a=null;try{a=await Bt(t,n);const m=a.spellDataMap;for(const[o,d]of Object.entries(m))d&&typeof d=="object"&&(s[o]=d)}catch(m){I.warn(`Failed to load Community Dragon data for ${t}:`,m)}return r.map((m,o)=>{let d={};if(s[o.toString()])d=s[o.toString()];else{const b=m.id.replace(t,"");for(const u of Object.keys(s))if(u.toLowerCase().includes(b.toLowerCase())||u.toLowerCase().includes(m.id.toLowerCase())){d=s[u];break}}return{spell:m,communityDragonData:d,spellIndex:o,ddragonVersion:(a==null?void 0:a.ddragonVersion)??n,cdragonVersion:(a==null?void 0:a.cdragonVersion)??null}})}async function jt(t,r){const n={},s=t.map(async a=>{if(!a.spells||a.spells.length===0){n[a.id]=[];return}try{n[a.id]=await tr(a.id,a.spells,r)}catch(m){I.warn(`Failed to get integrated spell data for ${a.id}:`,m),n[a.id]=a.spells.map((o,d)=>({spell:o,communityDragonData:{},spellIndex:d}))}});return await Promise.all(s),n}const Me={physicalDamage:{tag:"span",className:"text-red-600 dark:text-red-500 font-semibold"},magicDamage:{tag:"span",className:"text-blue-600 dark:text-blue-500 font-semibold"},trueDamage:{tag:"span",className:"text-yellow-600 dark:text-yellow-500 font-semibold"},status:{tag:"span",className:"text-purple-600 dark:text-purple-500"},lifeSteal:{tag:"span",className:"text-green-600 dark:text-green-500"},scaleAD:{tag:"span",className:"text-orange-600 dark:text-orange-500"},scaleAP:{tag:"span",className:"text-blue-600 dark:text-blue-400"},scaleArmor:{tag:"span",className:"text-orange-600 dark:text-orange-400"},scaleLevel:{tag:"span",className:"text-gray-600 dark:text-gray-400"},healing:{tag:"span",className:"text-green-600 dark:text-green-400"},speed:{tag:"span",className:"text-cyan-600 dark:text-cyan-500"},keywordMajor:{tag:"span",className:"text-yellow-600 dark:text-yellow-400 font-semibold"},keywordStealth:{tag:"span",className:"text-purple-600 dark:text-purple-400 font-semibold"},spellPassive:{tag:"span",className:"text-gray-600 dark:text-gray-500 italic"},spellActive:{tag:"span",className:"text-gray-900 dark:text-white font-semibold"},recast:{tag:"span",className:"text-yellow-600 dark:text-yellow-300"},damage:{tag:"span",className:"text-red-600 dark:text-red-400"},shield:{tag:"span",className:"text-blue-600 dark:text-blue-300"},mana:{tag:"span",className:"text-blue-600 dark:text-blue-400"},energy:{tag:"span",className:"text-yellow-600 dark:text-yellow-400"},health:{tag:"span",className:"text-red-600 dark:text-red-400"},cooldown:{tag:"span",className:"text-gray-600 dark:text-gray-300"},range:{tag:"span",className:"text-cyan-600 dark:text-cyan-400"},radius:{tag:"span",className:"text-purple-600 dark:text-purple-400"},width:{tag:"span",className:"text-indigo-600 dark:text-indigo-400"},length:{tag:"span",className:"text-pink-600 dark:text-pink-400"},rules:{tag:"span",className:"text-gray-600 dark:text-gray-400 italic"}};function rr(t){let r=t;r=r.replace(/<font\s+color=['"]([^'"]+)['"]\s*>/gi,'<span style="color: $1">'),r=r.replace(/<\/font>/gi,"</span>"),Object.entries(Me).forEach(([s,{tag:a,className:m}])=>{const o=new RegExp(`</${s}>`,"gi");r=r.replace(o,`</${a}>`);const d=new RegExp(`<${s}>`,"gi");r=r.replace(d,`<${a}${m?` class="${m}"`:""}>`)});const n=["keywordMajor","keywordStealth","rules","recast"];return n.forEach(s=>{r=r.replace(new RegExp(`</${s}>`,"gi"),"</span>"),s==="rules"?r=r.replace(new RegExp(`<${s}>`,"gi"),'<span class="text-gray-600 dark:text-gray-400 italic">'):s==="keywordStealth"?r=r.replace(new RegExp(`<${s}>`,"gi"),'<span class="text-purple-600 dark:text-purple-400 font-semibold">'):r=r.replace(new RegExp(`<${s}>`,"gi"),'<span class="text-yellow-600 dark:text-yellow-400 font-semibold">')}),r=r.replace(/<(\w+)(?![\\w])>/gi,(s,a)=>Me[a]||n.includes(a)||a==="font"||a==="br"?s:"<span>"),r=r.replace(/<\/(\w+)(?![\\w])>/gi,(s,a)=>Me[a]||n.includes(a)||a==="font"||a==="br"?s:"</span>"),r}function vt(t){const r=t.trim(),n=new RegExp("^([a-zA-Z_][a-zA-Z0-9_]*)\\s*([*+/-])\\s*(-?\\d+(?:\\.\\d+)?)$"),s=r.match(n);if(s){const a=s[2];return{type:"formula",variable:s[1],operator:a,operand:parseFloat(s[3])}}return{type:"variable",variable:r}}function Nt(t,r,n){if(!r||typeof r!="string")return null;const s=Object.entries(t).find(([b])=>b!=null&&b.toLowerCase()===r.toLowerCase());if(!s)return null;const[,a]=s,m=a.slice(1,n+1);if(m.length===0)return null;const o=m[0];return m.every(b=>b===o)?o:m}function yt(t,r){if(r.type!=="formula"||!r.operator||r.operand==null)return t;const{operator:n,operand:s}=r;return n==="*"?Array.isArray(t)?t.map(a=>a*s):t*s:n==="+"?Array.isArray(t)?t.map(a=>a+s):t+s:n==="-"?Array.isArray(t)?t.map(a=>a-s):t-s:n==="/"?Array.isArray(t)?t.map(a=>a/s):t/s:t}function ue(t){if(t==null||t==="")return"";const r=typeof t=="number"?t:parseFloat(String(t));return isNaN(r)?String(t):r%1===0?r.toString():parseFloat(r.toFixed(3)).toString()}function it(t,r,n=!1){if(!t||t.length===0)return"";const s=n&&t.length>1?1:0,m=t.slice(s).filter(p=>p!=null&&p!==""&&p!=="0");if(m.length===0)return"";const o=r?m.slice(0,r):m;if(o.length===0)return"";const d=o.map(p=>ue(p)),b=d[0];return d.every(p=>p===b)?b:d.join("/")}function sr(t){let r=t;return r=r.replace(/<br\s*\/?>/gi,"<br />"),r=r.replace(/[^\S\r\n]+/g," "),r}function Q(t){return Array.isArray(t)}function ct(t,r){return Array.isArray(t)?t:Array.from({length:r},()=>t)}function wt(t,r,n){if(!Q(t)&&!Q(r))return n(t,r);const s=Q(t)?t:ct(t,Q(r)?r.length:1),a=Q(r)?r:ct(r,s.length);if(s.length!==a.length)throw new Error(`Vector length mismatch: ${s.length} vs ${a.length}`);return s.map((m,o)=>n(m,a[o]))}function Se(t,r){return wt(t,r,(n,s)=>n+s)}function ke(t,r){return wt(t,r,(n,s)=>n*s)}function $e(t){return Q(t)?t.every(n=>n===t[0])?ue(t[0]):t.map(n=>ue(n)).join("/"):ue(t)}function Ie(t){return Q(t)?t.map(r=>r*100):t*100}function dt(t,r,n="ko_KR"){const s=he(n),a=t!=null,m=r!=null;if(!a&&!m)return s.stats.abilityPower;const o=t??r;return o===2?t===2&&r===2?s.stats.bonusAttackDamage:s.stats.attackDamage:o===12?t===12&&r===2?s.stats.bonusHealth:s.stats.health:o===1?t===1&&r===2?s.stats.bonusArmor:s.stats.armor:o===6?t===6&&r===2?s.stats.bonusMagicResist:s.stats.magicResist:o===18?t===18&&r===2?s.stats.bonusLifesteal:s.stats.lifesteal:""}function He(t,r="ko_KR"){const s=he(r).common.mana;if(t.costType){const a=t.costType.trim();return a&&!a.includes("{{")?a:t.resource&&!t.resource.includes("{{")?t.resource:s}return t.resource&&!t.resource.includes("{{")?t.resource:s}function Ct(t,r,n){const s=n==null?void 0:n.DataValues;if(!s)return null;const a=Nt(s,t.variable,r.maxrank);if(a==null)return null;const m=yt(a,t);return $e(m)}function ut(t,r){const n=s=>Number.isFinite(s)?s.toFixed(r).replace(/\.?0+$/,""):String(s);if(Q(t)){const s=t.map(o=>n(o)),a=s[0];return s.every(o=>o===a)?a:s.join("/")}return n(t)}function nr(t,r,n,s="ko_KR"){const a=n==null?void 0:n.mSpellCalculations,m=n==null?void 0:n.DataValues;if(!a)return null;const o=Object.entries(a).find(([l])=>l!=null&&l.toLowerCase()===t.variable.toLowerCase());if(!o)return null;const[d]=o;function b(l){if(!l||typeof l!="string")return I.debug(`DataValue name is invalid: ${l}`),null;if(!m)return I.debug("dataValues is undefined"),null;const j=Nt(m,l,r.maxrank);return j??(I.debug(`DataValue "${l}" missing`),null)}function u(l,j=new Set){var y;if(!a)throw new Error("spellCalcs is undefined");const i=a[l];if(!i)throw new Error(`SpellCalculation "${l}" not found`);if(j.has(l))throw new Error(`Circular reference in mSpellCalculations: ${l}`);j.add(l);const h=i&&typeof i=="object"&&"__type"in i?i.__type:"unknown";if(i.__type==="GameCalculationModified"){const w=i;if(!w.mModifiedGameCalculation)throw new Error("mModifiedGameCalculation is missing");const g=u(w.mModifiedGameCalculation,j);if(!w.mMultiplier)return g;let A=null;if(w.mMultiplier.mDataValue){if(A=b(w.mMultiplier.mDataValue),A==null)return g}else w.mMultiplier.mNumber!=null&&(A=w.mMultiplier.mNumber);if(A==null)return g;const D=ke(g.base,A),F=g.statParts.map(U=>({name:U.name,ratio:ke(U.ratio,A)}));return{base:D,statParts:F,isPercent:g.isPercent,precision:g.precision}}if(i.__type==="GameCalculation"){const w=i,g=w.mFormulaParts??[];let A=0;const D=[],F=!!w.mDisplayAsPercent;if(g.length===1&&g[0]&&typeof g[0]=="object"&&"__type"in g[0]&&g[0].__type==="ByCharLevelBreakpointsCalculationPart"&&w.mSimpleTooltipCalculationDisplay===6){const L=g[0],R=L.mLevel1Value??0;let $=R;for(const M of L.mBreakpoints??[])typeof M.mAdditionalBonusAtThisLevel=="number"&&($+=M.mAdditionalBonusAtThisLevel);return{base:[R,$],statParts:[],isPercent:F,isBreakpointRange:!0,precision:void 0}}if(g.length===1&&g[0]&&typeof g[0]=="object"&&"__type"in g[0]&&g[0].__type==="ByCharLevelBreakpointsCalculationPart"&&F){const L=g[0],R=L.mLevel1Value??0,$=L.mInitialBonusPerLevel??0,E=(L.mBreakpoints??[])[0];if($!==0&&(E!=null&&E.mLevel)){const O=E.mLevel-1,M=Math.max(O-1,0),H=R+M*$;return{base:[R,H],statParts:[],isPercent:!0,isCharLevelRange:!0,precision:void 0}}}if(g.length===1&&g[0]&&typeof g[0]=="object"&&"__type"in g[0]&&g[0].__type==="ByCharLevelInterpolationCalculationPart"&&F){const L=g[0],R=L.mStartValue??0,$=L.mEndValue??R;return{base:[R,$],statParts:[],isPercent:!0,isCharLevelRange:!0,precision:void 0}}for(const L of g){const R=L.__type;if(R==="NamedDataValueCalculationPart"){const $=L;if(!$.mDataValue){I.debug("NamedDataValueCalculationPart missing mDataValue",L);continue}const E=b($.mDataValue);if(E==null)continue;A=Se(A,E)}else if(R==="EffectValueCalculationPart"){const E=L.mEffectIndex??0,O=((y=r.effectBurn)==null?void 0:y[E])??null;if(!O)I.debug(`EffectValueCalculationPart: effectBurn[${E}] is missing`,{spellId:r.id});else{const M=O.split("/").map(H=>parseFloat(H)).filter(H=>!Number.isNaN(H));if(M.length>0){const H=M.length>r.maxrank?M.slice(0,r.maxrank):M;A=Se(A,H)}}}else if(R==="StatByNamedDataValueCalculationPart"){const $=L;if(!$.mDataValue){I.debug("StatByNamedDataValueCalculationPart missing mDataValue",L);continue}const E=b($.mDataValue);if(E==null)continue;const O=dt($.mStat,$.mStatFormula,s);D.push({name:O,ratio:E})}else if(R==="StatByCoefficientCalculationPart"){const $=L;if($.mCoefficient==null){I.debug("StatByCoefficientCalculationPart missing mCoefficient",L);continue}const E=dt($.mStat,$.mStatFormula,s),O=$.mCoefficient;D.push({name:E,ratio:O,isCoefficient:!0})}else if(R==="AbilityResourceByCoefficientCalculationPart"){const $=L;if($.mCoefficient==null){I.debug("AbilityResourceByCoefficientCalculationPart missing mCoefficient",L);continue}const E=He(r,s),O=he(s),H=$.mStatFormula===2?`${O.common.bonus} ${E}`:E,W=$.mCoefficient;D.push({name:H,ratio:W,isCoefficient:!0})}else if(R==="NumberCalculationPart"){const E=L.mNumber??0;A=Se(A,E)}else if(R==="ByCharLevelBreakpointsCalculationPart"){const $=L;let E=$.mLevel1Value||0;for(const O of $.mBreakpoints??[])O.mAdditionalBonusAtThisLevel!=null&&(E+=O.mAdditionalBonusAtThisLevel);A=Se(A,E)}else if(R==="ProductOfSubPartsCalculationPart"){const $=L,E=W=>{var ie;if(!W||typeof W!="object"||!("__type"in W))return 0;const ee=W.__type;if(!ee)return 0;if(ee==="NamedDataValueCalculationPart"){const oe=W;if(!oe.mDataValue)return I.debug("ProductOfSubPartsCalculationPart: NamedDataValueCalculationPart missing mDataValue",W),0;const ce=b(oe.mDataValue);return ce??0}if(ee==="NumberCalculationPart")return W.mNumber??0;if(ee==="EffectValueCalculationPart"){const ce=W.mEffectIndex??0,je=((ie=r.effectBurn)==null?void 0:ie[ce])??null;if(!je)return I.debug(`ProductOfSubPartsCalculationPart: EffectValueCalculationPart missing effectBurn[${ce}]`,{spellId:r.id}),0;let Ce;if(je.includes("/")){const G=je.split("/").map(re=>Number.parseFloat(re)).filter(re=>!Number.isNaN(re));if(G.length===0)return 0;Ce=G.length===1?G[0]:G}else{const G=Number.parseFloat(je);if(Number.isNaN(G))return 0;Ce=G}return Ce}return I.debug(`ProductOfSubPartsCalculationPart: unsupported sub part type "${ee}"`,W),0},O=E($.mPart1),M=E($.mPart2),H=ke(O,M);A=Se(A,H)}}let U=A,te=D;if(w.mMultiplier){let L=null;w.mMultiplier.mDataValue?(L=b(w.mMultiplier.mDataValue),L==null&&(L=null)):w.mMultiplier.mNumber!=null&&(L=w.mMultiplier.mNumber),L!=null&&(U=ke(U,L),te=te.map(R=>({...R,ratio:ke(R.ratio,L)})))}let ae;return typeof w.mPrecision=="number"&&w.mPrecision>=0?ae=w.mPrecision+1:ae=void 0,{base:U,statParts:te,isPercent:F,precision:ae}}throw new Error(`Unsupported mSpellCalculation type: ${h}`)}let p;try{p=u(d)}catch(l){return I.error("Failed to evaluate calculation:",l),null}let S;const k=p.precision;p.isPercent?k!=null?Q(p.base)?S=p.base.map(l=>l*100):S=p.base*100:S=Ie(p.base):S=p.base;const N=p.statParts.map(l=>{if(l.isCoefficient){const j=k!=null?Q(l.ratio)?l.ratio.map(i=>i*100):l.ratio*100:Ie(l.ratio);return{...l,ratio:j}}if(k!=null){const j=Q(l.ratio)?l.ratio.map(i=>i*100):l.ratio*100;return{...l,ratio:j}}return{...l,ratio:Ie(l.ratio)}});let C=null;const T=Q(S)&&S.length>0&&S.every(l=>l===0),v=!Q(S)&&S===0;if(!T&&!v)if(p.isCharLevelRange&&Q(S)&&S.length===2){const[l,j]=S,i=ue(l),h=ue(j);C=`(${i}% ~ ${h}%)`}else if(p.isBreakpointRange&&Q(S)&&S.length===2){const[l,j]=S,i=ue(l),h=ue(j);C=p.isPercent?`(${i}% ~ ${h}%)`:`(${i} ~ ${h})`}else{const l=k!=null?ut(S,k):$e(S);C=p.isPercent?`${l}%`:l}const x=N.map(l=>{const j=k!=null?ut(l.ratio,k):$e(l.ratio);return l.name?`(${j}% ${l.name})`:`(${j}%)`}),f=[];if(C&&f.push(C),f.push(...x),f.length===0)return null;const c=f.join(" + ");return f.length===1?c:`(${c})`}function ar(t,r){return!Number.isFinite(r)||r<0?t:t.replace(/-?\d+(?:\.\d+)?/g,n=>{const s=Number.parseFloat(n);return Number.isFinite(s)?s.toFixed(r):n})}function or(t){return t.replace(/(}})\s*\+\s*(\S)/g,"$1 + $2").replace(/(\S)\s*\+\s*({{)/g,"$1 + $2").replace(/(\S)\s*~\s*(\S)/g,"$1 ~ $2")}function lr(t){return t.replace(/\{\{([^}]*\{\{[^}]*}}[^}]*)}}/g,()=>"")}function ir(t){let r=t;return r=r.replace(/\{\{Spell_[^}]*Tooltip[^}]*}}/gi,""),r=r.replace(/\{\{spellmodifierdescriptionappend}}/gi,""),r}function cr(t,r,n,s){const a=/\{\{([^}]+)}}/g;return t.replace(a,(m,o)=>{const d=String(o).trim();if(d==="spellmodifierdescriptionappend"||d.includes("gamemodeinteger")||d.includes("Spell_")&&d.includes("Tooltip"))return"";let b=d,u;const p=/^([a-zA-Z_][a-zA-Z0-9_]*)(?:\.(\d+))(.*)$/.exec(d);if(p){const[,k,N,C]=p,T=Number.parseInt(N,10);Number.isFinite(T)&&(u=T,b=`${k}${C}`)}const S=ur(b,r,n,s);return S!==null?u!==void 0?ar(S,u):S:""})}function dr(t){let r=t;return r=r.replace(/\{\{\s*\}/g,""),r=r.replace(/\}\}/g,""),r=r.replace(/\{\{/g,""),r=r.replace(/%[^\s:%]+:[^\s%]+%/g,""),r=r.replace(/\s+%\s+/g," "),r=r.replace(new RegExp("(?<!\\d)\\s*%\\s*(?!\\d)","g"),""),r=r.replace(/^\s*%\s*(?!\d)/g,""),r=r.replace(new RegExp("(?<!\\d)\\s*%\\s*$","g"),""),r=r.replace(/[^\S\r\n]+/g," "),r}function St(t,r,n,s="ko_KR"){if(!r)return t;let a=t;return a=or(a),a=lr(a),a=ir(a),a=cr(a,r,n,s),a=dr(a),a}function ur(t,r,n,s="ko_KR"){const a=vt(t),m=mr(a,r,n);if(m!==null)return m;const o=Ct(a,r,n);return o!==null?o:nr(a,r,n,s)}function mr(t,r,n){const s=t.variable,a=/^e(\d+)$/i.exec(s);if(!a)return null;const m=Number.parseInt(a[1],10);if(!Number.isFinite(m)||m<=0)return null;const o=(n==null?void 0:n.effectBurn)??r.effectBurn;if(!o)return null;const d=o[m];if(!d)return null;let b;if(d.includes("/")){const p=d.split("/").map(S=>Number.parseFloat(S)).filter(S=>!Number.isNaN(S));if(p.length===0)return null;b=p.length===1?p[0]:p}else{const p=Number.parseFloat(d);if(Number.isNaN(p))return null;b=p}const u=yt(b,t);return $e(u)}function Fe(t,r,n,s="ko_KR"){if(!t)return"";let a=t;return a=rr(a),a=St(a,r,n,s),a=sr(a),a=a.replace(/\n/g,"<br />"),a}function mt(t,r,n="ko_KR"){const s=he(n);if(!t.leveltip||!t.leveltip.label||!t.leveltip.effect)return"";let a;r&&(r.DataValues?a=r:a={DataValues:r});const{label:m,effect:o}=t.leveltip,d=[];for(let b=0;b<m.length&&b<o.length;b++){const u=m[b],S=o[b].match(/\{\{\s*([^}]+)\s*\}\}/);if(!S)continue;const k=S[1].trim();let N=null;if(a)try{const v=vt(k),x=Ct(v,t,a);if(x&&x.trim()!==""){let f=x;(u.includes("%")||u.toLowerCase().includes("percent")||u.toLowerCase().includes("퍼센트")||u.toLowerCase().includes("둔화"))&&!f.includes("%")&&(f=f.split("/").map(i=>i&&`${i}%`).join("/"));const l=He(t,n),j=u.replace("@AbilityResourceName@",l);if(j.includes("{{")||j.includes("}}"))continue;d.push(`${j}: [${f}]`);continue}}catch{}const C=k;N=null;const T=C.match(/^e(\d+)$/i);if(T){const v=parseInt(T[1]);if(t.effectBurn&&t.effectBurn.length>v){const x=t.effectBurn[v];x&&x!==null&&x!=="0"&&(N=x)}}else if(C.toLowerCase()==="cost"||C.toLowerCase().includes("cost"))t.costBurn&&(N=t.costBurn);else if(C.toLowerCase().includes("cooldown"))t.cooldownBurn&&(N=t.cooldownBurn);else if(C.toLowerCase().includes("ammorechargetime")||C.toLowerCase().includes("ammorecharge")){const v=(r&&typeof r=="object"&&"DataValues"in r?r.DataValues:void 0)||r;if(v&&v.mAmmoRechargeTime){const x=v.mAmmoRechargeTime;if(Array.isArray(x)&&x.length>1){const c=x.slice(1).map(j=>typeof j=="number"?j:parseFloat(String(j))),l=it(c,t.maxrank,!1);l&&(N=l)}}}if(N){const v=it(N.includes("/")?N.split("/"):[N],t.maxrank);if(v){let x=s.common.mana;x=He(t,n);const f=u.replace("@AbilityResourceName@",x);if(f.includes("{{")||f.includes("}}"))continue;let c=v;(u.includes("%")||u.toLowerCase().includes("slow")||u.toLowerCase().includes("둔화"))&&(v.includes("%")||(c=v.split("/").map(l=>`${l}%`).join("/"))),d.push(`${f}: [${c}]`)}}}return d.length===0?"":d.join("<br />")}function fr(t,r,n="ko_KR"){var b;const s=he(n);if(!t||!t.cooldown||!Array.isArray(t.cooldown)||t.cooldown.length===0)return null;const a=r==null?void 0:r.communityDragonData,m=(a&&typeof a=="object"&&"DataValues"in a?a.DataValues:void 0)||a,o=m&&typeof m=="object"&&"mAmmoRechargeTime"in m?m.mAmmoRechargeTime:void 0;if(t.cooldown[0]===0&&o&&Array.isArray(o)&&o.length>1&&o){const u=o[1],p=((b=t.effectBurn)==null?void 0:b[1])||"3";return`${s.common.rechargeTime} ${u}${s.common.seconds} (${s.common.max}: ${p}${s.common.items})`}if(t.cooldownBurn){const u=t.cooldownBurn.split("/");return u.length>1&&u.every(p=>p===u[0])?`${u[0]}${s.common.seconds}`:`${t.cooldownBurn}${s.common.seconds}`}if(t.cooldown&&t.cooldown.length>0){const u=t.cooldown[0];return t.cooldown.every(p=>p===u)?`${u}${s.common.seconds}`:`${t.cooldown.join("/")}${s.common.seconds}`}return null}function fe(t){if(!t)return t;let r=t.replace(/\(\s*\)/g,"");return r=r.replace(/\s{2,}/g," ").trim(),r}function xr(t,r,n="ko_KR"){const s=he(n);if(!t)return null;const a=Array.isArray(t.cost)&&t.cost.length>0,m=a&&t.cost.every(d=>d===0),o=t.costBurn==="0";if((o||m)&&typeof t.resource=="string"&&t.resource.includes("{{")){const d=t.resource.trim(),b=r==null?void 0:r.communityDragonData,u=(b&&typeof b=="object"&&"DataValues"in b?b.DataValues:void 0)||b;if(u){const S=St(d,t,{DataValues:u}).trim();if(S)return fe(S)}return fe(s.common.noCost)}if(o||m)return fe(s.common.noCost);if(t.costBurn){const d=t.costBurn.split("/");return d.length>1&&d.every(b=>b===d[0])?fe(`${s.common.mana} ${d[0]}`):fe(`${s.common.mana} ${t.costBurn}`)}if(a&&t.cost){const d=t.cost[0];return t.cost.every(b=>b===d)?fe(`${s.common.mana} ${d}`):fe(`${s.common.mana} ${t.cost.join("/")}`)}return null}function kt(t,r,n){const s=n==null?void 0:n.communityDragonData,a=(s&&typeof s=="object"&&"DataValues"in s?s.DataValues:void 0)||s,m=a&&typeof a=="object"&&"mAmmoRechargeTime"in a?a.mAmmoRechargeTime:void 0,o=t.cooldown[r-1];return o===0&&m&&Array.isArray(m)&&m.length>r&&m?m[r]!==void 0?String(m[r]):"":o!=null?String(o):""}const Oe="cooldown:active-skill-tooltip";function de({skill:t,skillIdx:r,version:n,spellData:s,isPassive:a,passiveName:m,passiveDescription:o,passiveImageFull:d,size:b="default"}){const{t:u,lang:p}=ne(),k=Ye()==="mobile",[N,C]=z.useState(!1),[T,v]=z.useState(!1),x=z.useRef(null),f=z.useRef(null),c=z.useRef(""),[l,j]=z.useState("bottom"),[i,h]=z.useState(void 0),y=a&&d?null:fr(t,s,p),w=a&&d?null:xr(t,s,p),g=b==="small",A=g?"min-w-6 min-h-6 w-6 h-6":"min-w-8 min-h-8 w-8 h-8",D=g?"text-[8px]":"text-[9px]",F=z.useCallback(()=>{k||(c.current||(c.current=`${t.id}-${r}-${n}`),typeof window<"u"&&window.dispatchEvent(new CustomEvent(Oe,{detail:c.current})),f.current!==null&&(window.clearTimeout(f.current),f.current=null),v(!0))},[k,t.id,r,n]),U=z.useCallback(()=>{k||(f.current!==null&&window.clearTimeout(f.current),f.current=window.setTimeout(()=>{v(!1),f.current=null},40))},[k]);z.useEffect(()=>{if(k||!T){h(void 0);return}const $=x.current;if(!$)return;const E=()=>{const O=$.getBoundingClientRect(),M=window.innerHeight,H=16,W=8,ee=O.top-H,ie=M-O.bottom-H;if(ee<=0&&ie<=0){h(void 0);return}if(ie>=ee){j("bottom");const oe=Math.max(ie-W,0);h(oe||void 0)}else{j("top");const oe=Math.max(ee-W,0);h(oe||void 0)}};return E(),window.addEventListener("resize",E),window.addEventListener("scroll",E,!0),()=>{window.removeEventListener("resize",E),window.removeEventListener("scroll",E,!0)}},[k,T]),z.useEffect(()=>{if(typeof window>"u")return;const $=E=>{const M=E.detail;c.current&&M!==c.current&&(f.current!==null&&(window.clearTimeout(f.current),f.current=null),v(!1))};return window.addEventListener(Oe,$),()=>{f.current!==null&&window.clearTimeout(f.current),window.removeEventListener(Oe,$)}},[]);const te=e.jsx("div",{ref:x,className:`flex flex-col items-center gap-0.5 p-1 -m-1 touch-manipulation ${k?"cursor-pointer":"cursor-help"}`,onClick:$=>{k&&($.stopPropagation(),C(E=>!E))},onTouchStart:$=>{k&&($.stopPropagation(),C(E=>!E))},onPointerEnter:()=>{k||F()},onPointerLeave:()=>{k||U()},children:a&&d?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:Mt(n,d),alt:"Passive",className:_(A,"rounded")}),e.jsx("span",{className:_(D,"font-semibold"),children:"P"})]}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:tt(n,t.id),alt:ve[r],className:_(A,"rounded")}),e.jsx("span",{className:_(D,"font-semibold"),children:ve[r]})]})}),ae=()=>a&&d?e.jsxs(e.Fragment,{children:[m&&e.jsx("div",{className:`font-semibold text-sm ${k?"pr-10":""}`,children:m}),o&&e.jsx("div",{className:"text-xs leading-relaxed",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:Fe(o,void 0,void 0,p)}})}),e.jsxs("div",{className:"text-xs text-muted-foreground/80 italic leading-relaxed border-t pt-3 mt-3 flex items-center gap-1.5",children:[e.jsx(ot,{className:"w-2.5 h-2.5 text-yellow-600 dark:text-yellow-500 flex-shrink-0"}),e.jsx("span",{children:u.skillTooltip.warningPassive})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-start gap-3 border-b pb-3 pr-6",children:[e.jsx("img",{src:tt(n,t.id),alt:ve[r],className:"w-12 h-12 min-w-12 min-h-12 rounded flex-shrink-0"}),e.jsx("div",{className:"flex-1 min-w-0",children:t.name&&e.jsxs("div",{className:"font-semibold text-sm",children:["[",ve[r],"] ",t.name]})}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[y&&e.jsx("div",{className:"text-xs text-muted-foreground",children:y.includes(" (")?e.jsxs(e.Fragment,{children:[y.split(" (")[0],e.jsx("br",{}),"(",y.split(" (")[1]]}):y}),w&&e.jsx("div",{className:"text-xs text-muted-foreground mt-1 whitespace-nowrap",children:w})]})]}),t.description&&e.jsx("div",{className:"text-xs leading-relaxed",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:Fe(t.description,t,s==null?void 0:s.communityDragonData,p).replace(/<br\s*\/?>/gi," ")}})}),t.tooltip&&e.jsx("div",{className:"text-xs text-muted-foreground leading-relaxed",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:Fe(t.tooltip,t,s==null?void 0:s.communityDragonData,p)}})}),s&&mt(t,s.communityDragonData,p)&&e.jsx("div",{className:"text-[11px] leading-relaxed text-muted-foreground border-t pt-3 mt-3",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:mt(t,s.communityDragonData,p)}})}),e.jsxs("div",{className:"text-xs text-muted-foreground/80 italic leading-relaxed border-t pt-3 mt-3 flex items-center gap-1.5",children:[e.jsx(ot,{className:"w-2.5 h-2.5 text-yellow-600 dark:text-yellow-500 flex-shrink-0"}),e.jsx("span",{children:u.skillTooltip.warningSkill})]})]}),L=e.jsx(It,{open:N,onOpenChange:C,children:e.jsxs(Ft,{className:_(k?"w-[calc(100vw-32px)] max-w-lg h-[70vh] max-h-[70vh]":"w-full max-w-3xl h-[80vh] max-h-[80vh]","p-0 rounded-xl overflow-hidden flex flex-col"),children:[e.jsxs(Ot,{children:[e.jsx(zt,{children:a&&d?`${m||u.skillTooltip.passive} ${u.skillTooltip.skillInfo}`:`[${ve[r]}] ${t.name||u.skillTooltip.skill} ${u.skillTooltip.skillInfo}`}),e.jsx(Ht,{children:a&&d?`${m||u.skillTooltip.passive} ${u.skillTooltip.skillDescription}`:`[${ve[r]}] ${t.name||u.skillTooltip.skill} ${u.skillTooltip.skillDescription}`})]}),e.jsx(gt,{className:"flex-1 min-h-0",children:e.jsx("div",{className:"p-4 flex flex-col gap-3",children:ae()})})]})});if(k)return e.jsxs(e.Fragment,{children:[te,L]});const R=e.jsxs("div",{className:"space-y-3",children:[ae(),e.jsx("div",{className:"pt-1 flex justify-end",children:e.jsx("button",{type:"button",className:"text-[11px] text-primary hover:underline",onClick:$=>{$.preventDefault(),$.stopPropagation(),v(!1),C(!0)},children:u.skillTooltip.viewDetail})})]});return a&&d?e.jsxs(e.Fragment,{children:[e.jsxs(rt,{open:T,children:[e.jsx(st,{asChild:!0,children:te}),e.jsx(nt,{side:l,align:"center",sideOffset:0,className:"max-w-xs p-3 space-y-2",style:!k&&i?{maxHeight:i}:void 0,onPointerEnter:F,onPointerLeave:U,children:R})]}),L]}):e.jsxs(e.Fragment,{children:[e.jsxs(rt,{open:T,children:[e.jsx(st,{asChild:!0,children:te}),e.jsx(nt,{side:l,align:"center",sideOffset:0,className:"max-w-sm p-4 space-y-3",style:!k&&i?{maxHeight:i}:void 0,onPointerEnter:F,onPointerLeave:U,children:R})]}),L]})}function pr({champions:t,version:r,championList:n,onAddChampion:s,onRemoveChampion:a,onReorderChampions:m,vsMode:o}){const{t:d}=ne(),{cdragonVersion:b,setCDragonVersion:u}=bt(),[p,S]=V.useState(!1),[k,N]=z.useState({}),C=Ge(Ne(We,{activationConstraint:{distance:8}}),Ne(Ue,{coordinateGetter:Ke})),T=i=>{},v=i=>{const{active:h,over:y}=i;if(y&&h.id!==y.id&&m){const w=t.findIndex(A=>A.id===h.id),g=t.findIndex(A=>A.id===y.id);w!==-1&&g!==-1&&m(w,g)}};z.useEffect(()=>{const i=async()=>{try{const h=await jt(t,r);if(N(h),!b)try{let y=null;for(const w of Object.keys(h)){const g=h[w];if(g&&g.length>0&&(y=g[0].cdragonVersion??null,y))break}y&&u(y)}catch(y){I.warn("Failed to extract CDragon version from integrated spell data:",y)}}catch(h){I.warn("Failed to load integrated spell data:",h),N({})}};t.length>0&&i()},[t,r,b,u]);const x=z.useMemo(()=>Math.max(...t.map(i=>i.spells?Math.max(...i.spells.map(h=>h.maxrank)):0)),[t]),f=z.useCallback((i,h)=>{const y=k[i];return!y||y.length<=h?null:y[h]},[k]),c=z.useMemo(()=>Array.from({length:x},(i,h)=>{const y=h+1;return{level:y,skills:t.map(w=>w.spells?w.spells.map((g,A)=>{const D=f(w.id,A),F=kt(g,y,D);return{skill:g,cooldown:F}}):null)}}),[t,x,f]),l=({champion:i,children:h,className:y})=>{const{setNodeRef:w,transform:g,transition:A,isDragging:D}=ye({id:i.id,disabled:!0}),U={transform:g?we.Transform.toString(g):void 0,transition:D?A:void 0,opacity:D?.5:1};return e.jsx(B,{ref:w,style:U,className:y,children:h})},j=({champion:i,index:h})=>{const{attributes:y,listeners:w,setNodeRef:g,transform:A,transition:D,isDragging:F}=ye({id:i.id}),te={transform:A?we.Transform.toString(A):void 0,transition:F?D:void 0,opacity:F?.5:1};return e.jsx(K,{ref:g,style:te,className:_("text-center p-2 text-xs font-semibold text-foreground w-[220px] lg:w-[240px] min-w-[200px] lg:min-w-[220px] select-none",h<t.length-1&&"border-r border-border/30",F&&"z-50"),children:e.jsxs("div",{className:"flex flex-row items-center justify-center gap-2 relative",children:[m&&e.jsx("button",{...y,...w,className:"cursor-grab active:cursor-grabbing p-1 opacity-60 hover:opacity-100 transition-opacity -ml-1","aria-label":"Drag to reorder",children:e.jsx(Re,{className:"h-4 w-4 text-muted-foreground"})}),e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:se(r,i.id),alt:i.name,className:"w-8 h-8 rounded-full"}),a&&e.jsx(xe,{variant:"ghost",size:"icon",className:_("absolute -top-1 -right-1 h-4 w-4 rounded-full","bg-destructive/90 hover:bg-destructive text-white","hover:scale-110 transition-transform","shadow-md"),onClick:ae=>{ae.stopPropagation(),a(i.id)},"aria-label":`Remove ${i.name}`,children:e.jsx(_e,{className:"h-2.5 w-2.5"})})]}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("div",{className:"text-[11px] font-semibold leading-tight text-foreground",children:i.name}),e.jsx("div",{className:"text-[9px] text-muted-foreground leading-tight",children:i.title})]})]})})};return e.jsx(ze,{delayDuration:0,skipDelayDuration:150,children:e.jsxs("div",{className:"relative",children:[e.jsx(Ze,{sensors:C,collisionDetection:qe,onDragStart:T,onDragEnd:v,children:e.jsx("div",{className:"border border-border/30 rounded-lg overflow-hidden",children:e.jsxs(pe,{className:"border-collapse table-fixed w-auto",children:[e.jsx(ge,{children:e.jsxs(J,{className:"border-b border-border/30 select-none",children:[e.jsx(K,{className:"text-left p-2 pl-3 text-xs font-semibold text-foreground sticky left-0 bg-card z-20 w-[80px] min-w-[80px] border-r border-border/30 select-none",style:{left:0},children:d.common.level}),e.jsx(Je,{items:t.map(i=>i.id),strategy:Xe,children:t.map((i,h)=>e.jsx(j,{champion:i,index:h},i.id))}),s&&e.jsx(K,{className:"text-center p-2 text-xs font-semibold text-foreground w-[220px] lg:w-[240px] min-w-[200px] lg:min-w-[220px] border-l border-border/30 select-none",children:e.jsxs(xe,{onClick:()=>S(!0),variant:"outline",className:"w-full flex flex-row items-center justify-center gap-2 p-1.5 h-auto border-2 border-dashed border-muted-foreground/30 hover:border-primary/50 hover:bg-muted/30 group",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-muted/30 flex items-center justify-center group-hover:bg-primary/10 transition-colors",children:e.jsx(Le,{className:"w-4 h-4 text-muted-foreground group-hover:text-primary transition-colors"})}),e.jsx("div",{className:"text-[10px] text-muted-foreground group-hover:text-primary transition-colors whitespace-nowrap",children:"추가"})]})})]})}),e.jsxs(be,{children:[e.jsxs(J,{className:"border-b-2 border-border/30 bg-muted/30 select-none",children:[e.jsx(B,{className:"p-2 pl-3 text-xs font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",style:{left:0},children:d.skills.label}),t.map((i,h)=>{var y;return e.jsx(l,{champion:i,className:_("p-2",h<t.length-1&&"border-r border-border/30"),children:e.jsxs("div",{className:"flex justify-center gap-1.5",children:[i.passive&&e.jsx(de,{isPassive:!0,passiveName:i.passive.name,passiveDescription:i.passive.description,passiveImageFull:i.passive.image.full,skill:{},skillIdx:0,version:r}),(y=i.spells)==null?void 0:y.map((w,g)=>{const A=f(i.id,g);return e.jsx(de,{skill:w,skillIdx:g,version:r,spellData:A},w.id)})]})},i.id)}),s&&e.jsx(B,{className:"p-2 text-center border-l border-border/30",children:e.jsx("div",{className:"w-full h-full min-h-[32px]"})})]}),c.map((i,h)=>e.jsxs(J,{className:"border-b border-border/30 hover:bg-muted/30 transition-colors",children:[e.jsxs(B,{className:_("p-2 pl-3 text-xs font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",h===c.length-1&&"rounded-bl-lg"),style:{left:0},children:[i.level,d.common.level]}),i.skills.map((y,w)=>{const g=t[w];return e.jsx(l,{champion:g,className:_("p-2",w<t.length-1&&"border-r border-border/30"),children:y?e.jsxs("div",{className:"flex justify-center gap-1.5",children:[e.jsx("div",{className:"flex flex-col items-center min-w-[32px]",children:e.jsx("span",{className:"text-xs text-muted-foreground",children:"-"})}),y.map((A,D)=>e.jsx("div",{className:"flex flex-col items-center min-w-[32px]",children:e.jsx("span",{className:"text-xs font-semibold",children:A.cooldown!==""?`${A.cooldown}${d.common.seconds}`:"-"})},D))]}):e.jsx("span",{className:"text-xs text-muted-foreground",children:"-"})},g.id)}),s&&e.jsx(B,{className:"p-2 text-center border-l border-border/30",children:e.jsx("div",{className:"w-full h-full min-h-[32px]"})})]},i.level))]})]})})}),p&&s&&n&&e.jsx(Ee,{championList:n,selectedChampions:t,onSelect:i=>{s(i)},onClose:()=>S(!1)})]})})}function gr({champions:t,version:r,vsMode:n}){var S,k;const{t:s}=ne(),{cdragonVersion:a,setCDragonVersion:m}=bt(),[o,d]=z.useState({});z.useEffect(()=>{const N=async()=>{try{const C=await jt(t,r);if(d(C),!a)try{let T=null;for(const v of Object.keys(C)){const x=C[v];if(x&&x.length>0&&(T=x[0].cdragonVersion??null,T))break}T&&m(T)}catch(T){I.warn("Failed to extract CDragon version from integrated spell data (mobile):",T)}}catch(C){I.warn("Failed to load integrated spell data:",C),d({})}};t.length>0&&N()},[t,r,a,m]);const b=z.useMemo(()=>Math.max(...t.map(N=>N.spells?Math.max(...N.spells.map(C=>C.maxrank)):0)),[t]),u=z.useCallback((N,C)=>{const T=o[N];return!T||T.length<=C?null:T[C]},[o]),p=z.useMemo(()=>Array.from({length:b},(N,C)=>{const T=C+1;return{level:T,skills:t.map(v=>v.spells?v.spells.map((x,f)=>{const c=u(v.id,f),l=kt(x,T,c);return{skill:x,cooldown:l}}):null)}}),[t,b,u]);if(n&&t.length===2){const N=n.championA,C=n.championB;return e.jsx(ze,{delayDuration:0,skipDelayDuration:150,children:e.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:e.jsx("div",{className:"min-w-full",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"border border-border/30 rounded-lg overflow-hidden",children:e.jsxs(pe,{className:"border-collapse table-fixed w-auto min-w-full",children:[e.jsx(ge,{children:e.jsxs(J,{className:"border-b border-border/30 select-none",children:[e.jsx(K,{className:"text-left p-1.5 pl-2 text-[10px] font-semibold text-foreground sticky left-0 bg-card z-20 w-[50px] min-w-[50px] border-r border-border/30 select-none",style:{left:0},children:s.common.level}),e.jsx(K,{className:"text-center p-1.5 text-[10px] font-semibold text-foreground w-[calc((100%-90px)/2)] min-w-[100px] border-r border-border/30 select-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-0.5",children:[e.jsx("img",{src:se(r,N.id),alt:N.name,className:"w-6 h-6 rounded-full",draggable:"false"}),e.jsx("div",{className:"text-xs font-semibold leading-tight text-center text-foreground",children:N.name})]})}),e.jsx(K,{className:"text-center p-1.5 text-[10px] font-semibold text-foreground w-[40px] min-w-[40px] border-r border-border/30 bg-muted/20 select-none",children:e.jsx("div",{className:"text-[9px] font-bold",children:"VS"})}),e.jsx(K,{className:"text-center p-1.5 text-[10px] font-semibold text-foreground w-[calc((100%-90px)/2)] min-w-[100px] select-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-0.5",children:[e.jsx("img",{src:se(r,C.id),alt:C.name,className:"w-6 h-6 rounded-full",draggable:"false"}),e.jsx("div",{className:"text-xs font-semibold leading-tight text-center text-foreground",children:C.name})]})})]})}),e.jsxs(be,{children:[e.jsxs(J,{className:"border-b-2 border-border/30 bg-muted/30 select-none",children:[e.jsx(B,{className:"p-1.5 pl-2 text-[10px] font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",style:{left:0},children:s.skills.label}),e.jsx(B,{className:"p-1.5 border-r border-border/30",children:e.jsxs("div",{className:"flex justify-center gap-0.5",children:[N.passive&&e.jsx(de,{isPassive:!0,passiveName:N.passive.name,passiveDescription:N.passive.description,passiveImageFull:N.passive.image.full,skill:{},skillIdx:0,version:r,size:"small"}),(S=N.spells)==null?void 0:S.map((T,v)=>{const x=u(N.id,v);return e.jsx(de,{skill:T,skillIdx:v,version:r,spellData:x,size:"small"},T.id)})]})}),e.jsx(B,{className:"p-1.5 border-r border-border/30 bg-muted/20 select-none"}),e.jsx(B,{className:"p-1.5",children:e.jsxs("div",{className:"flex justify-center gap-0.5",children:[C.passive&&e.jsx(de,{isPassive:!0,passiveName:C.passive.name,passiveDescription:C.passive.description,passiveImageFull:C.passive.image.full,skill:{},skillIdx:0,version:r,size:"small"}),(k=C.spells)==null?void 0:k.map((T,v)=>{const x=u(C.id,v);return e.jsx(de,{skill:T,skillIdx:v,version:r,spellData:x,size:"small"},T.id)})]})})]}),p.map((T,v)=>{const x=T.skills[0],f=T.skills[1];return e.jsxs(J,{className:"border-b border-border/30 hover:bg-muted/30 transition-colors",children:[e.jsxs(B,{className:_("p-1.5 pl-2 text-[10px] font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",v===p.length-1&&"rounded-bl-lg"),style:{left:0},children:[T.level,s.common.level]}),e.jsx(B,{className:"p-1.5 border-r border-border/30",children:x?e.jsxs("div",{className:"flex justify-center gap-0.5",children:[e.jsx("div",{className:"flex flex-col items-center min-w-[20px]",children:e.jsx("span",{className:"text-[9px] text-muted-foreground",children:"-"})}),x.map((c,l)=>e.jsx("div",{className:"flex flex-col items-center min-w-[20px]",children:e.jsx("span",{className:"text-[9px] font-semibold",children:c.cooldown!==""?`${c.cooldown}${s.common.seconds}`:"-"})},l))]}):e.jsx("span",{className:"text-[9px] text-muted-foreground",children:"-"})}),e.jsx(B,{className:"p-1.5 border-r border-border/30 bg-muted/20 select-none"}),e.jsx(B,{className:"p-1.5",children:f?e.jsxs("div",{className:"flex justify-center gap-0.5",children:[e.jsx("div",{className:"flex flex-col items-center min-w-[20px]",children:e.jsx("span",{className:"text-[9px] text-muted-foreground",children:"-"})}),f.map((c,l)=>e.jsx("div",{className:"flex flex-col items-center min-w-[20px]",children:e.jsx("span",{className:"text-[9px] font-semibold",children:c.cooldown!==""?`${c.cooldown}${s.common.seconds}`:"-"})},l))]}):e.jsx("span",{className:"text-[9px] text-muted-foreground",children:"-"})})]},T.level)})]})]})})})})})})}return e.jsx(ze,{delayDuration:0,skipDelayDuration:150,children:e.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:e.jsx("div",{className:"min-w-full",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"border border-border/30 rounded-lg overflow-hidden",children:e.jsxs(pe,{className:"border-collapse table-fixed w-auto min-w-full",children:[e.jsx(ge,{children:e.jsxs(J,{className:"border-b border-border/30 select-none",children:[e.jsx(K,{className:"text-left p-2 pl-3 text-xs font-semibold text-foreground sticky left-0 bg-card z-20 w-[60px] min-w-[60px] border-r border-border/30 select-none",style:{left:0},children:s.common.level}),t.map(N=>e.jsx(K,{className:"text-center p-2 text-xs font-semibold text-foreground w-full select-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-1",children:[e.jsx("img",{src:se(r,N.id),alt:N.name,className:"w-8 h-8 rounded-full",draggable:"false"}),e.jsx("div",{className:"text-sm font-semibold leading-tight text-center text-foreground",children:N.name})]})},N.id))]})}),e.jsxs(be,{children:[e.jsxs(J,{className:"border-b-2 border-border/30 bg-muted/30 select-none",children:[e.jsx(B,{className:"p-2 pl-3 text-xs font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",style:{left:0},children:s.skills.label}),t.map(N=>{var C;return e.jsx(B,{className:"p-2",children:e.jsxs("div",{className:"flex justify-center gap-1",children:[N.passive&&e.jsx(de,{isPassive:!0,passiveName:N.passive.name,passiveDescription:N.passive.description,passiveImageFull:N.passive.image.full,skill:{},skillIdx:0,version:r}),(C=N.spells)==null?void 0:C.map((T,v)=>{const x=u(N.id,v);return e.jsx(de,{skill:T,skillIdx:v,version:r,spellData:x},T.id)})]})},N.id)})]}),p.map((N,C)=>e.jsxs(J,{className:"border-b border-border/30 hover:bg-muted/30 transition-colors",children:[e.jsxs(B,{className:_("p-2 pl-3 text-xs font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",C===p.length-1&&"rounded-bl-lg"),style:{left:0},children:[N.level,s.common.level]}),N.skills.map((T,v)=>e.jsx(B,{className:"p-2",children:T?e.jsxs("div",{className:"flex justify-center gap-1",children:[e.jsx("div",{className:"flex flex-col items-center min-w-[24px]",children:e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"-"})}),T.map((x,f)=>e.jsx("div",{className:"flex flex-col items-center min-w-[24px]",children:e.jsx("span",{className:"text-[10px] font-semibold",children:x.cooldown!==""?`${x.cooldown}${s.common.seconds}`:"-"})},f))]}):e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"-"})},t[v].id))]},N.level))]})]})})})})})})}function br({champions:t,version:r,activeTab:n,championList:s,onAddChampion:a,onRemoveChampion:m,onReorderChampions:o,vsMode:d}){const b=Ye();if(t.length===0)return null;const u=b==="mobile";return e.jsx(xt,{children:e.jsx(pt,{className:"p-0",children:n==="stats"?u?e.jsx(er,{champions:t,version:r,championList:s,onAddChampion:a,onRemoveChampion:m,vsMode:d}):e.jsx(Qt,{champions:t,version:r,championList:s,onAddChampion:a,onRemoveChampion:m,onReorderChampions:o}):u?e.jsx(gr,{champions:t,version:r,championList:s,onAddChampion:a,onRemoveChampion:m,vsMode:d}):e.jsx(pr,{champions:t,version:r,championList:s,onAddChampion:a,onRemoveChampion:m,onReorderChampions:o})})})}const hr=z.memo(br),jr=()=>`tab-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;function vr({version:t,initialTabs:r,initialSelectedTabId:n,tabsStorageKey:s,selectedTabIdStorageKey:a}){const[m,o]=V.useState([]),d=V.useRef([]),[b,u]=V.useState(null),[p,S]=V.useState(!1),[k,N]=V.useState(null),[C,T]=V.useState(!1);V.useEffect(()=>{d.current=m},[m]),V.useEffect(()=>{if(!(!t||C))try{const i=localStorage.getItem(s);let h=null;if(i){const g=JSON.parse(i);Array.isArray(g)&&(h=g)}!h&&r&&r.length>0&&(h=r);const y=localStorage.getItem(a);let w=null;y?w=y:n&&(w=n),h&&h.length>0?(o(h),w&&h.some(g=>g.id===w)?u(w):u(h[0].id)):u(null),T(!0)}catch(i){I.error("Failed to load tabs from localStorage:",i),T(!0)}},[t,s,a,C,r,n]),V.useEffect(()=>{!b&&m.length>0&&u(m[0].id)},[m,b]),V.useEffect(()=>{b&&!m.find(i=>i.id===b)&&u(m.length>0?m[0].id:null)},[m,b]);const v=V.useCallback(i=>{o(h=>{const y=h.findIndex(g=>g.id===i),w=h.filter(g=>g.id!==i);return u(g=>{if(g&&g!==i&&w.some(U=>U.id===g))return g;if(w.length===0)return null;const A=y>0?y-1:0;return(w[A]??w[0]).id}),w})},[u]),x=V.useCallback(i=>{o(h=>[...h,i]),u(i.id)},[]),f=V.useCallback((i,h)=>{o(y=>y.map(w=>w.id===i?h(w):w))},[]),c=V.useCallback((i,h)=>{o(y=>{const w=y.findIndex(A=>A.id===i);if(w===-1)return[...y,h];const g=[...y];return g[w]=h,g}),u(h.id)},[]),l=V.useCallback(()=>{o([]),u(null),le(s),le(a)},[s,a]),j=V.useCallback(i=>{const{active:h,over:y}=i;y&&h.id!==y.id&&o(w=>{const g=w.findIndex(D=>D.id===h.id),A=w.findIndex(D=>D.id===y.id);return g===-1||A===-1?w:ft(w,g,A)})},[]);return{tabs:m,setTabs:o,tabsRef:d,selectedTabId:b,setSelectedTabId:u,showVsSelector:p,setShowVsSelector:S,vsSelectorMode:k,setVsSelectorMode:N,removeTab:v,addTab:x,updateTab:f,replaceTab:c,resetTabs:l,handleDragEnd:j,generateTabId:jr}}function Nr({version:t,lang:r,championList:n,tabs:s,initialSelectedChampions:a,storageKey:m}){const[o,d]=V.useState([]),[b,u]=V.useState(!0),[p,S]=V.useState(!1);V.useEffect(()=>{if(!t||!n||p){!p&&(!t||!n)&&setTimeout(()=>{u(!1)},0);return}try{const f=localStorage.getItem(m);let c=null;if(f){const l=JSON.parse(f);Array.isArray(l)&&(c=l)}if(!c&&a&&a.length>0&&(c=a),c&&c.length>0){const l=c.map(j=>{const i=n.find(h=>h.id===j.id||h.key===j.key);return i?{...i,isLoading:!1}:null}).filter(j=>j!==null);l.length>0?setTimeout(()=>{d(l),S(!0),l.forEach(j=>{j.id&&(d(i=>i.map(h=>h.id===j.id?{...h,isLoading:!0}:h)),at(t,r,j.id).then(i=>{d(h=>h.map(y=>y.id===j.id?{...y,fullInfo:i,isLoading:!1}:y))}).catch(i=>{I.error("Failed to load champion info:",i),d(h=>h.map(y=>y.id===j.id?{...y,isLoading:!1}:y))}))})},0):S(!0)}else S(!0);setTimeout(()=>{u(!1)},0)}catch(f){I.error("Failed to load initial selected champions:",f),setTimeout(()=>{u(!1),S(!0)},0)}},[t,r,n,m,p,a]),V.useEffect(()=>{n&&o.length>0&&setTimeout(()=>{d(f=>f.map(c=>{const l=n.find(j=>j.id===c.id||j.key===c.key);return l?{...c,name:l.name,title:l.title}:c}))},0)},[n,o.length]),V.useEffect(()=>{b||setTimeout(()=>{const f=new Set(s.flatMap(c=>c.champions));d(c=>{if(s.length===0)return c.length>0?[]:c;const l=c.filter(j=>f.has(j.id));return l.length!==c.length?l:c})},0)},[s,b]);const k=V.useCallback(f=>{t&&(d(c=>c.map(l=>l.id===f?{...l,isLoading:!0}:l)),at(t,r,f).then(c=>{d(l=>l.map(j=>j.id===f?{...j,fullInfo:c,isLoading:!1,skinIndex:0}:j))}).catch(c=>{I.error("Failed to load champion info:",c),d(l=>l.map(j=>j.id===f?{...j,isLoading:!1}:j))}))},[t,r]),N=V.useCallback(f=>{d(c=>{if(c.some(i=>i.id===f.id))return c;const j={...f,isLoading:!0,skinIndex:0};return k(f.id),[...c,j]})},[k]),C=V.useCallback(f=>{d(c=>c.filter(l=>l.id!==f))},[]),T=V.useCallback(()=>{d([]),le(m)},[m]),v=V.useMemo(()=>o.filter(f=>f.fullInfo&&!f.isLoading),[o]),x=V.useMemo(()=>{const f=new Set(s.filter(c=>c.mode==="normal").flatMap(c=>c.champions));return o.filter(c=>f.has(c.id))},[s,o]);return{selectedChampions:o,setSelectedChampions:d,championsWithFullInfo:v,normalTabChampions:x,addChampionToList:N,removeChampion:C,resetChampions:T,loadChampionInfo:k}}function yr({onAddClick:t}){const{t:r}=ne();return e.jsx(xt,{className:"border-dashed",children:e.jsxs(pt,{className:"flex flex-col items-center justify-center py-12 md:py-16",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-muted/50 flex items-center justify-center mb-4",children:e.jsx(Kt,{className:"w-8 h-8 text-muted-foreground"})}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:r.encyclopedia.emptyState.title}),e.jsx("p",{className:"text-muted-foreground text-center max-w-md text-sm mb-4",children:r.encyclopedia.emptyState.description}),e.jsxs(xe,{onClick:t,variant:"outline",className:"flex flex-row items-center justify-center gap-2 border-2 border-dashed border-muted-foreground/30 hover:border-primary/50 hover:bg-muted/30 group",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-muted/30 flex items-center justify-center group-hover:bg-primary/10 transition-colors",children:e.jsx(Le,{className:"w-4 h-4 text-muted-foreground group-hover:text-primary transition-colors"})}),e.jsx("span",{className:"text-sm text-muted-foreground group-hover:text-primary transition-colors",children:r.encyclopedia.emptyState.addButton})]})]})})}const Tt="flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-medium transition-colors shrink-0 relative select-none",Vt="bg-primary text-primary-foreground",Pt="bg-muted/50 text-muted-foreground",At="touch-none cursor-grab active:cursor-grabbing p-0.5 -ml-1 mr-0.5 opacity-60 hover:opacity-100 transition-opacity select-none",$t="ml-1 p-0.5 rounded-full hover:bg-muted/50 active:bg-muted transition-colors shrink-0 select-none group",wr="ml-1 p-1 rounded-full hover:bg-muted/50 active:bg-muted transition-colors shrink-0 select-none group";function Cr({tab:t,champion:r,version:n,selectedTabId:s,onSelect:a,onRemove:m,onVsClick:o}){const{t:d}=ne(),{attributes:b,listeners:u,setNodeRef:p,transform:S,transition:k,isDragging:N}=ye({id:t.id}),C={transform:we.Transform.toString(S),transition:k,opacity:N?.5:1},T=s===t.id,v=T?Vt:Pt;return e.jsxs("div",{ref:p,style:C,"data-tab-id":t.id,className:_(Tt,v,N&&"z-50"),onClick:x=>{const f=x.target;f.tagName==="BUTTON"||f.closest("button")||a(t.id)},children:[e.jsx("button",{...b,...u,className:At,"aria-label":"Drag to reorder",children:e.jsx(Re,{className:"h-3 w-3 pointer-events-none select-none"})}),e.jsxs("div",{className:"flex items-center gap-1.5 flex-1 cursor-pointer select-none",children:[e.jsx("img",{src:se(n,r.id),alt:r.name,className:"w-5 h-5 rounded-full pointer-events-none select-none",draggable:"false"}),e.jsx("span",{className:"pointer-events-none select-none",children:r.name})]}),e.jsx("button",{onClick:x=>{x.preventDefault(),x.stopPropagation(),o(t.id)},className:wr,"aria-label":`${d.encyclopedia.vs} with ${r.name}`,title:d.encyclopedia.vsStart,type:"button",children:e.jsx(Ut,{className:_("h-3 w-3 transition-colors",T?"text-primary-foreground":"text-muted-foreground")})}),e.jsx("button",{onClick:x=>{x.preventDefault(),x.stopPropagation(),m(t.id)},className:$t,"aria-label":`Remove ${r.name}`,type:"button",children:e.jsx(_e,{className:_("h-3 w-3 transition-colors",T?"text-primary-foreground":"text-muted-foreground")})})]})}function Sr({tab:t,championA:r,championB:n,version:s,selectedTabId:a,onSelect:m,onRemove:o,onChangeChampionA:d,onChangeChampionB:b}){const{t:u}=ne(),{attributes:p,listeners:S,setNodeRef:k,transform:N,transition:C,isDragging:T}=ye({id:t.id}),v={transform:we.Transform.toString(N),transition:C,opacity:T?.5:1},x=a===t.id,f=x?Vt:Pt;return e.jsxs("div",{ref:k,style:v,"data-tab-id":t.id,className:_(Tt,f,T&&"z-50"),children:[e.jsx("button",{...p,...S,className:At,"aria-label":"Drag to reorder",children:e.jsx(Re,{className:"h-3 w-3 pointer-events-none select-none"})}),e.jsxs("div",{className:"flex items-center gap-1.5 flex-1 select-none",children:[e.jsx("button",{onClick:c=>{c.preventDefault(),c.stopPropagation(),d(t.id)},className:"flex items-center touch-none hover:opacity-80 transition-opacity select-none",children:e.jsx("img",{src:se(s,r.id),alt:r.name,className:"w-5 h-5 rounded-full select-none pointer-events-none",draggable:"false"})}),e.jsx("button",{onClick:()=>{m(t.id)},className:"text-[10px] font-semibold touch-none select-none",children:u.encyclopedia.vs}),e.jsx("button",{onClick:c=>{c.preventDefault(),c.stopPropagation(),b(t.id)},className:"flex items-center touch-none hover:opacity-80 transition-opacity select-none",children:e.jsx("img",{src:se(s,n.id),alt:n.name,className:"w-5 h-5 rounded-full select-none pointer-events-none",draggable:"false"})})]}),e.jsx("button",{onClick:c=>{c.preventDefault(),c.stopPropagation(),o(t.id)},className:$t,"aria-label":"Remove VS tab",children:e.jsx(_e,{className:_("h-3 w-3 transition-colors",x?"text-primary-foreground":"text-muted-foreground")})})]})}function kr({tabs:t,championsWithFullInfo:r,version:n,selectedTabId:s,sensors:a,onDragEnd:m,onSelectTab:o,onRemoveTab:d,onVsClick:b,onChangeChampionA:u,onChangeChampionB:p,onAddClick:S}){const{t:k}=ne(),N=V.useRef(null),C=V.useRef(t.length),T=V.useRef(!1),v=V.useRef((x=!0)=>{if(!N.current||!s)return;const f=N.current.querySelector("[data-radix-scroll-area-viewport]");if(!f)return;const c=f.querySelector(`[data-tab-id="${s}"]`);if(c){const l=c.offsetLeft,j=c.offsetWidth,i=f.offsetWidth,h=l-i/2+j/2;x?f.scrollTo({left:Math.max(0,h),behavior:"smooth"}):f.scrollLeft=Math.max(0,h)}});return V.useEffect(()=>{!T.current&&s&&t.length>0&&(T.current=!0,requestAnimationFrame(()=>{requestAnimationFrame(()=>{v.current(!1)})}))},[s,t.length]),V.useEffect(()=>{if(!N.current)return;const x=N.current.querySelector("[data-radix-scroll-area-viewport]");x&&(t.length>C.current&&x.scrollTo({left:x.scrollWidth,behavior:"smooth"}),C.current=t.length)},[t.length]),V.useEffect(()=>{if(T.current&&s){const x=setTimeout(()=>{v.current(!0)},100);return()=>clearTimeout(x)}},[s]),e.jsx("div",{className:"border-b border-border -mx-4 px-4",children:e.jsxs("div",{className:"flex items-center gap-2 pb-2",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground shrink-0 pl-3",children:k.encyclopedia.champion}),e.jsxs(gt,{ref:N,type:"scroll",className:"flex-1",children:[e.jsx(Ze,{sensors:a,collisionDetection:qe,onDragEnd:m,children:e.jsx(Je,{items:t.map(x=>x.id),strategy:Xe,children:e.jsxs("div",{className:"flex items-center gap-2 w-max select-none pr-2",children:[t.map(x=>{if(x.mode==="vs"){const f=r.find(l=>l.id===x.champions[0]),c=r.find(l=>l.id===x.champions[1]);return!f||!c?null:e.jsx(Sr,{tab:x,championA:f,championB:c,version:n,selectedTabId:s,onSelect:o,onRemove:d,onChangeChampionA:u,onChangeChampionB:p},x.id)}else{const f=r.find(c=>c.id===x.champions[0]);return f?e.jsx(Cr,{tab:x,champion:f,version:n,selectedTabId:s,onSelect:o,onRemove:d,onVsClick:b},x.id):null}}),e.jsxs(xe,{onClick:S,variant:"outline",size:"sm",className:"flex items-center gap-1.5 shrink-0 border-2 border-dashed border-muted-foreground/30 hover:border-primary hover:bg-primary/10 hover:text-primary h-auto py-1.5 px-3 transition-colors",children:[e.jsx(Le,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs",children:k.encyclopedia.add})]})]})})}),e.jsx(Gt,{orientation:"horizontal"})]})]})})}function Tr({open:t,vsSelectorMode:r,tabs:n,championList:s,selectedChampions:a,onSelect:m,onClose:o,onOpenChange:d}){const{t:b}=ne();if(!t||!r)return null;const u=n.find(S=>S.id===r.tabId);if(!u||r.mode!=="select-second"&&u.mode!=="vs")return null;const p=r.mode==="change-champion-a"?u.champions[1]:u.champions[0];return p?e.jsx(Ee,{championList:s,selectedChampions:a,onSelect:m,onClose:o,open:t,onOpenChange:d,vsMode:{currentChampionId:p,title:b.encyclopedia.selectOpponent}}):null}const Ve="cooldown_selected_champions",Pe="cooldown_tabs",Ae="cooldown_selected_tab_id";function Vr(t){return t==="skills"||t==="stats"}function Pr({lang:t,championList:r,version:n,initialSelectedChampions:s,initialTabs:a,initialSelectedTabId:m}){const[o,d]=Dt(),u=Ye()==="mobile",p=V.useMemo(()=>{const P=o.get("tab");return Vr(P)?P:null},[o]),S=()=>p||"skills",[k,N]=V.useState(S),C=V.useRef(p),T=V.useRef(S());V.useEffect(()=>{const P=p||"skills",Z=C.current||"skills";P!==Z&&P!==k&&(N(P),T.current=P),C.current=p},[p,k]),V.useEffect(()=>{const P=p||"skills",Z=T.current;if(k!==Z&&P!==k){const q=new URLSearchParams(o);k==="skills"?q.delete("tab"):q.set("tab",k),d(q,{replace:!0}),C.current=k==="skills"?null:k}T.current=k},[k,p,o,d]);const[v,x]=V.useState(!1),{t:f}=ne(),{tabs:c,tabsRef:l,selectedTabId:j,setSelectedTabId:i,showVsSelector:h,setShowVsSelector:y,vsSelectorMode:w,setVsSelectorMode:g,removeTab:A,addTab:D,updateTab:F,replaceTab:U,resetTabs:te,handleDragEnd:ae,generateTabId:L}=vr({version:n,initialTabs:a,initialSelectedTabId:m,tabsStorageKey:Pe,selectedTabIdStorageKey:Ae}),{selectedChampions:R,setSelectedChampions:$,championsWithFullInfo:E,normalTabChampions:O,addChampionToList:M,removeChampion:H,resetChampions:W}=Nr({version:n,lang:t,championList:r,tabs:c,initialSelectedChampions:s,storageKey:Ve}),ee=V.useCallback(()=>{try{if(R.length>0){const P=R.map(({id:Z,key:q})=>({id:Z,key:q}));Be(Ve,JSON.stringify(P))}else le(Ve);c.length>0?Be(Pe,JSON.stringify(c)):le(Pe),j?Be(Ae,j):le(Ae)}catch(P){I.error("Failed to persist cooldown state to storage:",P)}},[R,c,j]),ie=Ge(Ne(We,{activationConstraint:{distance:12}}),Ne(Ue,{coordinateGetter:Ke})),oe=V.useCallback((P,Z)=>{$(q=>ft(q,P,Z))},[$]),ce=V.useCallback(P=>{if(new Set(R.map(me=>me.id)).has(P.id)){const me=l.current,X=me.some(Y=>Y.mode==="normal"&&Y.champions.length===1&&Y.champions[0]===P.id),Te=me.some(Y=>Y.mode==="vs"&&Y.champions.includes(P.id));if(X){const Y=c.find(De=>De.mode==="normal"&&De.champions.length===1&&De.champions[0]===P.id);Y&&A(Y.id),Te||H(P.id);return}if(Te){const Y={mode:"normal",champions:[P.id],id:L()};D(Y);return}const et=c.find(Y=>Y.mode==="normal"&&Y.champions.length===1&&Y.champions[0]===P.id);et&&A(et.id),H(P.id);return}M(P);const q={mode:"normal",champions:[P.id],id:L()};D(q)},[R,c,l,M,H,D,A,L]),je=V.useCallback(()=>{W(),te(),le(Ve),le(Pe),le(Ae)},[W,te]),Ce=V.useCallback(P=>{if(!w)return;const{mode:Z,tabId:q}=w,me=c.find(X=>X.id===q);if(me){if(Z==="select-second"){const X={mode:"vs",champions:[me.champions[0],P.id],id:L()};U(q,X),R.some(Te=>Te.id===P.id)||M(P)}else Z==="change-champion-a"?(F(q,X=>({...X,champions:[P.id,X.champions[1]]})),R.some(X=>X.id===P.id)||M(P)):Z==="change-champion-b"&&(F(q,X=>({...X,champions:[X.champions[0],P.id]})),R.some(X=>X.id===P.id)||M(P));y(!1),g(null)}},[w,c,R,M,F,U,L,y,g]),G=V.useMemo(()=>j&&c.find(P=>P.id===j)||null,[j,c]),re=V.useMemo(()=>G?G.champions.map(P=>{var Z;return(Z=E.find(q=>q.id===P))==null?void 0:Z.fullInfo}).filter(P=>P!==void 0):[],[G,E]),Qe=V.useMemo(()=>!u||G&&G.mode==="vs"?null:G&&G.mode==="normal"&&re.length>0?re[0]:null,[u,G,re]),Et=V.useCallback(P=>{c.forEach(Z=>{Z.champions.includes(P)&&A(Z.id)}),H(P)},[c,H,A]),Lt=V.useCallback(P=>{g({mode:"select-second",tabId:P}),y(!0)},[y,g]),Rt=V.useCallback(P=>{g({mode:"change-champion-a",tabId:P,championIndex:0}),y(!0)},[y,g]),_t=V.useCallback(P=>{g({mode:"change-champion-b",tabId:P,championIndex:1}),y(!0)},[y,g]);return e.jsxs("div",{className:"w-full max-w-7xl mx-auto px-4 md:px-6 lg:px-8 pb-4 md:pb-5",children:[v&&e.jsx(Ee,{championList:r,selectedChampions:O,onSelect:ce,onClose:()=>{x(!1),ee()},open:v,onOpenChange:P=>{x(P),P||ee()}}),e.jsx(Tr,{open:h,vsSelectorMode:w,tabs:c,championList:r,selectedChampions:R,onSelect:Ce,onClose:()=>{y(!1),g(null),ee()},onOpenChange:P=>{y(P),P||(g(null),ee())}}),e.jsx("div",{className:"mt-3 md:mt-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-2 border-b border-border overflow-x-auto -mx-4 md:mx-0 px-4 md:px-0",children:[e.jsx(qt,{value:k,onValueChange:P=>N(P),className:"flex-1",children:e.jsxs(Jt,{className:"inline-flex h-auto items-center justify-start gap-2 bg-transparent p-0 border-0",children:[e.jsx(lt,{value:"skills",className:"px-4 py-2 text-sm font-medium transition-colors border-b-2 border-transparent text-muted-foreground hover:text-foreground data-[state=active]:border-primary data-[state=active]:text-primary data-[state=active]:bg-transparent rounded-none shadow-none",children:f.encyclopedia.tabs.skills}),e.jsx(lt,{value:"stats",className:"px-4 py-2 text-sm font-medium transition-colors border-b-2 border-transparent text-muted-foreground hover:text-foreground data-[state=active]:border-primary data-[state=active]:text-primary data-[state=active]:bg-transparent rounded-none shadow-none",children:f.encyclopedia.tabs.stats})]})}),e.jsx("div",{className:"flex items-center gap-2 shrink-0",children:e.jsxs(xe,{variant:"ghost",size:"sm",onClick:je,className:"flex items-center gap-1.5 shrink-0 text-muted-foreground hover:text-primary hover:bg-muted/30 border-0",children:[e.jsx(Wt,{className:"h-3 w-3"}),e.jsx("span",{className:"text-[10px]",children:f.encyclopedia.reset})]})})]})}),R.length>0&&E.length>0&&e.jsxs("div",{className:"mt-4 md:mt-6 space-y-4 md:space-y-6",children:[u&&c.length>0&&e.jsx(kr,{tabs:c,championsWithFullInfo:E,version:n,selectedTabId:j,sensors:ie,onDragEnd:ae,onSelectTab:i,onRemoveTab:A,onVsClick:Lt,onChangeChampionA:Rt,onChangeChampionB:_t,onAddClick:()=>x(!0)}),e.jsx(hr,{champions:u&&G&&G.mode==="vs"&&re.length===2?re:u&&Qe?[Qe]:E.map(P=>P.fullInfo),version:n,activeTab:k==="skills"?"skills":"stats",championList:r,onAddChampion:u?void 0:ce,onRemoveChampion:Et,onReorderChampions:u?void 0:oe,vsMode:u&&G&&G.mode==="vs"&&re.length===2?{championA:re[0],championB:re[1]}:void 0})]}),R.length===0&&e.jsx("div",{className:"mt-4",children:e.jsx(yr,{onAddClick:()=>x(!0)})})]})}function Dr(t){return e.jsx(Zt,{initialDDragonVersion:t.version,initialCDragonVersion:t.cdragonVersion,children:e.jsx(Pr,{...t})})}export{Dr as default};
