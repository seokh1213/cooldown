import{j as e,d as G,r as t,f as W,O as Z,g as O}from"/cooldown/assets/react-vendor-CopeUkDP.js";import{m as N,B as z,u as J,y as A,C as H,D as M,V as ee,d as se,e as te}from"/cooldown/assets/index-DgzMOw9C.js";import{u as re,I as q}from"/cooldown/assets/useDebouncedValue-Bt7c7Xyp.js";import{i as ae,f as V,X as U,S as K}from"/cooldown/assets/lucide-icons-DTvcjo7T.js";function le({className:a,...n}){return e.jsx("div",{className:N("animate-pulse rounded-md bg-muted",a),...n})}function ne({addChampion:a,data:n,name:o,thumbnailSrc:i,selected:c}){const[l,h]=t.useState(!1),[r,d]=t.useState(!1),[b,y]=t.useState(c);t.useEffect(()=>{y(c)},[c]);const v=t.useCallback(S=>{S.preventDefault(),S.stopPropagation(),y(j=>!j),a(n)},[a,n]),f=t.useCallback(()=>{h(!0)},[]),m=t.useCallback(()=>{d(!0)},[]);return e.jsxs("div",{className:"flex flex-col items-center justify-center m-1 h-fit",children:[e.jsxs(z,{variant:"ghost",className:"cursor-pointer rounded-full shrink-0 p-0 h-auto w-auto hover:bg-transparent relative touch-manipulation",onClick:v,"aria-label":c?`Deselect ${o}`:`Select ${o}`,"aria-pressed":c,children:[e.jsxs("div",{className:"relative w-12 h-12 md:w-14 md:h-14 shrink-0 overflow-hidden rounded-full",children:[!l&&!r&&e.jsx(le,{className:"absolute inset-0 rounded-full"}),!l&&!r&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-muted via-muted/80 to-muted/60 blur-sm"}),e.jsx("img",{className:N("absolute inset-0 w-full h-full rounded-full bg-black/5 border-0 box-border transition-all duration-200 ease-out object-cover",!c&&!b&&"hover:scale-105",l?"opacity-100":"opacity-0"),src:i,alt:o,loading:"lazy",decoding:"async",width:"56",height:"56",onLoad:f,onError:m}),(b||c)&&e.jsx("div",{className:"absolute inset-0 rounded-full pointer-events-none z-10",style:{boxShadow:"inset 0 0 0 2px hsl(var(--primary)), 0 0 0 3px hsl(var(--primary) / 0.3)"}})]}),(b||c)&&e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-4 h-4 md:w-5 md:h-5 bg-primary rounded-full flex items-center justify-center pointer-events-none z-20 shadow-lg border-2 border-background",children:e.jsx(ae,{className:"w-2.5 h-2.5 md:w-3 md:h-3 text-primary-foreground stroke-[3]"})})]}),e.jsx("div",{className:"text-xs md:text-sm whitespace-nowrap mt-0.5",children:o})]})}const X=G.memo(ne);function oe(a,n){const{lang:o}=J();return t.useMemo(()=>{if(!a)return[];if(!n)return a;const c=A(n,o);return a.filter(l=>c.some(h=>{const r=h.toLowerCase();return!!(l.name.toLowerCase().includes(r)||l.hangul&&l.hangul.toLowerCase().includes(r)||l.id.toLowerCase().includes(r)||o==="ko_KR"&&(A(l.name,o).some(b=>b.toLowerCase().includes(r))||l.hangul&&A(l.hangul,o).some(y=>y.toLowerCase().includes(r))))}))},[a,n,o])}const Y="championSelectorScrollPosition";function ie(a,n,o){t.useEffect(()=>{if(!n||!o)return;const i=()=>{if(a.current){const c=sessionStorage.getItem(Y);if(c){const l=parseInt(c,10);a.current.scrollTop=l}}};i(),requestAnimationFrame(()=>{i()}),setTimeout(()=>{i()},200)},[n,o,a]),t.useEffect(()=>{const i=a.current;if(!i||!n||!o)return;let c;const l=()=>{clearTimeout(c),c=setTimeout(()=>{sessionStorage.setItem(Y,i.scrollTop.toString())},100)};return i.addEventListener("scroll",l,{passive:!0}),()=>{clearTimeout(c),i.removeEventListener("scroll",l)}},[n,o,a])}function ce({championList:a,selectedChampions:n,onSelect:o,onClose:i,slotIndex:c,open:l,onOpenChange:h,vsMode:r}){const{t:d}=J(),[b,y]=t.useState(!1),v=l!==void 0,f=v?!!l:b,m=t.useCallback(s=>{v?h==null||h(s):y(s)},[v,h]),[S,j]=t.useState(""),[g,w]=t.useState(-1),I=t.useRef(null),D=t.useRef(null),C=t.useRef(null),x=i!==void 0,Q=re(S,200),p=oe(a,Q),_=t.useMemo(()=>new Set(n.map(s=>s.id)),[n]),E=t.useMemo(()=>r&&(n.find(s=>s.id===r.currentChampionId)||(a==null?void 0:a.find(s=>s.id===r.currentChampionId)))||null,[r,n,a]),B=t.useMemo(()=>r?p.filter(s=>s.id!==r.currentChampionId):p,[p,r]),P=t.useCallback(s=>{const u=s.target;I.current&&!I.current.contains(u)&&(m(!1),j(""),w(-1))},[m]);t.useEffect(()=>{if(f&&!x)return document.addEventListener("mousedown",P),()=>{document.removeEventListener("mousedown",P)}},[f,P,x]);const k=t.useCallback(s=>{m(s),s||(j(""),w(-1),i&&i()),h&&h(s)},[i,h,m]),T=t.useCallback(s=>{o(s),i!==void 0?w(-1):(m(!1),w(-1),document.body.style.overflow="")},[o,m,i]),$=t.useCallback(s=>{if(!(!f&&!x||!a))if(s.key==="ArrowDown")s.preventDefault(),w(u=>u<p.length-1?u+1:u);else if(s.key==="ArrowUp")s.preventDefault(),w(u=>u>0?u-1:-1);else if(s.key==="Enter"&&g>=0){s.preventDefault();const u=p[g];u&&T(u)}else s.key==="Escape"&&k(!1)},[f,x,a,p,g,T,k]);return t.useEffect(()=>{if(g>=0&&C.current){const s=C.current.querySelectorAll("[data-champion-item]");s[g]&&s[g].scrollIntoView({block:"nearest"})}},[g]),t.useEffect(()=>{v||m(!!x)},[x,v,m]),ie(C,x,f),t.useEffect(()=>{x&&f&&requestAnimationFrame(()=>{var s;(s=D.current)==null||s.focus()})},[x,f]),x?v&&!f?null:e.jsx(M,{open:f,onOpenChange:k,children:e.jsxs(W,{children:[e.jsx(Z,{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm"}),e.jsxs(O,{ref:I,className:"fixed inset-0 left-0 top-0 translate-x-0 translate-y-0 md:inset-auto md:left-[50%] md:top-[50%] md:translate-x-[-50%] md:translate-y-[-50%] w-full h-full md:w-[600px] md:h-[500px] lg:w-[800px] lg:h-[600px] p-0 flex flex-col overflow-hidden max-w-none md:max-w-[600px] lg:max-w-[800px] max-h-none md:max-h-[500px] lg:max-h-[600px] rounded-none md:rounded-xl z-50 border bg-background shadow-lg",onInteractOutside:()=>{k(!1)},onEscapeKeyDown:()=>{k(!1)},children:[e.jsxs(ee,{children:[e.jsx(se,{children:r?d.championSelector.vsSelectOpponent:d.championSelector.selectChampion}),e.jsx(te,{children:r?d.championSelector.vsSelectOpponentDescription:d.championSelector.selectChampionDescription})]}),r&&E&&e.jsxs("div",{className:"p-4 border-b-2 border-destructive/30 bg-destructive/5 flex items-center gap-3 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:H(E.version||"",E.id),alt:E.name,className:"w-10 h-10 rounded-full border-2 border-destructive/50"}),e.jsx("div",{className:"absolute -top-1 -right-1 bg-destructive rounded-full p-0.5",children:e.jsx(K,{className:"h-3 w-3 text-white"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-semibold text-foreground",children:E.name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:d.championSelector.currentChampion})]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-destructive",children:[e.jsx(K,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-semibold",children:"VS"})]})]}),e.jsxs("div",{className:N("p-4 border-b border-border flex items-center gap-2 shrink-0",r?"bg-muted/30":"bg-card"),children:[e.jsx(V,{className:N("h-5 w-5 shrink-0",r?"text-destructive":"text-muted-foreground")}),e.jsx(q,{ref:D,type:"text",placeholder:r?d.championSelector.vsSearchPlaceholder:d.championSelector.searchPlaceholder,value:S,onChange:s=>{j(s.target.value),w(-1)},onKeyDown:$,className:"flex-1",autoFocus:!0}),e.jsx(z,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0 hover:bg-muted hover:text-foreground",onClick:()=>k(!1),children:e.jsx(U,{className:"h-4 w-4"})})]}),e.jsx("div",{ref:C,className:"overflow-y-auto overflow-x-hidden p-4 flex-1 min-h-0 md:flex-none md:w-[600px] md:h-[427px] lg:w-[800px] lg:h-[527px]",children:a?(r?B:p).length>0?e.jsxs(e.Fragment,{children:[r&&e.jsx("div",{className:"mb-3 pb-2 border-b border-destructive/20",children:e.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[e.jsx(K,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-semibold",children:d.championSelector.selectOpponentLabel})]})}),e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10 gap-2",children:(r?B:p).map((s,u)=>{const F=g===u,L=r?!1:_.has(s.id);return e.jsx("div",{"data-champion-item":!0,className:N(F&&"ring-2 ring-offset-1 rounded-md",r?"ring-destructive":"ring-primary"),children:e.jsx(X,{addChampion:R=>T(R),data:s,name:s.name,selected:L,thumbnailSrc:H(s.version||"",s.id)})},s.id)})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground min-h-[200px] space-y-2",children:[e.jsx(V,{className:"h-12 w-12 opacity-50"}),e.jsx("p",{className:"text-base font-medium",children:S?d.championSelector.noResults:d.championSelector.emptyList})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground min-h-[200px]",children:d.championSelector.loading})})]})]})}):e.jsxs("div",{ref:I,className:"w-full",children:[e.jsxs(z,{onClick:()=>{m(!0),setTimeout(()=>{var s;return(s=D.current)==null?void 0:s.focus()},0)},variant:"ghost",className:N("w-full flex flex-col items-center justify-center space-y-2","text-muted-foreground hover:text-foreground","py-4 h-auto"),children:[e.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-dashed border-muted-foreground/30 flex items-center justify-center",children:e.jsx(V,{className:"w-6 h-6"})}),e.jsx("span",{className:"text-sm font-medium",children:d.championSelector.selectChampion})]}),f&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 md:hidden",onClick:()=>{m(!1),j(""),document.body.style.overflow=""},"aria-hidden":"true"}),e.jsxs("div",{className:N("fixed inset-0 z-50 md:absolute md:inset-auto md:top-full md:left-0 md:right-0 md:mt-2 md:z-10 md:rounded-lg md:border md:border-border md:shadow-lg bg-card md:max-h-[60vh] flex flex-col",x&&"md:relative md:inset-0 md:mt-0 md:rounded-lg md:border md:shadow-lg"),children:[e.jsxs("div",{className:"p-4 border-b border-border flex items-center gap-2 sticky top-0 bg-card z-10",children:[e.jsx(V,{className:"h-5 w-5 text-muted-foreground shrink-0"}),e.jsx(q,{ref:D,type:"text",placeholder:d.championSelector.searchPlaceholder,value:S,onChange:s=>{j(s.target.value),w(-1)},onKeyDown:$,className:"flex-1",autoFocus:!0}),e.jsx(z,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0 hover:bg-muted hover:text-foreground",onClick:()=>{m(!1),j(""),document.body.style.overflow=""},children:e.jsx(U,{className:"h-4 w-4"})})]}),e.jsx("div",{ref:C,className:"flex-1 overflow-auto p-4",style:{maxHeight:"calc(100vh - 120px)"},children:a?e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10 gap-2",children:p.map((s,u)=>{const F=g===u,L=_.has(s.id);return e.jsx("div",{"data-champion-item":!0,className:N(F&&"ring-2 ring-primary ring-offset-1 rounded-md"),children:e.jsx(X,{addChampion:R=>T(R),data:s,name:s.name,selected:L,thumbnailSrc:H(s.version||"",s.id)})},s.id)})}):e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:d.championSelector.loading})})]})]})]})}const he=G.memo(ce);export{he as C};
