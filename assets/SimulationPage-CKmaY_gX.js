import{r as c,j as e}from"/cooldown/assets/react-vendor-CopeUkDP.js";import{l as L,u as V,q as W,o as Q,j as z,D as U,c as G,v as J,d as K,e as X,B as Y,S as Z}from"/cooldown/assets/index-F77Rf2kt.js";import{C as F}from"/cooldown/assets/useDebouncedValue-BWooqnph.js";import{C as ee}from"/cooldown/assets/ChampionSelector-DlwEF3Xg.js";import"./lucide-icons-DTvcjo7T.js";const O=c.forwardRef(({className:i,children:r,...s},a)=>e.jsx("select",{className:L("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",i),ref:a,...s,children:r}));O.displayName="Select";function te(i,r){if(!i.stats)return null;const s=i.stats,a=Math.min(Math.max(r,1),18),o=a-1;return{level:a,health:(s.hp??0)+(s.hpperlevel??0)*o,mana:(s.mp??0)+(s.mpperlevel??0)*o,armor:(s.armor??0)+(s.armorperlevel??0)*o,magicResist:(s.spellblock??0)+(s.spellblockperlevel??0)*o,attackDamage:(s.attackdamage??0)+(s.attackdamageperlevel??0)*o,movespeed:s.movespeed??0}}function ae(i,r){let s={...i};for(const a of r){const o=a.stats;if(o)for(const[m,l]of Object.entries(o))switch(m){case"FlatHPPoolMod":s.health+=l;break;case"FlatMPPoolMod":s.mana+=l;break;case"FlatPhysicalDamageMod":s.attackDamage+=l;break;case"FlatArmorMod":s.armor+=l;break;case"FlatSpellBlockMod":s.magicResist+=l;break;case"FlatMovementSpeedMod":s.movespeed+=l;break}}return s}function se(i){let r=0;for(const s of i){const a=s.stats;a&&typeof a.AbilityHaste=="number"&&(r+=a.AbilityHaste)}return r}function le(i,r,s){if(!i.spells)return[];const a=s>0?1+s/100:1;return i.spells.map(o=>{const m=o.cooldown??[],l=a>0?m.map(d=>typeof d=="number"?d/a:d):m.map(d=>d);return{id:o.id,name:o.name,maxrank:o.maxrank,cooldowns:m,cooldownsWithAbilityHaste:l}})}function re(i,r,s,a){if(!i)return{baseDamage:null,ratio:null,totalDamage:null};const o=String(r),m=i[o];if(!m||!m.DataValues)return{baseDamage:null,ratio:null,totalDamage:null};const l=m.DataValues,d=Array.isArray(l.BaseDamage)?l.BaseDamage:null,j=Math.max(0,Math.min(s-1,d?d.length-1:s-1));let S=null;d&&typeof d[j]=="number"&&(S=d[j]);let f=null;const g=m.mSpellCalculations,v=(g==null?void 0:g.TotalDamage)||(g==null?void 0:g.SingleFireDamage)||Object.values(g??{})[0];if(v&&Array.isArray(v.mFormulaParts)){for(const h of v.mFormulaParts)if(h.__type==="StatByCoefficientCalculationPart"&&typeof h.mCoefficient=="number")f=(f??0)+h.mCoefficient;else if(h.__type==="StatByNamedDataValueCalculationPart"&&typeof h.mDataValue=="string"){const k=l[h.mDataValue];Array.isArray(k)&&typeof k[j]=="number"&&(f=(f??0)+k[j])}}const C=f!=null?f*a.attackDamage:null,y=S!=null||C!=null?(S??0)+(C??0):null;return{baseDamage:S,ratio:f,totalDamage:y}}function ne(i,r,s,a){if(!i||!r)return null;const o=s.replace(/[^QWERqwer]/g,"").toUpperCase();if(!o)return null;const m=r.attackDamage*1.2,l=o.length,d=m*l;return{sequence:o,estimatedHits:l,estimatedDamage:d}}function w({label:i,value:r,base:s,precision:a=0}){const o=d=>a>0?d.toFixed(a):Math.round(d).toString(),m=r-s,l=Math.abs(m)>.01;return e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"text-[11px] text-muted-foreground",children:i}),e.jsxs("span",{className:"text-[11px] font-medium",children:[o(r),l&&e.jsxs("span",{className:`ml-1 ${m>=0?"text-emerald-400":"text-rose-400"}`,children:["(",m>=0?"+":"",o(m),")"]})]})]})}function fe({lang:i,version:r,championList:s}){const{t:a}=V(),[o,m]=c.useState(""),[l,d]=c.useState(null),[j,S]=c.useState(18),[f,g]=c.useState([]),[v,C]=c.useState(()=>Array(6).fill(null)),[y,h]=c.useState(null),[k,oe]=c.useState("QWER"),[T,R]=c.useState(!1),[ie,ce]=c.useState(0),[B,A]=c.useState(!1),[D,P]=c.useState(null),E=c.useMemo(()=>s??[],[s]);c.useEffect(()=>{if(!r||!o){d(null),h(null);return}let t=!1;return W(r,i,o).then(n=>{t||d(n)}).catch(()=>{t||d(null)}),Q(o,r).then(n=>{t||h(n.spellDataMap)}).catch(()=>{t||h(null)}),()=>{t=!0}},[r,i,o]),c.useEffect(()=>{if(!r)return;let t=!1;return z(r,i).then(n=>{if(!t){const x=n.filter(u=>{var I;return!(!u.maps||!u.maps[11]||!((I=u.tags)==null?void 0:I.includes("Trinket"))&&u.gold&&u.gold.purchasable===!1||u.inStore===!1||u.displayInItemSets===!1||u.cdragon&&(u.cdragon.inStore===!1||u.cdragon.displayInItemSets===!1))});g(x)}}).catch(()=>{t||g([])}),()=>{t=!0}},[r,i]);const b=c.useMemo(()=>l?te(l,j):null,[l,j]),$=c.useMemo(()=>v.map(t=>t?f.find(n=>n.id===t)??null:null),[f,v]),M=c.useMemo(()=>$.filter(t=>t!==null),[$]),p=c.useMemo(()=>b?ae(b,M):null,[b,M]),_=c.useMemo(()=>p?p.attackDamage*.7:null,[p]);c.useMemo(()=>ne(l,p,k),[l,p,k,y]);const H=c.useMemo(()=>se(M),[M]),q=c.useMemo(()=>l?le(l,y,H):[],[l,y,H]);return r?e.jsxs("div",{className:"w-full max-w-6xl mx-auto px-4 md:px-6 lg:px-8 py-8 md:py-10",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-semibold tracking-tight",children:a.pages.simulation.title}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:a.pages.simulation.description})]}),e.jsx(F,{className:"p-4 md:p-6 bg-card/60 border-border/70 space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-[minmax(0,1.2fr)_minmax(0,1.3fr)]",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start gap-4 md:gap-6",children:[e.jsx("button",{type:"button",onClick:()=>R(!0),className:"relative mx-auto md:mx-0 w-32 h-32 sm:w-36 sm:h-36 rounded-full border-4 border-border/80 bg-gradient-to-br from-slate-800 via-slate-900 to-slate-700 flex items-center justify-center overflow-hidden shadow-lg",children:l?e.jsx("img",{src:`https://ddragon.leagueoflegends.com/cdn/${r}/img/champion/${l.id}.png`,alt:l.name,className:"w-full h-full object-cover"}):e.jsxs("span",{className:"text-[11px] sm:text-xs font-semibold tracking-[0.08em] text-muted-foreground uppercase text-center px-4",children:["Champion",e.jsx("br",{}),"Placeholder"]})}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] font-semibold tracking-[0.18em] text-muted-foreground uppercase",children:l?"Stats":"Champion Stats"}),l&&e.jsx("div",{className:"mt-1 text-sm font-semibold",children:l.name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[11px] text-muted-foreground",children:a.common.level}),e.jsx(O,{value:String(j),onChange:t=>{const n=Number(t.target.value);Number.isNaN(n)||S(Math.min(Math.max(n,1),18))},className:"h-8 w-18 text-xs px-2",children:Array.from({length:18}).map((t,n)=>e.jsx("option",{value:n+1,children:n+1},n+1))})]})]}),e.jsx("div",{className:"border-t border-border/60 pt-3",children:!p||!b?e.jsxs("div",{className:"space-y-1.5 text-[11px] text-muted-foreground",children:[e.jsx("div",{children:a.pages.simulation.statsPlaceholderLine1}),e.jsx("div",{children:a.pages.simulation.statsPlaceholderLine2})]}):e.jsxs("div",{className:"space-y-1.5 text-[11px]",children:[e.jsx(w,{label:a.stats.health,value:p.health,base:b.health}),e.jsx(w,{label:a.stats.attackDamage,value:p.attackDamage,base:b.attackDamage}),e.jsx(w,{label:a.stats.armor,value:p.armor,base:b.armor}),e.jsx(w,{label:a.stats.magicResist,value:p.magicResist,base:b.magicResist}),e.jsx(w,{label:a.stats.movespeed,value:p.movespeed,base:b.movespeed,precision:0}),_!=null&&e.jsx(w,{label:a.pages.simulation.aaDpsLabel,value:_,base:_,precision:1})]})})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-[11px] font-semibold tracking-[0.18em] text-muted-foreground uppercase",children:a.pages.simulation.itemsTitle}),e.jsxs("div",{className:"text-[10px] text-muted-foreground",children:[M.length," / 6"]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:Array.from({length:6}).map((t,n)=>{const x=$[n];return e.jsx("div",{className:"flex flex-col items-center gap-2",children:e.jsx("button",{type:"button",className:"w-16 h-16 sm:w-18 sm:h-18 rounded-md border border-border/70 bg-background/40 flex items-center justify-center overflow-hidden shadow-sm",onClick:()=>{P(n),A(!0)},children:x?e.jsx("img",{src:`https://ddragon.leagueoflegends.com/cdn/${r}/img/item/${x.id}.png`,alt:x.name,className:"w-full h-full object-cover"}):e.jsxs("span",{className:"text-[9px] text-muted-foreground text-center px-1",children:[a.pages.simulation.itemPlaceholderLine1,e.jsx("br",{}),a.pages.simulation.itemPlaceholderLine2]})})},n)})})]})]})}),e.jsxs(F,{className:"mt-6 bg-card/60 border-border/70",children:[e.jsx("div",{className:"border-b border-border/70 px-4 py-3",children:e.jsx("div",{className:"text-[11px] font-semibold tracking-[0.18em] text-muted-foreground uppercase",children:"Skills"})}),e.jsx("div",{className:"px-4 py-4 space-y-3",children:["Q","W","E","R"].map((t,n)=>{var I;const x=(I=l==null?void 0:l.spells)==null?void 0:I[n],u=q[n],N=l&&p?re(y,n,(u==null?void 0:u.maxrank)??(x==null?void 0:x.maxrank)??1,p):null;return e.jsxs("div",{className:"flex items-start gap-3 border border-border/50 rounded-md px-3 py-2 bg-background/40",children:[e.jsx("div",{className:"w-8 h-8 rounded-sm border border-border/70 bg-slate-900 flex items-center justify-center text-xs font-bold text-amber-300",children:t}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("div",{className:"text-[11px] font-semibold",children:x?`${t}: ${x.name}`:`${t}: Skill Description Placeholder`}),e.jsx("div",{className:"text-[11px] text-muted-foreground leading-snug",children:x?x.description:"Skill Description Placeholder"}),N&&N.totalDamage!=null&&e.jsxs("div",{className:"text-[10px] text-emerald-400 mt-1",children:["예상 피해 (아이템/레벨 반영):"," ",N.totalDamage.toFixed(1)]})]})]},t)})})]}),e.jsxs("div",{className:"mt-6 grid gap-4 md:grid-cols-[minmax(0,1.1fr)_minmax(0,1.1fr)]",children:[e.jsxs(F,{className:"p-4 bg-card/60 border-border/70 space-y-3",children:[e.jsx("div",{className:"text-[11px] font-semibold tracking-[0.18em] text-muted-foreground uppercase",children:"Summoner Spells"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-md border border-border/70 bg-background/40"}),e.jsx("div",{className:"w-10 h-10 rounded-md border border-border/70 bg-background/40"})]}),e.jsx("div",{className:"text-[11px] text-muted-foreground",children:"추후 소환사 주문 시뮬레이션을 여기에 추가할 수 있습니다."})]}),e.jsxs(F,{className:"p-4 bg-card/60 border-border/70 space-y-3",children:[e.jsx("div",{className:"text-[11px] font-semibold tracking-[0.18em] text-muted-foreground uppercase",children:"Runes"}),e.jsx("div",{className:"flex items-center gap-2",children:Array.from({length:6}).map((t,n)=>e.jsx("div",{className:"w-8 h-8 rounded-full border border-border/70 bg-background/40"},n))}),e.jsx("div",{className:"text-[11px] text-muted-foreground",children:"룬 시뮬레이션을 추가할 때 이 영역을 재사용할 수 있습니다."})]})]}),e.jsx(ee,{championList:E,selectedChampions:l&&s?s.filter(t=>t.id===l.id):[],onSelect:t=>{m(t.id)},onClose:()=>R(!1),open:T,onOpenChange:R}),e.jsx(U,{open:B,onOpenChange:t=>{A(t),t||P(null)},children:e.jsxs(G,{className:"max-w-xl",children:[e.jsxs(J,{children:[e.jsx(K,{className:"text-base",children:a.pages.simulation.itemModalTitle}),e.jsx(X,{className:"text-xs",children:a.pages.simulation.itemModalDescription})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-[11px] text-muted-foreground",children:a.pages.simulation.itemModalHint}),e.jsx(Y,{type:"button",variant:"ghost",size:"sm",className:"h-7 px-2 text-[11px]",onClick:()=>{D!=null&&(C(t=>{const n=[...t];return n[D]=null,n}),A(!1),P(null))},children:a.pages.simulation.clearItemSlot})]}),e.jsx(Z,{className:"h-80 rounded-md border bg-background/60",children:e.jsx("div",{className:"p-2 space-y-1",children:f.slice(0,300).map(t=>{const n=D!=null&&v[D]===t.id,x=!!t.gold&&t.gold.total>0&&t.gold.purchasable!==!1&&t.inStore!==!1;return e.jsxs("button",{type:"button",onClick:()=>{D!=null&&(C(u=>{const N=[...u];return N[D]=t.id,N}),A(!1),P(null))},className:`w-full flex items-center gap-2 rounded px-2 py-1.5 text-left text-[11px] transition-colors ${n?"bg-primary/10 text-primary border border-primary/40":"hover:bg-muted/60 text-foreground/80"}`,children:[e.jsx("img",{src:`https://ddragon.leagueoflegends.com/cdn/${r}/img/item/${t.id}.png`,alt:t.name,className:"w-6 h-6 rounded-sm border border-border/60 bg-black/40"}),e.jsx("span",{className:"flex-1 truncate",children:t.name}),x&&e.jsx("span",{className:"text-[10px] text-amber-600 dark:text-amber-400 font-semibold",children:t.gold.total.toLocaleString()})]},t.id)})})})]})]})})]}):e.jsx("div",{className:"w-full max-w-5xl mx-auto px-4 md:px-6 lg:px-8 py-8 md:py-10",children:e.jsx("div",{className:"text-sm text-muted-foreground",children:a.championSelector.loading})})}export{fe as default};
