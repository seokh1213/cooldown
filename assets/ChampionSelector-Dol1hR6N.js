import{j as e,d as G,r,f as W,O as Z,g as M}from"/cooldown/assets/react-vendor-CopeUkDP.js";import{m as w,B as z,u as J,y as H,C as K,D as ee,V as se,d as te,e as re}from"/cooldown/assets/index-D9lNrV-8.js";import{u as ae,I as q}from"/cooldown/assets/useDebouncedValue-Dzsu1l-N.js";import{i as ne,f as V,X as U,S as _}from"/cooldown/assets/lucide-icons-DTvcjo7T.js";function le({className:a,...l}){return e.jsx("div",{className:w("animate-pulse rounded-md bg-muted",a),...l})}function oe({addChampion:a,data:l,name:o,thumbnailSrc:i,selected:c}){const[n,p]=r.useState(!1),[t,d]=r.useState(!1),[b,y]=r.useState(c);r.useEffect(()=>{y(c)},[c]);const N=r.useCallback(S=>{S.preventDefault(),S.stopPropagation(),y(v=>!v),a(l)},[a,l]),f=r.useCallback(()=>{p(!0)},[]),h=r.useCallback(()=>{d(!0)},[]);return e.jsxs("div",{className:"flex flex-col items-center justify-center m-1 h-fit",children:[e.jsxs(z,{variant:"ghost",className:"cursor-pointer rounded-full shrink-0 p-0 h-auto w-auto hover:bg-transparent relative touch-manipulation",onClick:N,"aria-label":c?`Deselect ${o}`:`Select ${o}`,"aria-pressed":c,children:[e.jsxs("div",{className:"relative w-12 h-12 md:w-14 md:h-14 shrink-0 overflow-hidden rounded-full",children:[!n&&!t&&e.jsx(le,{className:"absolute inset-0 rounded-full"}),!n&&!t&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-muted via-muted/80 to-muted/60 blur-sm"}),e.jsx("img",{className:w("absolute inset-0 w-full h-full rounded-full bg-black/5 border-0 box-border transition-all duration-200 ease-out object-cover",!c&&!b&&"hover:scale-105",n?"opacity-100":"opacity-0"),src:i,alt:o,loading:"lazy",decoding:"async",width:"56",height:"56",onLoad:f,onError:h}),(b||c)&&e.jsx("div",{className:"absolute inset-0 rounded-full pointer-events-none z-10",style:{boxShadow:"inset 0 0 0 2px hsl(var(--primary)), 0 0 0 3px hsl(var(--primary) / 0.3)"}})]}),(b||c)&&e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-4 h-4 md:w-5 md:h-5 bg-primary rounded-full flex items-center justify-center pointer-events-none z-20 shadow-lg border-2 border-background",children:e.jsx(ne,{className:"w-2.5 h-2.5 md:w-3 md:h-3 text-primary-foreground stroke-[3]"})})]}),e.jsx("div",{className:"text-xs md:text-sm whitespace-nowrap mt-0.5",children:o})]})}const X=G.memo(oe);function ie(a,l){const{lang:o}=J();return r.useMemo(()=>{if(!a)return[];if(!l)return a;const c=H(l,o);return a.filter(n=>c.some(p=>{const t=p.toLowerCase();return!!(n.name.toLowerCase().includes(t)||n.hangul&&n.hangul.toLowerCase().includes(t)||n.id.toLowerCase().includes(t)||o==="ko_KR"&&(H(n.name,o).some(b=>b.toLowerCase().includes(t))||n.hangul&&H(n.hangul,o).some(y=>y.toLowerCase().includes(t))))}))},[a,l,o])}const Y="championSelectorScrollPosition";function ce(a,l,o){r.useEffect(()=>{if(!l||!o)return;const i=()=>{if(a.current){const c=sessionStorage.getItem(Y);if(c){const n=parseInt(c,10);a.current.scrollTop=n}}};i(),requestAnimationFrame(()=>{i()}),setTimeout(()=>{i()},200)},[l,o,a]),r.useEffect(()=>{const i=a.current;if(!i||!l||!o)return;let c;const n=()=>{clearTimeout(c),c=setTimeout(()=>{sessionStorage.setItem(Y,i.scrollTop.toString())},100)};return i.addEventListener("scroll",n,{passive:!0}),()=>{clearTimeout(c),i.removeEventListener("scroll",n)}},[l,o,a])}function de({championList:a,selectedChampions:l,onSelect:o,onClose:i,slotIndex:c,open:n,onOpenChange:p,vsMode:t}){const{t:d}=J(),[b,y]=r.useState(!1),N=n!==void 0,f=N?!!n:b,h=N?p||(()=>{}):y,[S,v]=r.useState(""),[x,j]=r.useState(-1),I=r.useRef(null),D=r.useRef(null),k=r.useRef(null),m=i!==void 0,P=i||(()=>{}),Q=ae(S,200),g=ie(a,Q),F=r.useMemo(()=>new Set(l.map(s=>s.id)),[l]),E=r.useMemo(()=>t&&(l.find(s=>s.id===t.currentChampionId)||(a==null?void 0:a.find(s=>s.id===t.currentChampionId)))||null,[t,l,a]),B=r.useMemo(()=>t?g.filter(s=>s.id!==t.currentChampionId):g,[g,t]),L=r.useCallback(s=>{const u=s.target;I.current&&!I.current.contains(u)&&(h(!1),v(""),j(-1))},[h]);r.useEffect(()=>{if(f&&!m)return document.addEventListener("mousedown",L),()=>{document.removeEventListener("mousedown",L)}},[f,L,m]);const C=r.useCallback(s=>{h(s),s||(v(""),j(-1),i&&i()),p&&p(s)},[i,p]),T=r.useCallback(s=>{o(s),m?j(-1):(h(!1),j(-1),document.body.style.overflow="",P())},[o,i,m]),$=r.useCallback(s=>{if(!(!f&&!m||!a))if(s.key==="ArrowDown")s.preventDefault(),j(u=>u<g.length-1?u+1:u);else if(s.key==="ArrowUp")s.preventDefault(),j(u=>u>0?u-1:-1);else if(s.key==="Enter"&&x>=0){s.preventDefault();const u=g[x];u&&T(u)}else s.key==="Escape"&&C(!1)},[f,m,a,g,x,T,C,F]);return r.useEffect(()=>{if(x>=0&&k.current){const s=k.current.querySelectorAll("[data-champion-item]");s[x]&&s[x].scrollIntoView({block:"nearest"})}},[x]),r.useEffect(()=>{N||h(!!m)},[m,N,h]),ce(k,m,f),r.useEffect(()=>{m&&f&&requestAnimationFrame(()=>{var s;(s=D.current)==null||s.focus()})},[m,f]),m?N&&!f?null:e.jsx(ee,{open:f,onOpenChange:C,children:e.jsxs(W,{children:[e.jsx(Z,{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm"}),e.jsxs(M,{ref:I,className:"fixed inset-0 left-0 top-0 translate-x-0 translate-y-0 md:inset-auto md:left-[50%] md:top-[50%] md:translate-x-[-50%] md:translate-y-[-50%] w-full h-full md:w-[600px] md:h-[500px] lg:w-[800px] lg:h-[600px] p-0 flex flex-col overflow-hidden max-w-none md:max-w-[600px] lg:max-w-[800px] max-h-none md:max-h-[500px] lg:max-h-[600px] rounded-none md:rounded-xl z-50 border bg-background shadow-lg",onInteractOutside:()=>{C(!1)},onEscapeKeyDown:()=>{C(!1)},children:[e.jsxs(se,{children:[e.jsx(te,{children:t?d.championSelector.vsSelectOpponent:d.championSelector.selectChampion}),e.jsx(re,{children:t?d.championSelector.vsSelectOpponentDescription:d.championSelector.selectChampionDescription})]}),t&&E&&e.jsxs("div",{className:"p-4 border-b-2 border-destructive/30 bg-destructive/5 flex items-center gap-3 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:K(E.version||"",E.id),alt:E.name,className:"w-10 h-10 rounded-full border-2 border-destructive/50"}),e.jsx("div",{className:"absolute -top-1 -right-1 bg-destructive rounded-full p-0.5",children:e.jsx(_,{className:"h-3 w-3 text-white"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-semibold text-foreground",children:E.name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:d.championSelector.currentChampion})]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-destructive",children:[e.jsx(_,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-semibold",children:"VS"})]})]}),e.jsxs("div",{className:w("p-4 border-b border-border flex items-center gap-2 shrink-0",t?"bg-muted/30":"bg-card"),children:[e.jsx(V,{className:w("h-5 w-5 shrink-0",t?"text-destructive":"text-muted-foreground")}),e.jsx(q,{ref:D,type:"text",placeholder:t?d.championSelector.vsSearchPlaceholder:d.championSelector.searchPlaceholder,value:S,onChange:s=>{v(s.target.value),j(-1)},onKeyDown:$,className:"flex-1",autoFocus:!0}),e.jsx(z,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0 hover:bg-muted hover:text-foreground",onClick:()=>C(!1),children:e.jsx(U,{className:"h-4 w-4"})})]}),e.jsx("div",{ref:k,className:"overflow-y-auto overflow-x-hidden p-4 flex-1 min-h-0 md:flex-none md:w-[600px] md:h-[427px] lg:w-[800px] lg:h-[527px]",children:a?(t?B:g).length>0?e.jsxs(e.Fragment,{children:[t&&e.jsx("div",{className:"mb-3 pb-2 border-b border-destructive/20",children:e.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[e.jsx(_,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-semibold",children:d.championSelector.selectOpponentLabel})]})}),e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10 gap-2",children:(t?B:g).map((s,u)=>{const R=x===u,A=t?!1:F.has(s.id);return e.jsx("div",{"data-champion-item":!0,className:w(R&&"ring-2 ring-offset-1 rounded-md",t?"ring-destructive":"ring-primary"),children:e.jsx(X,{addChampion:O=>T(O),data:s,name:s.name,selected:A,thumbnailSrc:K(s.version||"",s.id)})},s.id)})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground min-h-[200px] space-y-2",children:[e.jsx(V,{className:"h-12 w-12 opacity-50"}),e.jsx("p",{className:"text-base font-medium",children:S?d.championSelector.noResults:d.championSelector.emptyList})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground min-h-[200px]",children:d.championSelector.loading})})]})]})}):e.jsxs("div",{ref:I,className:"w-full",children:[e.jsxs(z,{onClick:()=>{h(!0),setTimeout(()=>{var s;return(s=D.current)==null?void 0:s.focus()},0)},variant:"ghost",className:w("w-full flex flex-col items-center justify-center space-y-2","text-muted-foreground hover:text-foreground","py-4 h-auto"),children:[e.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-dashed border-muted-foreground/30 flex items-center justify-center",children:e.jsx(V,{className:"w-6 h-6"})}),e.jsx("span",{className:"text-sm font-medium",children:d.championSelector.selectChampion})]}),f&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 md:hidden",onClick:()=>{h(!1),v(""),document.body.style.overflow="",P()},"aria-hidden":"true"}),e.jsxs("div",{className:w("fixed inset-0 z-50 md:absolute md:inset-auto md:top-full md:left-0 md:right-0 md:mt-2 md:z-10 md:rounded-lg md:border md:border-border md:shadow-lg bg-card md:max-h-[60vh] flex flex-col",m&&"md:relative md:inset-0 md:mt-0 md:rounded-lg md:border md:shadow-lg"),children:[e.jsxs("div",{className:"p-4 border-b border-border flex items-center gap-2 sticky top-0 bg-card z-10",children:[e.jsx(V,{className:"h-5 w-5 text-muted-foreground shrink-0"}),e.jsx(q,{ref:D,type:"text",placeholder:d.championSelector.searchPlaceholder,value:S,onChange:s=>{v(s.target.value),j(-1)},onKeyDown:$,className:"flex-1",autoFocus:!0}),e.jsx(z,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0 hover:bg-muted hover:text-foreground",onClick:()=>{h(!1),v(""),document.body.style.overflow="",P()},children:e.jsx(U,{className:"h-4 w-4"})})]}),e.jsx("div",{ref:k,className:"flex-1 overflow-auto p-4",style:{maxHeight:"calc(100vh - 120px)"},children:a?e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10 gap-2",children:g.map((s,u)=>{const R=x===u,A=F.has(s.id);return e.jsx("div",{"data-champion-item":!0,className:w(R&&"ring-2 ring-primary ring-offset-1 rounded-md"),children:e.jsx(X,{addChampion:O=>T(O),data:s,name:s.name,selected:A,thumbnailSrc:K(s.version||"",s.id)})},s.id)})}):e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:d.championSelector.loading})})]})]})]})}const xe=G.memo(de);export{xe as C};
