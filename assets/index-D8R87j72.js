import{r as b,j as e,d as K,f as nr,O as ar,g as lr,z as lt,A as Ne,E as ot,K as it,F as ct,G as dt,I as ut,J as mt,L as ft,M as ye,N as we,Q as Rt,U as or}from"/cooldown/assets/react-vendor-D9kQI8Cv.js";import{C as xt,a as Mt}from"/cooldown/assets/card-C1SIRTaE.js";import{c as _,B as oe,u as X,g as Je,C as ne,D as Oe,V as Ke,a as He,b as Ue,d as be,l as H,e as ir,f as Le,P as cr,S as jt,h as pt,i as Se,T as rt,j as st,k as nt,m as De,r as ce,n as Me,o as _e,p as vt,q as Be,s as dr,t as ur,v as mr,w as Ye}from"/cooldown/assets/index-CkcDkDJ3.js";import{I as Fe,T as fr,a as xr,b as Ae}from"/cooldown/assets/tabs-DTEWmfss.js";import{e as pr,f as $e,X as ke,S as Ie,g as Ge,h as We,T as Nt,R as hr}from"/cooldown/assets/lucide-icons-QKYEtl3H.js";const pe=b.forwardRef(({className:t,...r},s)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:s,className:_("w-full caption-bottom text-sm",t),...r})}));pe.displayName="Table";const he=b.forwardRef(({className:t,...r},s)=>e.jsx("thead",{ref:s,className:_("[&_tr]:border-b",t),...r}));he.displayName="TableHeader";const ge=b.forwardRef(({className:t,...r},s)=>e.jsx("tbody",{ref:s,className:_("[&_tr:last-child]:border-0",t),...r}));ge.displayName="TableBody";const gr=b.forwardRef(({className:t,...r},s)=>e.jsx("tfoot",{ref:s,className:_("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...r}));gr.displayName="TableFooter";const Y=b.forwardRef(({className:t,...r},s)=>e.jsx("tr",{ref:s,className:_("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...r}));Y.displayName="TableRow";const W=b.forwardRef(({className:t,...r},s)=>e.jsx("th",{ref:s,className:_("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...r}));W.displayName="TableHead";const O=b.forwardRef(({className:t,...r},s)=>e.jsx("td",{ref:s,className:_("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...r}));O.displayName="TableCell";const br=b.forwardRef(({className:t,...r},s)=>e.jsx("caption",{ref:s,className:_("mt-4 text-sm text-muted-foreground",t),...r}));br.displayName="TableCaption";function jr({className:t,...r}){return e.jsx("div",{className:_("animate-pulse rounded-md bg-muted",t),...r})}function vr({addChampion:t,data:r,name:s,thumbnailSrc:n,selected:a}){const[o,d]=b.useState(!1),[i,p]=b.useState(!1),[x,g]=b.useState(a);b.useEffect(()=>{g(a)},[a]);const w=b.useCallback(y=>{y.preventDefault(),y.stopPropagation(),g(j=>!j),t(r)},[t,r]),P=b.useCallback(()=>{d(!0)},[]),l=b.useCallback(()=>{p(!0)},[]);return e.jsxs("div",{className:"flex flex-col items-center justify-center m-1 h-fit",children:[e.jsxs(oe,{variant:"ghost",className:"cursor-pointer rounded-full shrink-0 p-0 h-auto w-auto hover:bg-transparent relative touch-manipulation",onClick:w,"aria-label":a?`Deselect ${s}`:`Select ${s}`,"aria-pressed":a,children:[e.jsxs("div",{className:"relative w-12 h-12 md:w-14 md:h-14 shrink-0 overflow-hidden rounded-full",children:[!o&&!i&&e.jsx(jr,{className:"absolute inset-0 rounded-full"}),!o&&!i&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-muted via-muted/80 to-muted/60 blur-sm"}),e.jsx("img",{className:_("absolute inset-0 w-full h-full rounded-full bg-black/5 border-0 box-border transition-all duration-200 ease-out object-cover",!a&&!x&&"hover:scale-105",o?"opacity-100":"opacity-0"),src:n,alt:s,loading:"lazy",decoding:"async",width:"56",height:"56",onLoad:P,onError:l}),(x||a)&&e.jsx("div",{className:"absolute inset-0 rounded-full pointer-events-none z-10",style:{boxShadow:"inset 0 0 0 2px hsl(var(--primary)), 0 0 0 3px hsl(var(--primary) / 0.3)"}})]}),(x||a)&&e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-4 h-4 md:w-5 md:h-5 bg-primary rounded-full flex items-center justify-center pointer-events-none z-20 shadow-lg border-2 border-background",children:e.jsx(pr,{className:"w-2.5 h-2.5 md:w-3 md:h-3 text-primary-foreground stroke-[3]"})})]}),e.jsx("div",{className:"text-xs md:text-sm whitespace-nowrap mt-0.5",children:s})]})}const yt=K.memo(vr);function Nr(t,r){const{lang:s}=X();return b.useMemo(()=>{if(!t)return[];if(!r)return t;const a=Je(r,s);return t.filter(o=>a.some(d=>{const i=d.toLowerCase();return!!(o.name.toLowerCase().includes(i)||o.hangul&&o.hangul.toLowerCase().includes(i)||o.id.toLowerCase().includes(i)||s==="ko_KR"&&(Je(o.name,s).some(x=>x.toLowerCase().includes(i))||o.hangul&&Je(o.hangul,s).some(g=>g.toLowerCase().includes(i))))}))},[t,r,s])}const wt="championSelectorScrollPosition";function yr(t,r,s){b.useEffect(()=>{if(!r||!s)return;const n=()=>{if(t.current){const a=sessionStorage.getItem(wt);if(a){const o=parseInt(a,10);t.current.scrollTop=o}}};n(),requestAnimationFrame(()=>{n()}),setTimeout(()=>{n()},200)},[r,s,t]),b.useEffect(()=>{const n=t.current;if(!n||!r||!s)return;let a;const o=()=>{clearTimeout(a),a=setTimeout(()=>{sessionStorage.setItem(wt,n.scrollTop.toString())},100)};return n.addEventListener("scroll",o,{passive:!0}),()=>{clearTimeout(a),n.removeEventListener("scroll",o)}},[r,s,t])}function wr({championList:t,selectedChampions:r,onSelect:s,onClose:n,slotIndex:a,open:o,onOpenChange:d,vsMode:i}){const{t:p}=X(),[x,g]=b.useState(!1),w=o!==void 0,P=w?!!o:x,l=w?d||(()=>{}):g,[y,j]=b.useState(""),[c,u]=b.useState(-1),f=b.useRef(null),S=b.useRef(null),h=b.useRef(null),v=n!==void 0,N=n||(()=>{}),C=Nr(t,y),V=b.useMemo(()=>new Set(r.map(m=>m.id)),[r]),A=b.useMemo(()=>i&&(r.find(m=>m.id===i.currentChampionId)||(t==null?void 0:t.find(m=>m.id===i.currentChampionId)))||null,[i,r,t]),R=b.useMemo(()=>i?C.filter(m=>m.id!==i.currentChampionId):C,[C,i]),B=b.useCallback(m=>{const T=m.target;f.current&&!f.current.contains(T)&&(l(!1),j(""),u(-1))},[l]);b.useEffect(()=>{if(P&&!v)return document.addEventListener("mousedown",B),()=>{document.removeEventListener("mousedown",B)}},[P,B,v]);const I=b.useCallback(m=>{l(m),m||(j(""),u(-1),n&&n()),d&&d(m)},[n,d]),z=b.useCallback(m=>{s(m),v?u(-1):(l(!1),u(-1),document.body.style.overflow="",N())},[s,n,v]),G=b.useCallback(m=>{if(!(!P&&!v||!t))if(m.key==="ArrowDown")m.preventDefault(),u(T=>T<C.length-1?T+1:T);else if(m.key==="ArrowUp")m.preventDefault(),u(T=>T>0?T-1:-1);else if(m.key==="Enter"&&c>=0){m.preventDefault();const T=C[c];T&&z(T)}else m.key==="Escape"&&I(!1)},[P,v,t,C,c,z,I,V]);return b.useEffect(()=>{if(c>=0&&h.current){const m=h.current.querySelectorAll("[data-champion-item]");m[c]&&m[c].scrollIntoView({block:"nearest"})}},[c]),b.useEffect(()=>{w||l(!!v)},[v,w,l]),yr(h,v,P),b.useEffect(()=>{v&&P&&requestAnimationFrame(()=>{var m;(m=S.current)==null||m.focus()})},[v,P]),v?w&&!P?null:e.jsx(Oe,{open:P,onOpenChange:I,children:e.jsxs(nr,{children:[e.jsx(ar,{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm"}),e.jsxs(lr,{ref:f,className:"fixed inset-0 left-0 top-0 translate-x-0 translate-y-0 md:inset-auto md:left-[50%] md:top-[50%] md:translate-x-[-50%] md:translate-y-[-50%] w-full h-full md:w-[600px] md:h-[500px] lg:w-[800px] lg:h-[600px] p-0 flex flex-col overflow-hidden max-w-none md:max-w-[600px] lg:max-w-[800px] max-h-none md:max-h-[500px] lg:max-h-[600px] rounded-none md:rounded-xl z-50 border bg-background shadow-lg",onInteractOutside:()=>{I(!1)},onEscapeKeyDown:()=>{I(!1)},children:[e.jsxs(Ke,{children:[e.jsx(He,{children:i?p.championSelector.vsSelectOpponent:p.championSelector.selectChampion}),e.jsx(Ue,{children:i?p.championSelector.vsSelectOpponentDescription:p.championSelector.selectChampionDescription})]}),i&&A&&e.jsxs("div",{className:"p-4 border-b-2 border-destructive/30 bg-destructive/5 flex items-center gap-3 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:ne(A.version||"",A.id),alt:A.name,className:"w-10 h-10 rounded-full border-2 border-destructive/50"}),e.jsx("div",{className:"absolute -top-1 -right-1 bg-destructive rounded-full p-0.5",children:e.jsx(Ie,{className:"h-3 w-3 text-white"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-semibold text-foreground",children:A.name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:p.championSelector.currentChampion})]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-destructive",children:[e.jsx(Ie,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-semibold",children:"VS"})]})]}),e.jsxs("div",{className:_("p-4 border-b border-border flex items-center gap-2 shrink-0",i?"bg-muted/30":"bg-card"),children:[e.jsx($e,{className:_("h-5 w-5 shrink-0",i?"text-destructive":"text-muted-foreground")}),e.jsx(Fe,{ref:S,type:"text",placeholder:i?p.championSelector.vsSearchPlaceholder:p.championSelector.searchPlaceholder,value:y,onChange:m=>{j(m.target.value),u(-1)},onKeyDown:G,className:"flex-1",autoFocus:!0}),e.jsx(oe,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0 hover:bg-muted hover:text-foreground",onClick:()=>I(!1),children:e.jsx(ke,{className:"h-4 w-4"})})]}),e.jsx("div",{ref:h,className:"overflow-y-auto overflow-x-hidden p-4 flex-1 min-h-0 md:flex-none md:w-[600px] md:h-[427px] lg:w-[800px] lg:h-[527px]",children:t?(i?R:C).length>0?e.jsxs(e.Fragment,{children:[i&&e.jsx("div",{className:"mb-3 pb-2 border-b border-destructive/20",children:e.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[e.jsx(Ie,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-semibold",children:p.championSelector.selectOpponentLabel})]})}),e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10 gap-2",children:(i?R:C).map((m,T)=>{const M=c===T,L=i?!1:V.has(m.id);return e.jsx("div",{"data-champion-item":!0,className:_(M&&"ring-2 ring-offset-1 rounded-md",i?"ring-destructive":"ring-primary"),children:e.jsx(yt,{addChampion:k=>z(k),data:m,name:m.name,selected:L,thumbnailSrc:ne(m.version||"",m.id)})},m.id)})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground min-h-[200px] space-y-2",children:[e.jsx($e,{className:"h-12 w-12 opacity-50"}),e.jsx("p",{className:"text-base font-medium",children:y?p.championSelector.noResults:p.championSelector.emptyList})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground min-h-[200px]",children:p.championSelector.loading})})]})]})}):e.jsxs("div",{ref:f,className:"w-full",children:[e.jsxs(oe,{onClick:()=>{l(!0),setTimeout(()=>{var m;return(m=S.current)==null?void 0:m.focus()},0)},variant:"ghost",className:_("w-full flex flex-col items-center justify-center space-y-2","text-muted-foreground hover:text-foreground","py-4 h-auto"),children:[e.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-dashed border-muted-foreground/30 flex items-center justify-center",children:e.jsx($e,{className:"w-6 h-6"})}),e.jsx("span",{className:"text-sm font-medium",children:p.championSelector.selectChampion})]}),P&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 md:hidden",onClick:()=>{l(!1),j(""),document.body.style.overflow="",N()},"aria-hidden":"true"}),e.jsxs("div",{className:_("fixed inset-0 z-50 md:absolute md:inset-auto md:top-full md:left-0 md:right-0 md:mt-2 md:z-10 md:rounded-lg md:border md:border-border md:shadow-lg bg-card md:max-h-[60vh] flex flex-col",v&&"md:relative md:inset-0 md:mt-0 md:rounded-lg md:border md:shadow-lg"),children:[e.jsxs("div",{className:"p-4 border-b border-border flex items-center gap-2 sticky top-0 bg-card z-10",children:[e.jsx($e,{className:"h-5 w-5 text-muted-foreground shrink-0"}),e.jsx(Fe,{ref:S,type:"text",placeholder:p.championSelector.searchPlaceholder,value:y,onChange:m=>{j(m.target.value),u(-1)},onKeyDown:G,className:"flex-1",autoFocus:!0}),e.jsx(oe,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0 hover:bg-muted hover:text-foreground",onClick:()=>{l(!1),j(""),document.body.style.overflow="",N()},children:e.jsx(ke,{className:"h-4 w-4"})})]}),e.jsx("div",{ref:h,className:"flex-1 overflow-auto p-4",style:{maxHeight:"calc(100vh - 120px)"},children:t?e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10 gap-2",children:C.map((m,T)=>{const M=c===T,L=V.has(m.id);return e.jsx("div",{"data-champion-item":!0,className:_(M&&"ring-2 ring-primary ring-offset-1 rounded-md"),children:e.jsx(yt,{addChampion:k=>z(k),data:m,name:m.name,selected:L,thumbnailSrc:ne(m.version||"",m.id)})},m.id)})}):e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:p.championSelector.loading})})]})]})]})}const qe=K.memo(wr);function _t(t="ko_KR"){const r=be(t);return[{key:"hp",label:r.stats.health,format:s=>Math.round(s)},{key:"hpperlevel",label:r.stats.healthPerLevel,format:s=>s.toFixed(1)},{key:"mp",label:r.stats.mana,format:s=>Math.round(s)},{key:"mpperlevel",label:r.stats.manaPerLevel,format:s=>s.toFixed(1)},{key:"movespeed",label:r.stats.movespeed,format:s=>Math.round(s)},{key:"armor",label:r.stats.armor,format:s=>Math.round(s)},{key:"armorperlevel",label:r.stats.armorPerLevel,format:s=>s.toFixed(1)},{key:"spellblock",label:r.stats.spellblock,format:s=>Math.round(s)},{key:"spellblockperlevel",label:r.stats.spellblockPerLevel,format:s=>s.toFixed(1)},{key:"attackdamage",label:r.stats.attackdamage,format:s=>Math.round(s)},{key:"attackdamageperlevel",label:r.stats.attackdamagePerLevel,format:s=>s.toFixed(1)},{key:"attackspeed",label:r.stats.attackspeed,format:s=>s.toFixed(3)},{key:"attackspeedperlevel",label:r.stats.attackspeedPerLevel,format:s=>`${(s*100).toFixed(1)}%`},{key:"attackrange",label:r.stats.attackrange,format:s=>Math.round(s)},{key:"crit",label:r.stats.crit,format:s=>`${(s*100).toFixed(1)}%`},{key:"critperlevel",label:r.stats.critPerLevel,format:s=>`${(s*100).toFixed(1)}%`},{key:"hpregen",label:r.stats.hpregen,format:s=>s.toFixed(1)},{key:"hpregenperlevel",label:r.stats.hpregenPerLevel,format:s=>s.toFixed(1)},{key:"mpregen",label:r.stats.mpregen,format:s=>s.toFixed(1)},{key:"mpregenperlevel",label:r.stats.mpregenPerLevel,format:s=>s.toFixed(1)}]}const ve=["Q","W","E","R"];function Sr({champions:t,version:r,championList:s,onAddChampion:n,onRemoveChampion:a,onReorderChampions:o}){const{t:d,lang:i}=X(),[p,x]=b.useState(!1),g=_t(i),w=lt(Ne(ct,{activationConstraint:{distance:8}}),Ne(it,{coordinateGetter:ot})),P=c=>{},l=c=>{const{active:u,over:f}=c;if(f&&u.id!==f.id&&o){const S=t.findIndex(v=>v.id===u.id),h=t.findIndex(v=>v.id===f.id);S!==-1&&h!==-1&&o(S,h)}},y=({champion:c,children:u,className:f})=>{const{setNodeRef:S,transform:h,transition:v,isDragging:N}=ye({id:c.id,disabled:!0}),V={transform:h?we.Transform.toString(h):void 0,transition:N?v:void 0,opacity:N?.5:1};return e.jsx(O,{ref:S,style:V,className:f,children:u})},j=({champion:c,index:u})=>{const{attributes:f,listeners:S,setNodeRef:h,transform:v,transition:N,isDragging:C}=ye({id:c.id}),A={transform:v?we.Transform.toString(v):void 0,transition:C?N:void 0,opacity:C?.5:1};return e.jsx(W,{ref:h,style:A,className:_("text-center p-1.5 text-[11px] font-semibold text-foreground w-[100px] min-w-[100px] select-none",u<t.length-1&&"border-r border-border/30",C&&"z-50"),children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-1.5 relative",children:[o&&e.jsx("button",{...f,...S,className:"cursor-grab active:cursor-grabbing p-1 opacity-60 hover:opacity-100 transition-opacity absolute -left-2 top-1/2 -translate-y-1/2","aria-label":"Drag to reorder",children:e.jsx(We,{className:"h-4 w-4 text-muted-foreground"})}),e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:ne(r,c.id),alt:c.name,className:"w-8 h-8 rounded-full"}),a&&e.jsx(oe,{variant:"ghost",size:"icon",className:_("absolute -top-1 -right-1 h-4 w-4 rounded-full","bg-destructive/90 hover:bg-destructive text-white","hover:scale-110 transition-transform","shadow-md"),onClick:R=>{R.stopPropagation(),a(c.id)},"aria-label":`Remove ${c.name}`,children:e.jsx(ke,{className:"h-2.5 w-2.5"})})]}),e.jsx("div",{className:"text-[10px] font-semibold leading-tight text-center break-words text-foreground",children:c.name})]})})};return e.jsxs("div",{className:"relative",children:[e.jsx(dt,{sensors:w,collisionDetection:ut,onDragStart:P,onDragEnd:l,children:e.jsx("div",{className:"border border-border/30 rounded-lg overflow-hidden",children:e.jsxs(pe,{className:"border-collapse table-fixed w-auto",children:[e.jsx(he,{children:e.jsxs(Y,{className:"border-b border-border/30 select-none",children:[e.jsx(W,{className:"text-left p-1.5 pl-2 text-[11px] font-semibold text-foreground sticky left-0 bg-card z-20 w-[90px] min-w-[90px] border-r border-border/30 select-none",style:{left:0},children:d.stats.label}),e.jsx(mt,{items:t.map(c=>c.id),strategy:ft,children:t.map((c,u)=>e.jsx(j,{champion:c,index:u},c.id))}),n&&e.jsx(W,{className:"text-center p-1.5 text-[11px] font-semibold text-foreground w-[100px] min-w-[100px] border-l border-border/30 select-none",children:e.jsxs(oe,{onClick:()=>x(!0),variant:"outline",className:"w-full flex flex-row items-center justify-center gap-2 p-1.5 h-auto border-2 border-dashed border-muted-foreground/30 hover:border-primary/50 hover:bg-muted/30 group",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-muted/30 flex items-center justify-center group-hover:bg-primary/10 transition-colors",children:e.jsx(Ge,{className:"w-4 h-4 text-muted-foreground group-hover:text-primary transition-colors"})}),e.jsx("div",{className:"text-[10px] text-muted-foreground group-hover:text-primary transition-colors whitespace-nowrap",children:"추가"})]})})]})}),e.jsx(ge,{children:g.map(c=>{const u=t.map(h=>{var v;return((v=h.stats)==null?void 0:v[c.key])??0}),f=Math.max(...u),S=Math.min(...u);return e.jsxs(Y,{className:"border-b border-border/30 hover:bg-muted/30 transition-colors",children:[e.jsx(O,{className:"p-1.5 pl-2 text-[11px] font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",style:{wordBreak:"keep-all",left:0},children:c.label}),t.map((h,v)=>{var A;const N=((A=h.stats)==null?void 0:A[c.key])??0,C=N===f&&f!==S,V=N===S&&f!==S;return e.jsx(y,{champion:h,className:_("p-1.5 text-[11px] text-center",v<t.length-1&&"border-r border-border/30",C&&"text-primary font-semibold",V&&"text-muted-foreground"),children:c.format(N)},h.id)}),n&&e.jsx(O,{className:"p-1.5 text-center border-l border-border/30",children:e.jsx("div",{className:"w-full h-full min-h-[24px]"})})]},c.key)})})]})})}),p&&n&&s&&e.jsx(qe,{championList:s,selectedChampions:t,onSelect:c=>{n(c)},onClose:()=>x(!1)})]})}function kr({champions:t,version:r,vsMode:s}){const{t:n,lang:a}=X(),o=_t(a);if(s&&t.length===2){const d=s.championA,i=s.championB;return e.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:e.jsx("div",{className:"min-w-full",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"border border-border/30 rounded-lg overflow-hidden",children:e.jsxs(pe,{className:"border-collapse table-fixed w-auto min-w-full",children:[e.jsx(he,{children:e.jsxs(Y,{className:"border-b border-border/30 select-none",children:[e.jsx(W,{className:"text-left p-1.5 pl-2 text-[10px] font-semibold text-foreground sticky left-0 bg-card z-20 w-[50px] min-w-[50px] border-r border-border/30 select-none",style:{left:0},children:n.stats.label}),e.jsx(W,{className:"text-center p-1.5 text-[10px] font-semibold text-foreground w-1/2 border-r border-border/30 select-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-0.5",children:[e.jsx("img",{src:ne(r,d.id),alt:d.name,className:"w-6 h-6 rounded-full",draggable:"false"}),e.jsx("div",{className:"text-xs font-semibold leading-tight text-center text-foreground",children:d.name})]})}),e.jsx(W,{className:"text-center p-1.5 text-[10px] font-semibold text-foreground w-[40px] min-w-[40px] border-r border-border/30 bg-muted/20 select-none",children:e.jsx("div",{className:"text-[9px] font-bold",children:"VS"})}),e.jsx(W,{className:"text-center p-1.5 text-[10px] font-semibold text-foreground w-1/2 select-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-0.5",children:[e.jsx("img",{src:ne(r,i.id),alt:i.name,className:"w-6 h-6 rounded-full",draggable:"false"}),e.jsx("div",{className:"text-xs font-semibold leading-tight text-center text-foreground",children:i.name})]})})]})}),e.jsx(ge,{children:o.map(p=>{var l,y;const x=((l=d.stats)==null?void 0:l[p.key])??0,g=((y=i.stats)==null?void 0:y[p.key])??0,w=Math.max(x,g),P=Math.min(x,g);return e.jsxs(Y,{className:"border-b border-border/30 hover:bg-muted/30 transition-colors",children:[e.jsx(O,{className:"p-1.5 pl-2 text-[10px] font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",style:{wordBreak:"keep-all",left:0},children:p.label}),e.jsx(O,{className:_("p-1.5 text-[10px] text-center border-r border-border/30",x===w&&w!==P&&"text-primary font-semibold",x===P&&w!==P&&"text-muted-foreground"),children:p.format(x)}),e.jsx(O,{className:"p-1.5 border-r border-border/30 bg-muted/20 select-none"}),e.jsx(O,{className:_("p-1.5 text-[10px] text-center",g===w&&w!==P&&"text-primary font-semibold",g===P&&w!==P&&"text-muted-foreground"),children:p.format(g)})]},p.key)})})]})})})})})}return e.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:e.jsx("div",{className:"min-w-full",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"border border-border/30 rounded-lg overflow-hidden",children:e.jsxs(pe,{className:"border-collapse table-fixed w-auto min-w-full",children:[e.jsx(he,{children:e.jsxs(Y,{className:"border-b border-border/30 select-none",children:[e.jsx(W,{className:"text-left p-1.5 pl-2 text-[11px] font-semibold text-foreground sticky left-0 bg-card z-20 w-[70px] min-w-[70px] border-r border-border/30 select-none",style:{left:0},children:n.stats.label}),t.map(d=>e.jsx(W,{className:"text-center p-1.5 text-[11px] font-semibold text-foreground w-full select-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-1",children:[e.jsx("img",{src:ne(r,d.id),alt:d.name,className:"w-8 h-8 rounded-full",draggable:"false"}),e.jsx("div",{className:"text-sm font-semibold leading-tight text-center text-foreground",children:d.name})]})},d.id))]})}),e.jsx(ge,{children:o.map(d=>{const i=t.map(g=>{var w;return((w=g.stats)==null?void 0:w[d.key])??0}),p=Math.max(...i),x=Math.min(...i);return e.jsxs(Y,{className:"border-b border-border/30 hover:bg-muted/30 transition-colors",children:[e.jsx(O,{className:"p-1.5 pl-2 text-[11px] font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",style:{wordBreak:"keep-all",left:0},children:d.label}),t.map(g=>{var y;const w=((y=g.stats)==null?void 0:y[d.key])??0,P=w===p&&p!==x,l=w===x&&p!==x;return e.jsx(O,{className:_("p-1.5 text-[11px] text-center",P&&"text-primary font-semibold",l&&"text-muted-foreground"),children:d.format(w)},g.id)})]},d.key)})})]})})})})})}async function Cr(t,r,s){let n={},a=null;try{a=await ir(t,s),n=a.spellDataMap}catch(o){H.warn(`Failed to load Community Dragon data for ${t}:`,o)}return r.map((o,d)=>{let i={};if(n[d.toString()])i=n[d.toString()];else{const p=o.id.replace(t,"");for(const x of Object.keys(n))if(x.toLowerCase().includes(p.toLowerCase())||x.toLowerCase().includes(o.id.toLowerCase())){i=n[x];break}}return{spell:o,communityDragonData:i,spellIndex:d,ddragonVersion:(a==null?void 0:a.ddragonVersion)??s,cdragonVersion:(a==null?void 0:a.cdragonVersion)??null}})}async function Bt(t,r){const s={},n=t.map(async a=>{if(!a.spells||a.spells.length===0){s[a.id]=[];return}try{s[a.id]=await Cr(a.id,a.spells,r)}catch(o){H.warn(`Failed to get integrated spell data for ${a.id}:`,o),s[a.id]=a.spells.map((d,i)=>({spell:d,communityDragonData:{},spellIndex:i}))}});return await Promise.all(n),s}const Xe={physicalDamage:{tag:"span",className:"text-red-600 dark:text-red-500 font-semibold"},magicDamage:{tag:"span",className:"text-blue-600 dark:text-blue-500 font-semibold"},trueDamage:{tag:"span",className:"text-yellow-600 dark:text-yellow-500 font-semibold"},status:{tag:"span",className:"text-purple-600 dark:text-purple-500"},lifeSteal:{tag:"span",className:"text-green-600 dark:text-green-500"},scaleAD:{tag:"span",className:"text-orange-600 dark:text-orange-500"},scaleAP:{tag:"span",className:"text-blue-600 dark:text-blue-400"},scaleArmor:{tag:"span",className:"text-orange-600 dark:text-orange-400"},scaleLevel:{tag:"span",className:"text-gray-600 dark:text-gray-400"},healing:{tag:"span",className:"text-green-600 dark:text-green-400"},speed:{tag:"span",className:"text-cyan-600 dark:text-cyan-500"},keywordMajor:{tag:"span",className:"text-yellow-600 dark:text-yellow-400 font-semibold"},keywordStealth:{tag:"span",className:"text-purple-600 dark:text-purple-400 font-semibold"},spellPassive:{tag:"span",className:"text-gray-600 dark:text-gray-500 italic"},spellActive:{tag:"span",className:"text-gray-900 dark:text-white font-semibold"},recast:{tag:"span",className:"text-yellow-600 dark:text-yellow-300"},damage:{tag:"span",className:"text-red-600 dark:text-red-400"},shield:{tag:"span",className:"text-blue-600 dark:text-blue-300"},mana:{tag:"span",className:"text-blue-600 dark:text-blue-400"},energy:{tag:"span",className:"text-yellow-600 dark:text-yellow-400"},health:{tag:"span",className:"text-red-600 dark:text-red-400"},cooldown:{tag:"span",className:"text-gray-600 dark:text-gray-300"},range:{tag:"span",className:"text-cyan-600 dark:text-cyan-400"},radius:{tag:"span",className:"text-purple-600 dark:text-purple-400"},width:{tag:"span",className:"text-indigo-600 dark:text-indigo-400"},length:{tag:"span",className:"text-pink-600 dark:text-pink-400"},rules:{tag:"span",className:"text-gray-600 dark:text-gray-400 italic"}};function Tr(t){let r=t;r=r.replace(/<font\s+color=['"]([^'"]+)['"]\s*>/gi,'<span style="color: $1">'),r=r.replace(/<\/font>/gi,"</span>"),Object.entries(Xe).forEach(([n,{tag:a,className:o}])=>{const d=new RegExp(`</${n}>`,"gi");r=r.replace(d,`</${a}>`);const i=new RegExp(`<${n}>`,"gi");r=r.replace(i,`<${a}${o?` class="${o}"`:""}>`)});const s=["keywordMajor","keywordStealth","rules","recast"];return s.forEach(n=>{r=r.replace(new RegExp(`</${n}>`,"gi"),"</span>"),n==="rules"?r=r.replace(new RegExp(`<${n}>`,"gi"),'<span class="text-gray-600 dark:text-gray-400 italic">'):n==="keywordStealth"?r=r.replace(new RegExp(`<${n}>`,"gi"),'<span class="text-purple-600 dark:text-purple-400 font-semibold">'):r=r.replace(new RegExp(`<${n}>`,"gi"),'<span class="text-yellow-600 dark:text-yellow-400 font-semibold">')}),r=r.replace(/<(\w+)(?![\\w])>/gi,(n,a)=>Xe[a]||s.includes(a)||a==="font"||a==="br"?n:"<span>"),r=r.replace(/<\/(\w+)(?![\\w])>/gi,(n,a)=>Xe[a]||s.includes(a)||a==="font"||a==="br"?n:"</span>"),r}function It(t){const r=t.trim(),s=/^([a-zA-Z_][a-zA-Z0-9_]*)\s*([*+\/-])\s*(-?\d+(?:\.\d+)?)$/,n=r.match(s);if(n){const a=n[2];return{type:"formula",variable:n[1],operator:a,operand:parseFloat(n[3])}}return{type:"variable",variable:r}}function Dt(t,r,s){if(!r||typeof r!="string")return null;const n=Object.entries(t).find(([p])=>p!=null&&p.toLowerCase()===r.toLowerCase());if(!n)return null;const[,a]=n,o=a.slice(1,s+1);if(o.length===0)return null;const d=o[0];return o.every(p=>p===d)?d:o}function Ft(t,r){if(r.type!=="formula"||!r.operator||r.operand==null)return t;const{operator:s,operand:n}=r;return s==="*"?Array.isArray(t)?t.map(a=>a*n):t*n:s==="+"?Array.isArray(t)?t.map(a=>a+n):t+n:s==="-"?Array.isArray(t)?t.map(a=>a-n):t-n:s==="/"?Array.isArray(t)?t.map(a=>a/n):t/n:t}function me(t){if(t==null||t==="")return"";const r=typeof t=="number"?t:parseFloat(String(t));return isNaN(r)?String(t):r%1===0?r.toString():parseFloat(r.toFixed(3)).toString()}function St(t,r,s=!1){if(!t||t.length===0)return"";const n=s&&t.length>1?1:0,o=t.slice(n).filter(g=>g!=null&&g!==""&&g!=="0");if(o.length===0)return"";const d=r?o.slice(0,r):o;if(d.length===0)return"";const i=d.map(g=>me(g)),p=i[0];return i.every(g=>g===p)?p:i.join("/")}function Pr(t){let r=t;return r=r.replace(/<br\s*\/?>/gi,"<br />"),r=r.replace(/[^\S\r\n]+/g," "),r}function te(t){return Array.isArray(t)}function kt(t,r){return Array.isArray(t)?t:Array.from({length:r},()=>t)}function zt(t,r,s){if(!te(t)&&!te(r))return s(t,r);const n=te(t)?t:kt(t,te(r)?r.length:1),a=te(r)?r:kt(r,n.length);if(n.length!==a.length)throw new Error(`Vector length mismatch: ${n.length} vs ${a.length}`);return n.map((o,d)=>s(o,a[d]))}function Pe(t,r){return zt(t,r,(s,n)=>s+n)}function Ve(t,r){return zt(t,r,(s,n)=>s*n)}function ze(t){return te(t)?t.every(s=>s===t[0])?me(t[0]):t.map(s=>me(s)).join("/"):me(t)}function Qe(t){return te(t)?t.map(r=>r*100):t*100}function Ct(t,r,s="ko_KR"){const n=be(s),a=t!=null,o=r!=null;if(!a&&!o)return n.stats.abilityPower;const d=t??r;return d===2?t===2&&r===2?n.stats.bonusAttackDamage:n.stats.attackDamage:d===12?t===12&&r===2?n.stats.bonusHealth:n.stats.health:d===1?t===1&&r===2?n.stats.bonusArmor:n.stats.armor:d===6?t===6&&r===2?n.stats.bonusMagicResist:n.stats.magicResist:d===18?t===18&&r===2?n.stats.bonusLifesteal:n.stats.lifesteal:""}function at(t,r="ko_KR"){let n=be(r).common.mana;if(t.costType){const a=t.costType.trim();return a&&!a.includes("{{")?a:t.resource&&!t.resource.includes("{{")?t.resource:n}return t.resource&&!t.resource.includes("{{")?t.resource:n}function Ot(t,r,s){const n=s==null?void 0:s.DataValues;if(!n)return null;const a=Dt(n,t.variable,r.maxrank);if(a==null)return null;const o=Ft(a,t);return ze(o)}function Tt(t,r){const s=n=>Number.isFinite(n)?n.toFixed(r).replace(/\.?0+$/,""):String(n);if(te(t)){const n=t.map(d=>s(d)),a=n[0];return n.every(d=>d===a)?a:n.join("/")}return s(t)}function Vr(t,r,s,n="ko_KR"){const a=s==null?void 0:s.mSpellCalculations,o=s==null?void 0:s.DataValues;if(!a)return null;const d=Object.entries(a).find(([h])=>h!=null&&h.toLowerCase()===t.variable.toLowerCase());if(!d)return null;const[i]=d;function p(h){if(!h||typeof h!="string")return H.debug(`DataValue name is invalid: ${h}`),null;if(!o)return H.debug("dataValues is undefined"),null;const v=Dt(o,h,r.maxrank);return v??(H.debug(`DataValue "${h}" missing`),null)}function x(h,v=new Set){var C;if(!a)throw new Error("spellCalcs is undefined");const N=a[h];if(!N)throw new Error(`SpellCalculation "${h}" not found`);if(v.has(h))throw new Error(`Circular reference in mSpellCalculations: ${h}`);if(v.add(h),N.__type==="GameCalculationModified"){const V=N;if(!V.mModifiedGameCalculation)throw new Error("mModifiedGameCalculation is missing");const A=x(V.mModifiedGameCalculation,v);if(!V.mMultiplier)return A;let R=null;if(V.mMultiplier.mDataValue){if(R=p(V.mMultiplier.mDataValue),R==null)return A}else V.mMultiplier.mNumber!=null&&(R=V.mMultiplier.mNumber);if(R==null)return A;const B=Ve(A.base,R),I=A.statParts.map(z=>({name:z.name,ratio:Ve(z.ratio,R)}));return{base:B,statParts:I,isPercent:A.isPercent,precision:A.precision}}if(N.__type==="GameCalculation"){const V=N,A=V.mFormulaParts??[];let R=0;const B=[],I=!!V.mDisplayAsPercent;if(A.length===1&&A[0].__type==="ByCharLevelBreakpointsCalculationPart"&&V.mSimpleTooltipCalculationDisplay===6){const T=A[0],M=T.mLevel1Value??0;let L=M;for(const D of T.mBreakpoints??[])typeof D.mAdditionalBonusAtThisLevel=="number"&&(L+=D.mAdditionalBonusAtThisLevel);return{base:[M,L],statParts:[],isPercent:I,isBreakpointRange:!0,precision:void 0}}if(A.length===1&&A[0].__type==="ByCharLevelBreakpointsCalculationPart"&&I){const T=A[0],M=T.mLevel1Value??0,L=T.mInitialBonusPerLevel??0,k=(T.mBreakpoints??[])[0];if(L!==0&&(k!=null&&k.mLevel)){const $=k.mLevel-1,D=Math.max($-1,0),F=M+D*L;return{base:[M,F],statParts:[],isPercent:!0,isCharLevelRange:!0,precision:void 0}}}if(A.length===1&&A[0].__type==="ByCharLevelInterpolationCalculationPart"&&I){const T=A[0],M=T.mStartValue??0,L=T.mEndValue??M;return{base:[M,L],statParts:[],isPercent:!0,isCharLevelRange:!0,precision:void 0}}for(const T of A){const M=T.__type;if(M==="NamedDataValueCalculationPart"){const L=T;if(!L.mDataValue){H.debug("NamedDataValueCalculationPart missing mDataValue",T);continue}const k=p(L.mDataValue);if(k==null)continue;R=Pe(R,k)}else if(M==="EffectValueCalculationPart"){const k=T.mEffectIndex??0,$=((C=r.effectBurn)==null?void 0:C[k])??null;if(!$)H.debug(`EffectValueCalculationPart: effectBurn[${k}] is missing`,{spellId:r.id});else{const D=$.split("/").map(F=>parseFloat(F)).filter(F=>!Number.isNaN(F));if(D.length>0){const F=D.length>r.maxrank?D.slice(0,r.maxrank):D;R=Pe(R,F)}}}else if(M==="StatByNamedDataValueCalculationPart"){const L=T;if(!L.mDataValue){H.debug("StatByNamedDataValueCalculationPart missing mDataValue",T);continue}const k=p(L.mDataValue);if(k==null)continue;const $=Ct(L.mStat,L.mStatFormula,n);B.push({name:$,ratio:k})}else if(M==="StatByCoefficientCalculationPart"){const L=T;if(L.mCoefficient==null){H.debug("StatByCoefficientCalculationPart missing mCoefficient",T);continue}const k=Ct(L.mStat,L.mStatFormula,n),$=L.mCoefficient;B.push({name:k,ratio:$,isCoefficient:!0})}else if(M==="AbilityResourceByCoefficientCalculationPart"){const L=T;if(L.mCoefficient==null){H.debug("AbilityResourceByCoefficientCalculationPart missing mCoefficient",T);continue}const k=at(r,n),$=be(n),F=L.mStatFormula===2?`${$.common.bonus} ${k}`:k,U=L.mCoefficient;B.push({name:F,ratio:U,isCoefficient:!0})}else if(M==="NumberCalculationPart"){const k=T.mNumber??0;R=Pe(R,k)}else if(M==="ByCharLevelBreakpointsCalculationPart"){const L=T;let k=L.mLevel1Value||0;for(const $ of L.mBreakpoints??[])$.mAdditionalBonusAtThisLevel!=null&&(k+=$.mAdditionalBonusAtThisLevel);R=Pe(R,k)}else if(M==="ProductOfSubPartsCalculationPart"){const L=T,k=U=>{var re;if(!U||!U.__type)return 0;const Z=U.__type;if(Z==="NamedDataValueCalculationPart"){const le=U;if(!le.mDataValue)return H.debug("ProductOfSubPartsCalculationPart: NamedDataValueCalculationPart missing mDataValue",U),0;const se=p(le.mDataValue);return se??0}if(Z==="NumberCalculationPart")return U.mNumber??0;if(Z==="EffectValueCalculationPart"){const se=U.mEffectIndex??0,je=((re=r.effectBurn)==null?void 0:re[se])??null;if(!je)return H.debug(`ProductOfSubPartsCalculationPart: EffectValueCalculationPart missing effectBurn[${se}]`,{spellId:r.id}),0;let Ce;if(je.includes("/")){const ie=je.split("/").map(Te=>Number.parseFloat(Te)).filter(Te=>!Number.isNaN(Te));if(ie.length===0)return 0;Ce=ie.length===1?ie[0]:ie}else{const ie=Number.parseFloat(je);if(Number.isNaN(ie))return 0;Ce=ie}return Ce}return H.debug(`ProductOfSubPartsCalculationPart: unsupported sub part type "${Z}"`,U),0},$=k(L.mPart1),D=k(L.mPart2),F=Ve($,D);R=Pe(R,F)}}let z=R,G=B;if(V.mMultiplier){let T=null;V.mMultiplier.mDataValue?(T=p(V.mMultiplier.mDataValue),T==null&&(T=null)):V.mMultiplier.mNumber!=null&&(T=V.mMultiplier.mNumber),T!=null&&(z=Ve(z,T),G=G.map(M=>({...M,ratio:Ve(M.ratio,T)})))}let m;return typeof V.mPrecision=="number"&&V.mPrecision>=0?m=V.mPrecision+1:m=void 0,{base:z,statParts:G,isPercent:I,precision:m}}throw new Error(`Unsupported mSpellCalculation type: ${N.__type}`)}let g;try{g=x(i)}catch(h){return H.error("Failed to evaluate calculation:",h),null}let w;const P=g.precision;g.isPercent?P!=null?te(g.base)?w=g.base.map(h=>h*100):w=g.base*100:w=Qe(g.base):w=g.base;const l=g.statParts.map(h=>{if(h.isCoefficient){const v=P!=null?te(h.ratio)?h.ratio.map(N=>N*100):h.ratio*100:Qe(h.ratio);return{...h,ratio:v}}if(P!=null){const v=te(h.ratio)?h.ratio.map(N=>N*100):h.ratio*100;return{...h,ratio:v}}return{...h,ratio:Qe(h.ratio)}});let y=null;const j=te(w)&&w.length>0&&w.every(h=>h===0),c=!te(w)&&w===0;if(!j&&!c)if(g.isCharLevelRange&&te(w)&&w.length===2){const[h,v]=w,N=me(h),C=me(v);y=`(${N}% ~ ${C}%)`}else if(g.isBreakpointRange&&te(w)&&w.length===2){const[h,v]=w,N=me(h),C=me(v);y=g.isPercent?`(${N}% ~ ${C}%)`:`(${N} ~ ${C})`}else{const h=P!=null?Tt(w,P):ze(w);y=g.isPercent?`${h}%`:h}const u=l.map(h=>{const v=P!=null?Tt(h.ratio,P):ze(h.ratio);return h.name?`(${v}% ${h.name})`:`(${v}%)`}),f=[];if(y&&f.push(y),f.push(...u),f.length===0)return null;const S=f.join(" + ");return f.length===1?S:`(${S})`}function $r(t,r){return!Number.isFinite(r)||r<0?t:t.replace(/-?\d+(?:\.\d+)?/g,s=>{const n=Number.parseFloat(s);return Number.isFinite(n)?n.toFixed(r):s})}function Lr(t){return t.replace(/(}})\s*\+\s*(\S)/g,"$1 + $2").replace(/(\S)\s*\+\s*({{)/g,"$1 + $2").replace(/(\S)\s*~\s*(\S)/g,"$1 ~ $2")}function Er(t){return t.replace(/\{\{([^}]*\{\{[^}]*}}[^}]*)}}/g,()=>"")}function Ar(t){let r=t;return r=r.replace(/\{\{Spell_[^}]*Tooltip[^}]*}}/gi,""),r=r.replace(/\{\{spellmodifierdescriptionappend}}/gi,""),r}function Rr(t,r,s,n){const a=/\{\{([^}]+)}}/g;return t.replace(a,(o,d)=>{const i=String(d).trim();if(i==="spellmodifierdescriptionappend"||i.includes("gamemodeinteger")||i.includes("Spell_")&&i.includes("Tooltip"))return"";let p=i,x;const g=/^([a-zA-Z_][a-zA-Z0-9_]*)(?:\.(\d+))(.*)$/.exec(i);if(g){const[,P,l,y]=g,j=Number.parseInt(l,10);Number.isFinite(j)&&(x=j,p=`${P}${y}`)}const w=_r(p,r,s,n);return w!==null?x!==void 0?$r(w,x):w:""})}function Mr(t){let r=t;return r=r.replace(/\{\{\s*\}/g,""),r=r.replace(/\}\}/g,""),r=r.replace(/\{\{/g,""),r=r.replace(/%[^\s:%]+:[^\s%]+%/g,""),r=r.replace(/\s+%\s+/g," "),r=r.replace(new RegExp("(?<!\\d)\\s*%\\s*(?!\\d)","g"),""),r=r.replace(/^\s*%\s*(?!\d)/g,""),r=r.replace(new RegExp("(?<!\\d)\\s*%\\s*$","g"),""),r=r.replace(/[^\S\r\n]+/g," "),r}function Kt(t,r,s,n="ko_KR"){if(!r)return t;let a=t;return a=Lr(a),a=Er(a),a=Ar(a),a=Rr(a,r,s,n),a=Mr(a),a}function _r(t,r,s,n="ko_KR"){const a=It(t),o=Br(a,r,s);if(o!==null)return o;const d=Ot(a,r,s);return d!==null?d:Vr(a,r,s,n)}function Br(t,r,s){const n=t.variable,a=/^e(\d+)$/i.exec(n);if(!a)return null;const o=Number.parseInt(a[1],10);if(!Number.isFinite(o)||o<=0)return null;const d=(s==null?void 0:s.effectBurn)??r.effectBurn;if(!d)return null;const i=d[o];if(!i)return null;let p;if(i.includes("/")){const g=i.split("/").map(w=>Number.parseFloat(w)).filter(w=>!Number.isNaN(w));if(g.length===0)return null;p=g.length===1?g[0]:g}else{const g=Number.parseFloat(i);if(Number.isNaN(g))return null;p=g}const x=Ft(p,t);return ze(x)}function et(t,r,s,n="ko_KR"){if(!t)return"";let a=t;return a=Tr(a),a=Kt(a,r,s,n),a=Pr(a),a=a.replace(/\n/g,"<br />"),a}function Pt(t,r,s="ko_KR"){const n=be(s);if(!t.leveltip||!t.leveltip.label||!t.leveltip.effect)return"";let a;r&&(r.DataValues?a=r:a={DataValues:r});const{label:o,effect:d}=t.leveltip,i=[];for(let p=0;p<o.length&&p<d.length;p++){const x=o[p],w=d[p].match(/\{\{\s*([^}]+)\s*\}\}/);if(!w)continue;const P=w[1].trim();let l=null;if(a)try{const c=It(P),u=Ot(c,t,a);if(u&&u.trim()!==""){let f=u;(x.includes("%")||x.toLowerCase().includes("percent")||x.toLowerCase().includes("퍼센트")||x.toLowerCase().includes("둔화"))&&!f.includes("%")&&(f=f.split("/").map(N=>N&&`${N}%`).join("/"));const h=at(t,s),v=x.replace("@AbilityResourceName@",h);if(v.includes("{{")||v.includes("}}"))continue;i.push(`${v}: [${f}]`);continue}}catch{}const y=P;l=null;const j=y.match(/^e(\d+)$/i);if(j){const c=parseInt(j[1]);if(t.effectBurn&&t.effectBurn.length>c){const u=t.effectBurn[c];u&&u!==null&&u!=="0"&&(l=u)}}else if(y.toLowerCase()==="cost"||y.toLowerCase().includes("cost"))t.costBurn&&(l=t.costBurn);else if(y.toLowerCase().includes("cooldown"))t.cooldownBurn&&(l=t.cooldownBurn);else if(y.toLowerCase().includes("ammorechargetime")||y.toLowerCase().includes("ammorecharge")){const c=(r==null?void 0:r.DataValues)||r;if(c&&c.mAmmoRechargeTime){const u=c.mAmmoRechargeTime;if(Array.isArray(u)&&u.length>1){const S=u.slice(1).map(v=>typeof v=="number"?v:parseFloat(String(v))),h=St(S,t.maxrank,!1);h&&(l=h)}}}if(l){const c=St(l.includes("/")?l.split("/"):[l],t.maxrank);if(c){let u=n.common.mana;u=at(t,s);const f=x.replace("@AbilityResourceName@",u);if(f.includes("{{")||f.includes("}}"))continue;let S=c;(x.includes("%")||x.toLowerCase().includes("slow")||x.toLowerCase().includes("둔화"))&&(c.includes("%")||(S=c.split("/").map(h=>`${h}%`).join("/"))),i.push(`${f}: [${S}]`)}}}return i.length===0?"":i.join("<br />")}function Ir(t,r,s="ko_KR"){var i,p;const n=be(s);if(!t||!t.cooldown||!Array.isArray(t.cooldown)||t.cooldown.length===0)return null;const a=((i=r==null?void 0:r.communityDragonData)==null?void 0:i.DataValues)||(r==null?void 0:r.communityDragonData),o=a==null?void 0:a.mAmmoRechargeTime;if(t.cooldown[0]===0&&o&&Array.isArray(o)&&o.length>1&&o){const x=o[1],g=((p=t.effectBurn)==null?void 0:p[1])||"3";return`${n.common.rechargeTime} ${x}${n.common.seconds} (${n.common.max}: ${g}${n.common.items})`}if(t.cooldownBurn){const x=t.cooldownBurn.split("/");return x.length>1&&x.every(g=>g===x[0])?`${x[0]}${n.common.seconds}`:`${t.cooldownBurn}${n.common.seconds}`}if(t.cooldown&&t.cooldown.length>0){const x=t.cooldown[0];return t.cooldown.every(g=>g===x)?`${x}${n.common.seconds}`:`${t.cooldown.join("/")}${n.common.seconds}`}return null}function xe(t){if(!t)return t;let r=t.replace(/\(\s*\)/g,"");return r=r.replace(/\s{2,}/g," ").trim(),r}function Dr(t,r,s="ko_KR"){var i;const n=be(s);if(!t)return null;const a=Array.isArray(t.cost)&&t.cost.length>0,o=a&&t.cost.every(p=>p===0),d=t.costBurn==="0";if((d||o)&&typeof t.resource=="string"&&t.resource.includes("{{")){const p=t.resource.trim(),x=((i=r==null?void 0:r.communityDragonData)==null?void 0:i.DataValues)||(r==null?void 0:r.communityDragonData);if(x){const w=Kt(p,t,{DataValues:x}).trim();if(w)return xe(w)}return xe(n.common.noCost)}if(d||o)return xe(n.common.noCost);if(t.costBurn){const p=t.costBurn.split("/");return p.length>1&&p.every(x=>x===p[0])?xe(`${n.common.mana} ${p[0]}`):xe(`${n.common.mana} ${t.costBurn}`)}if(a){const p=t.cost[0];return t.cost.every(x=>x===p)?xe(`${n.common.mana} ${p}`):xe(`${n.common.mana} ${t.cost.join("/")}`)}return null}function Ht(t,r,s){var i;const n=((i=s==null?void 0:s.communityDragonData)==null?void 0:i.DataValues)||(s==null?void 0:s.communityDragonData),a=n==null?void 0:n.mAmmoRechargeTime,o=t.cooldown[r-1];return o===0&&a&&Array.isArray(a)&&a.length>r&&a?a[r]!==void 0?String(a[r]):"":o!=null?String(o):""}const tt="cooldown:active-skill-tooltip";function ue({skill:t,skillIdx:r,version:s,spellData:n,isPassive:a,passiveName:o,passiveDescription:d,passiveImageFull:i,size:p="default"}){const{t:x,lang:g}=X(),P=Le()==="mobile",[l,y]=K.useState(!1),[j,c]=K.useState(!1),u=K.useRef(null),f=K.useRef(null),S=K.useRef(""),[h,v]=K.useState("bottom"),[N,C]=K.useState(void 0),V=a&&i?null:Ir(t,n,g),A=a&&i?null:Dr(t,n,g),R=p==="small",B=R?"min-w-6 min-h-6 w-6 h-6":"min-w-8 min-h-8 w-8 h-8",I=R?"text-[8px]":"text-[9px]",z=K.useCallback(()=>{P||(S.current||(S.current=`${t.id}-${r}-${s}`),typeof window<"u"&&window.dispatchEvent(new CustomEvent(tt,{detail:S.current})),f.current!==null&&(window.clearTimeout(f.current),f.current=null),c(!0))},[P]),G=K.useCallback(()=>{P||(f.current!==null&&window.clearTimeout(f.current),f.current=window.setTimeout(()=>{c(!1),f.current=null},40))},[P]);K.useEffect(()=>{if(P||!j){C(void 0);return}const k=u.current;if(!k)return;const $=()=>{const D=k.getBoundingClientRect(),F=window.innerHeight,U=16,Z=8,re=D.top-U,le=F-D.bottom-U;if(re<=0&&le<=0){C(void 0);return}if(le>=re){v("bottom");const se=Math.max(le-Z,0);C(se||void 0)}else{v("top");const se=Math.max(re-Z,0);C(se||void 0)}};return $(),window.addEventListener("resize",$),window.addEventListener("scroll",$,!0),()=>{window.removeEventListener("resize",$),window.removeEventListener("scroll",$,!0)}},[P,j]),K.useEffect(()=>{if(typeof window>"u")return;const k=$=>{const F=$.detail;S.current&&F!==S.current&&(f.current!==null&&(window.clearTimeout(f.current),f.current=null),c(!1))};return window.addEventListener(tt,k),()=>{f.current!==null&&window.clearTimeout(f.current),window.removeEventListener(tt,k)}},[]);const m=e.jsx("div",{ref:u,className:`flex flex-col items-center gap-0.5 p-1 -m-1 touch-manipulation ${P?"cursor-pointer":"cursor-help"}`,onClick:k=>{P&&(k.stopPropagation(),y($=>!$))},onTouchStart:k=>{P&&(k.stopPropagation(),y($=>!$))},onPointerEnter:()=>{P||z()},onPointerLeave:()=>{P||G()},children:a&&i?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:cr(s,i),alt:"Passive",className:_(B,"rounded")}),e.jsx("span",{className:_(I,"font-semibold"),children:"P"})]}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:jt(s,t.id),alt:ve[r],className:_(B,"rounded")}),e.jsx("span",{className:_(I,"font-semibold"),children:ve[r]})]})}),T=()=>a&&i?e.jsxs(e.Fragment,{children:[o&&e.jsx("div",{className:`font-semibold text-sm ${P?"pr-10":""}`,children:o}),d&&e.jsx("div",{className:"text-xs leading-relaxed",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:et(d,void 0,void 0,g)}})}),e.jsxs("div",{className:"text-xs text-muted-foreground leading-relaxed border-t pt-3 mt-3 flex items-start gap-1.5",children:[e.jsx(Nt,{className:"w-3 h-3 mt-0.5 text-yellow-600 dark:text-yellow-500 flex-shrink-0"}),e.jsx("span",{children:x.skillTooltip.warningPassive})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-start gap-3 border-b pb-3 pr-6",children:[e.jsx("img",{src:jt(s,t.id),alt:ve[r],className:"w-12 h-12 min-w-12 min-h-12 rounded flex-shrink-0"}),e.jsx("div",{className:"flex-1 min-w-0",children:t.name&&e.jsxs("div",{className:"font-semibold text-sm",children:["[",ve[r],"] ",t.name]})}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[V&&e.jsx("div",{className:"text-xs text-muted-foreground",children:V.includes(" (")?e.jsxs(e.Fragment,{children:[V.split(" (")[0],e.jsx("br",{}),"(",V.split(" (")[1]]}):V}),A&&e.jsx("div",{className:"text-xs text-muted-foreground mt-1 whitespace-nowrap",children:A})]})]}),t.description&&e.jsx("div",{className:"text-xs leading-relaxed",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:et(t.description,t,n==null?void 0:n.communityDragonData,g).replace(/<br\s*\/?>/gi," ")}})}),t.tooltip&&e.jsx("div",{className:"text-xs text-muted-foreground leading-relaxed",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:et(t.tooltip,t,n==null?void 0:n.communityDragonData,g)}})}),n&&Pt(t,n.communityDragonData,g)&&e.jsx("div",{className:"text-[11px] leading-relaxed text-muted-foreground border-t pt-3 mt-3",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:Pt(t,n.communityDragonData,g)}})}),e.jsxs("div",{className:"text-xs text-muted-foreground leading-relaxed border-t pt-3 mt-3 flex items-start gap-1.5",children:[e.jsx(Nt,{className:"w-3 h-3 mt-0.5 text-yellow-600 dark:text-yellow-500 flex-shrink-0"}),e.jsx("span",{children:x.skillTooltip.warningSkill})]})]}),M=e.jsx(Oe,{open:l,onOpenChange:y,children:e.jsxs(pt,{className:_(P?"w-[calc(100vw-32px)] max-w-lg h-[70vh] max-h-[70vh]":"w-full max-w-3xl h-[80vh] max-h-[80vh]","p-0 rounded-xl overflow-hidden flex flex-col"),children:[e.jsxs(Ke,{children:[e.jsx(He,{children:a&&i?`${o||x.skillTooltip.passive} ${x.skillTooltip.skillInfo}`:`[${ve[r]}] ${t.name||x.skillTooltip.skill} ${x.skillTooltip.skillInfo}`}),e.jsx(Ue,{children:a&&i?`${o||x.skillTooltip.passive} ${x.skillTooltip.skillDescription}`:`[${ve[r]}] ${t.name||x.skillTooltip.skill} ${x.skillTooltip.skillDescription}`})]}),e.jsx(Se,{className:"flex-1 min-h-0",children:e.jsx("div",{className:"p-4 flex flex-col gap-3",children:T()})})]})});if(P)return e.jsxs(e.Fragment,{children:[m,M]});const L=e.jsxs("div",{className:"space-y-3",children:[T(),e.jsx("div",{className:"pt-1 flex justify-end",children:e.jsx("button",{type:"button",className:"text-[11px] text-primary hover:underline",onClick:k=>{k.preventDefault(),k.stopPropagation(),c(!1),y(!0)},children:x.skillTooltip.viewDetail})})]});return a&&i?e.jsxs(e.Fragment,{children:[e.jsxs(rt,{open:j,children:[e.jsx(st,{asChild:!0,children:m}),e.jsx(nt,{side:h,align:"center",sideOffset:0,className:"max-w-xs p-3 space-y-2",style:!P&&N?{maxHeight:N}:void 0,onPointerEnter:z,onPointerLeave:G,children:L})]}),M]}):e.jsxs(e.Fragment,{children:[e.jsxs(rt,{open:j,children:[e.jsx(st,{asChild:!0,children:m}),e.jsx(nt,{side:h,align:"center",sideOffset:0,className:"max-w-sm p-4 space-y-3",style:!P&&N?{maxHeight:N}:void 0,onPointerEnter:z,onPointerLeave:G,children:L})]}),M]})}const Ut=b.createContext(void 0);function Fr({initialDDragonVersion:t=null,initialCDragonVersion:r=null,children:s}){const[n,a]=b.useState(t??null),[o,d]=b.useState(r??null),i=b.useMemo(()=>({ddragonVersion:n,cdragonVersion:o,setDDragonVersion:a,setCDragonVersion:d}),[n,o]);return e.jsx(Ut.Provider,{value:i,children:s})}function ht(){const t=b.useContext(Ut);if(!t)throw new Error("useVersionContext must be used within VersionProvider");return t}function zr({champions:t,version:r,championList:s,onAddChampion:n,onRemoveChampion:a,onReorderChampions:o,vsMode:d}){const{t:i}=X(),{cdragonVersion:p,setCDragonVersion:x}=ht(),[g,w]=b.useState(!1),[P,l]=K.useState({}),y=lt(Ne(ct,{activationConstraint:{distance:8}}),Ne(it,{coordinateGetter:ot})),j=N=>{},c=N=>{const{active:C,over:V}=N;if(V&&C.id!==V.id&&o){const A=t.findIndex(B=>B.id===C.id),R=t.findIndex(B=>B.id===V.id);A!==-1&&R!==-1&&o(A,R)}};K.useEffect(()=>{const N=async()=>{try{const C=await Bt(t,r);if(l(C),!p)try{let V=null;for(const A of Object.keys(C)){const R=C[A];if(R&&R.length>0&&(V=R[0].cdragonVersion??null,V))break}V&&x(V)}catch(V){H.warn("Failed to extract CDragon version from integrated spell data:",V)}}catch(C){H.warn("Failed to load integrated spell data:",C),l({})}};t.length>0&&N()},[t,r]);const u=K.useMemo(()=>Math.max(...t.map(N=>N.spells?Math.max(...N.spells.map(C=>C.maxrank)):0)),[t]),f=K.useCallback((N,C)=>{const V=P[N];return!V||V.length<=C?null:V[C]},[P]),S=K.useMemo(()=>Array.from({length:u},(N,C)=>{const V=C+1;return{level:V,skills:t.map(A=>A.spells?A.spells.map((R,B)=>{const I=f(A.id,B),z=Ht(R,V,I);return{skill:R,cooldown:z}}):null)}}),[t,u,f]),h=({champion:N,children:C,className:V})=>{const{setNodeRef:A,transform:R,transition:B,isDragging:I}=ye({id:N.id,disabled:!0}),G={transform:R?we.Transform.toString(R):void 0,transition:I?B:void 0,opacity:I?.5:1};return e.jsx(O,{ref:A,style:G,className:V,children:C})},v=({champion:N,index:C})=>{const{attributes:V,listeners:A,setNodeRef:R,transform:B,transition:I,isDragging:z}=ye({id:N.id}),m={transform:B?we.Transform.toString(B):void 0,transition:z?I:void 0,opacity:z?.5:1};return e.jsx(W,{ref:R,style:m,className:_("text-center p-2 text-xs font-semibold text-foreground w-[220px] lg:w-[240px] min-w-[200px] lg:min-w-[220px] select-none",C<t.length-1&&"border-r border-border/30",z&&"z-50"),children:e.jsxs("div",{className:"flex flex-row items-center justify-center gap-2 relative",children:[o&&e.jsx("button",{...V,...A,className:"cursor-grab active:cursor-grabbing p-1 opacity-60 hover:opacity-100 transition-opacity -ml-1","aria-label":"Drag to reorder",children:e.jsx(We,{className:"h-4 w-4 text-muted-foreground"})}),e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:ne(r,N.id),alt:N.name,className:"w-8 h-8 rounded-full"}),a&&e.jsx(oe,{variant:"ghost",size:"icon",className:_("absolute -top-1 -right-1 h-4 w-4 rounded-full","bg-destructive/90 hover:bg-destructive text-white","hover:scale-110 transition-transform","shadow-md"),onClick:T=>{T.stopPropagation(),a(N.id)},"aria-label":`Remove ${N.name}`,children:e.jsx(ke,{className:"h-2.5 w-2.5"})})]}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("div",{className:"text-[11px] font-semibold leading-tight text-foreground",children:N.name}),e.jsx("div",{className:"text-[9px] text-muted-foreground leading-tight",children:N.title})]})]})})};return e.jsx(De,{delayDuration:0,skipDelayDuration:150,children:e.jsxs("div",{className:"relative",children:[e.jsx(dt,{sensors:y,collisionDetection:ut,onDragStart:j,onDragEnd:c,children:e.jsx("div",{className:"border border-border/30 rounded-lg overflow-hidden",children:e.jsxs(pe,{className:"border-collapse table-fixed w-auto",children:[e.jsx(he,{children:e.jsxs(Y,{className:"border-b border-border/30 select-none",children:[e.jsx(W,{className:"text-left p-2 pl-3 text-xs font-semibold text-foreground sticky left-0 bg-card z-20 w-[80px] min-w-[80px] border-r border-border/30 select-none",style:{left:0},children:i.common.level}),e.jsx(mt,{items:t.map(N=>N.id),strategy:ft,children:t.map((N,C)=>e.jsx(v,{champion:N,index:C},N.id))}),n&&e.jsx(W,{className:"text-center p-2 text-xs font-semibold text-foreground w-[220px] lg:w-[240px] min-w-[200px] lg:min-w-[220px] border-l border-border/30 select-none",children:e.jsxs(oe,{onClick:()=>w(!0),variant:"outline",className:"w-full flex flex-row items-center justify-center gap-2 p-1.5 h-auto border-2 border-dashed border-muted-foreground/30 hover:border-primary/50 hover:bg-muted/30 group",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-muted/30 flex items-center justify-center group-hover:bg-primary/10 transition-colors",children:e.jsx(Ge,{className:"w-4 h-4 text-muted-foreground group-hover:text-primary transition-colors"})}),e.jsx("div",{className:"text-[10px] text-muted-foreground group-hover:text-primary transition-colors whitespace-nowrap",children:"추가"})]})})]})}),e.jsxs(ge,{children:[e.jsxs(Y,{className:"border-b-2 border-border/30 bg-muted/30 select-none",children:[e.jsx(O,{className:"p-2 pl-3 text-xs font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",style:{left:0},children:i.skills.label}),t.map((N,C)=>{var V;return e.jsx(h,{champion:N,className:_("p-2",C<t.length-1&&"border-r border-border/30"),children:e.jsxs("div",{className:"flex justify-center gap-1.5",children:[N.passive&&e.jsx(ue,{isPassive:!0,passiveName:N.passive.name,passiveDescription:N.passive.description,passiveImageFull:N.passive.image.full,skill:{},skillIdx:0,version:r}),(V=N.spells)==null?void 0:V.map((A,R)=>{const B=f(N.id,R);return e.jsx(ue,{skill:A,skillIdx:R,version:r,spellData:B},A.id)})]})},N.id)}),n&&e.jsx(O,{className:"p-2 text-center border-l border-border/30",children:e.jsx("div",{className:"w-full h-full min-h-[32px]"})})]}),S.map((N,C)=>e.jsxs(Y,{className:"border-b border-border/30 hover:bg-muted/30 transition-colors",children:[e.jsxs(O,{className:_("p-2 pl-3 text-xs font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",C===S.length-1&&"rounded-bl-lg"),style:{left:0},children:[N.level,i.common.level]}),N.skills.map((V,A)=>{const R=t[A];return e.jsx(h,{champion:R,className:_("p-2",A<t.length-1&&"border-r border-border/30"),children:V?e.jsxs("div",{className:"flex justify-center gap-1.5",children:[e.jsx("div",{className:"flex flex-col items-center min-w-[32px]",children:e.jsx("span",{className:"text-xs text-muted-foreground",children:"-"})}),V.map((B,I)=>e.jsx("div",{className:"flex flex-col items-center min-w-[32px]",children:e.jsx("span",{className:"text-xs font-semibold",children:B.cooldown!==""?`${B.cooldown}${i.common.seconds}`:"-"})},I))]}):e.jsx("span",{className:"text-xs text-muted-foreground",children:"-"})},R.id)}),n&&e.jsx(O,{className:"p-2 text-center border-l border-border/30",children:e.jsx("div",{className:"w-full h-full min-h-[32px]"})})]},N.level))]})]})})}),g&&n&&s&&e.jsx(qe,{championList:s,selectedChampions:t,onSelect:N=>{n(N)},onClose:()=>w(!1)})]})})}function Or({champions:t,version:r,vsMode:s}){var w,P;const{t:n}=X(),{cdragonVersion:a,setCDragonVersion:o}=ht(),[d,i]=K.useState({});K.useEffect(()=>{const l=async()=>{try{const y=await Bt(t,r);if(i(y),!a)try{let j=null;for(const c of Object.keys(y)){const u=y[c];if(u&&u.length>0&&(j=u[0].cdragonVersion??null,j))break}j&&o(j)}catch(j){H.warn("Failed to extract CDragon version from integrated spell data (mobile):",j)}}catch(y){H.warn("Failed to load integrated spell data:",y),i({})}};t.length>0&&l()},[t,r]);const p=K.useMemo(()=>Math.max(...t.map(l=>l.spells?Math.max(...l.spells.map(y=>y.maxrank)):0)),[t]),x=K.useCallback((l,y)=>{const j=d[l];return!j||j.length<=y?null:j[y]},[d]),g=K.useMemo(()=>Array.from({length:p},(l,y)=>{const j=y+1;return{level:j,skills:t.map(c=>c.spells?c.spells.map((u,f)=>{const S=x(c.id,f),h=Ht(u,j,S);return{skill:u,cooldown:h}}):null)}}),[t,p,x]);if(s&&t.length===2){const l=s.championA,y=s.championB;return e.jsx(De,{delayDuration:0,skipDelayDuration:150,children:e.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:e.jsx("div",{className:"min-w-full",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"border border-border/30 rounded-lg overflow-hidden",children:e.jsxs(pe,{className:"border-collapse table-fixed w-auto min-w-full",children:[e.jsx(he,{children:e.jsxs(Y,{className:"border-b border-border/30 select-none",children:[e.jsx(W,{className:"text-left p-1.5 pl-2 text-[10px] font-semibold text-foreground sticky left-0 bg-card z-20 w-[50px] min-w-[50px] border-r border-border/30 select-none",style:{left:0},children:n.common.level}),e.jsx(W,{className:"text-center p-1.5 text-[10px] font-semibold text-foreground w-[calc((100%-90px)/2)] min-w-[100px] border-r border-border/30 select-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-0.5",children:[e.jsx("img",{src:ne(r,l.id),alt:l.name,className:"w-6 h-6 rounded-full",draggable:"false"}),e.jsx("div",{className:"text-xs font-semibold leading-tight text-center text-foreground",children:l.name})]})}),e.jsx(W,{className:"text-center p-1.5 text-[10px] font-semibold text-foreground w-[40px] min-w-[40px] border-r border-border/30 bg-muted/20 select-none",children:e.jsx("div",{className:"text-[9px] font-bold",children:"VS"})}),e.jsx(W,{className:"text-center p-1.5 text-[10px] font-semibold text-foreground w-[calc((100%-90px)/2)] min-w-[100px] select-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-0.5",children:[e.jsx("img",{src:ne(r,y.id),alt:y.name,className:"w-6 h-6 rounded-full",draggable:"false"}),e.jsx("div",{className:"text-xs font-semibold leading-tight text-center text-foreground",children:y.name})]})})]})}),e.jsxs(ge,{children:[e.jsxs(Y,{className:"border-b-2 border-border/30 bg-muted/30 select-none",children:[e.jsx(O,{className:"p-1.5 pl-2 text-[10px] font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",style:{left:0},children:n.skills.label}),e.jsx(O,{className:"p-1.5 border-r border-border/30",children:e.jsxs("div",{className:"flex justify-center gap-0.5",children:[l.passive&&e.jsx(ue,{isPassive:!0,passiveName:l.passive.name,passiveDescription:l.passive.description,passiveImageFull:l.passive.image.full,skill:{},skillIdx:0,version:r,size:"small"}),(w=l.spells)==null?void 0:w.map((j,c)=>{const u=x(l.id,c);return e.jsx(ue,{skill:j,skillIdx:c,version:r,spellData:u,size:"small"},j.id)})]})}),e.jsx(O,{className:"p-1.5 border-r border-border/30 bg-muted/20 select-none"}),e.jsx(O,{className:"p-1.5",children:e.jsxs("div",{className:"flex justify-center gap-0.5",children:[y.passive&&e.jsx(ue,{isPassive:!0,passiveName:y.passive.name,passiveDescription:y.passive.description,passiveImageFull:y.passive.image.full,skill:{},skillIdx:0,version:r,size:"small"}),(P=y.spells)==null?void 0:P.map((j,c)=>{const u=x(y.id,c);return e.jsx(ue,{skill:j,skillIdx:c,version:r,spellData:u,size:"small"},j.id)})]})})]}),g.map((j,c)=>{const u=j.skills[0],f=j.skills[1];return e.jsxs(Y,{className:"border-b border-border/30 hover:bg-muted/30 transition-colors",children:[e.jsxs(O,{className:_("p-1.5 pl-2 text-[10px] font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",c===g.length-1&&"rounded-bl-lg"),style:{left:0},children:[j.level,n.common.level]}),e.jsx(O,{className:"p-1.5 border-r border-border/30",children:u?e.jsxs("div",{className:"flex justify-center gap-0.5",children:[e.jsx("div",{className:"flex flex-col items-center min-w-[20px]",children:e.jsx("span",{className:"text-[9px] text-muted-foreground",children:"-"})}),u.map((S,h)=>e.jsx("div",{className:"flex flex-col items-center min-w-[20px]",children:e.jsx("span",{className:"text-[9px] font-semibold",children:S.cooldown!==""?`${S.cooldown}${n.common.seconds}`:"-"})},h))]}):e.jsx("span",{className:"text-[9px] text-muted-foreground",children:"-"})}),e.jsx(O,{className:"p-1.5 border-r border-border/30 bg-muted/20 select-none"}),e.jsx(O,{className:"p-1.5",children:f?e.jsxs("div",{className:"flex justify-center gap-0.5",children:[e.jsx("div",{className:"flex flex-col items-center min-w-[20px]",children:e.jsx("span",{className:"text-[9px] text-muted-foreground",children:"-"})}),f.map((S,h)=>e.jsx("div",{className:"flex flex-col items-center min-w-[20px]",children:e.jsx("span",{className:"text-[9px] font-semibold",children:S.cooldown!==""?`${S.cooldown}${n.common.seconds}`:"-"})},h))]}):e.jsx("span",{className:"text-[9px] text-muted-foreground",children:"-"})})]},j.level)})]})]})})})})})})}return e.jsx(De,{delayDuration:0,skipDelayDuration:150,children:e.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:e.jsx("div",{className:"min-w-full",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"border border-border/30 rounded-lg overflow-hidden",children:e.jsxs(pe,{className:"border-collapse table-fixed w-auto min-w-full",children:[e.jsx(he,{children:e.jsxs(Y,{className:"border-b border-border/30 select-none",children:[e.jsx(W,{className:"text-left p-2 pl-3 text-xs font-semibold text-foreground sticky left-0 bg-card z-20 w-[60px] min-w-[60px] border-r border-border/30 select-none",style:{left:0},children:n.common.level}),t.map(l=>e.jsx(W,{className:"text-center p-2 text-xs font-semibold text-foreground w-full select-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-1",children:[e.jsx("img",{src:ne(r,l.id),alt:l.name,className:"w-8 h-8 rounded-full",draggable:"false"}),e.jsx("div",{className:"text-sm font-semibold leading-tight text-center text-foreground",children:l.name})]})},l.id))]})}),e.jsxs(ge,{children:[e.jsxs(Y,{className:"border-b-2 border-border/30 bg-muted/30 select-none",children:[e.jsx(O,{className:"p-2 pl-3 text-xs font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",style:{left:0},children:n.skills.label}),t.map(l=>{var y;return e.jsx(O,{className:"p-2",children:e.jsxs("div",{className:"flex justify-center gap-1",children:[l.passive&&e.jsx(ue,{isPassive:!0,passiveName:l.passive.name,passiveDescription:l.passive.description,passiveImageFull:l.passive.image.full,skill:{},skillIdx:0,version:r}),(y=l.spells)==null?void 0:y.map((j,c)=>{const u=x(l.id,c);return e.jsx(ue,{skill:j,skillIdx:c,version:r,spellData:u},j.id)})]})},l.id)})]}),g.map((l,y)=>e.jsxs(Y,{className:"border-b border-border/30 hover:bg-muted/30 transition-colors",children:[e.jsxs(O,{className:_("p-2 pl-3 text-xs font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",y===g.length-1&&"rounded-bl-lg"),style:{left:0},children:[l.level,n.common.level]}),l.skills.map((j,c)=>e.jsx(O,{className:"p-2",children:j?e.jsxs("div",{className:"flex justify-center gap-1",children:[e.jsx("div",{className:"flex flex-col items-center min-w-[24px]",children:e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"-"})}),j.map((u,f)=>e.jsx("div",{className:"flex flex-col items-center min-w-[24px]",children:e.jsx("span",{className:"text-[10px] font-semibold",children:u.cooldown!==""?`${u.cooldown}${n.common.seconds}`:"-"})},f))]}):e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"-"})},t[c].id))]},l.level))]})]})})})})})})}function Kr({champions:t,version:r,activeTab:s,championList:n,onAddChampion:a,onRemoveChampion:o,onReorderChampions:d,vsMode:i}){const p=Le();if(t.length===0)return null;const x=p==="mobile";return e.jsx(xt,{children:e.jsx(Mt,{className:"p-0",children:s==="stats"?x?e.jsx(kr,{champions:t,version:r,championList:n,onAddChampion:a,onRemoveChampion:o,vsMode:i}):e.jsx(Sr,{champions:t,version:r,championList:n,onAddChampion:a,onRemoveChampion:o,onReorderChampions:d}):x?e.jsx(Or,{champions:t,version:r,championList:n,onAddChampion:a,onRemoveChampion:o,vsMode:i}):e.jsx(zr,{champions:t,version:r,championList:n,onAddChampion:a,onRemoveChampion:o,onReorderChampions:d})})})}const Hr=K.memo(Kr),Ur=()=>`tab-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;function Gr({version:t,initialTabs:r,initialSelectedTabId:s}){const[n,a]=b.useState([]),o=b.useRef([]),[d,i]=b.useState(null),[p,x]=b.useState(!1),[g,w]=b.useState(null);b.useEffect(()=>{o.current=n},[n]),b.useEffect(()=>{t&&(r&&r.length>0&&a(r),s&&i(s))},[t,r,s]),b.useEffect(()=>{!d&&n.length>0&&i(n[0].id)},[n,d]),b.useEffect(()=>{d&&!n.find(f=>f.id===d)&&i(n.length>0?n[0].id:null)},[n,d]);const P=b.useCallback(f=>{a(S=>{const h=S.findIndex(N=>N.id===f),v=S.filter(N=>N.id!==f);return i(N=>{if(N&&N!==f&&v.some(R=>R.id===N))return N;if(v.length===0)return null;const C=h>0?h-1:0;return(v[C]??v[0]).id}),v})},[i]),l=b.useCallback(f=>{a(S=>[...S,f]),i(f.id)},[]),y=b.useCallback((f,S)=>{a(h=>h.map(v=>v.id===f?S(v):v))},[]),j=b.useCallback((f,S)=>{a(h=>{const v=h.findIndex(C=>C.id===f);if(v===-1)return[...h,S];const N=[...h];return N[v]=S,N}),i(S.id)},[]),c=b.useCallback(()=>{a([]),i(null),ce(Me),ce(_e)},[]),u=b.useCallback(f=>{const{active:S,over:h}=f;h&&S.id!==h.id&&a(v=>{const N=v.findIndex(V=>V.id===S.id),C=v.findIndex(V=>V.id===h.id);return N===-1||C===-1?v:Rt(v,N,C)})},[]);return{tabs:n,setTabs:a,tabsRef:o,selectedTabId:d,setSelectedTabId:i,showVsSelector:p,setShowVsSelector:x,vsSelectorMode:g,setVsSelectorMode:w,removeTab:P,addTab:l,updateTab:y,replaceTab:j,resetTabs:c,handleDragEnd:u,generateTabId:Ur}}function Wr({version:t,lang:r,championList:s,tabs:n,initialSelectedChampions:a}){const[o,d]=b.useState([]),[i,p]=b.useState(!0);b.useEffect(()=>{if(!t||!s){setTimeout(()=>{p(!1)},0);return}try{if(a&&a.length>0){const j=a.map(c=>{const u=s.find(f=>f.id===c.id||f.key===c.key);return u?{...u,isLoading:!1}:null}).filter(c=>c!==null);j.length>0&&setTimeout(()=>{d(j),j.forEach(c=>{c.id&&(d(u=>u.map(f=>f.id===c.id?{...f,isLoading:!0}:f)),vt(t,r,c.id).then(u=>{d(f=>f.map(S=>S.id===c.id?{...S,fullInfo:u,isLoading:!1}:S))}).catch(u=>{H.error("Failed to load champion info:",u),d(f=>f.map(S=>S.id===c.id?{...S,isLoading:!1}:S))}))})},0)}setTimeout(()=>{p(!1)},0)}catch(j){H.error("Failed to load initial selected champions:",j),setTimeout(()=>{p(!1)},0)}},[t,r,s,a]),b.useEffect(()=>{s&&o.length>0&&setTimeout(()=>{d(j=>j.map(c=>{const u=s.find(f=>f.id===c.id||f.key===c.key);return u?{...c,name:u.name,title:u.title}:c}))},0)},[s,o.length]),b.useEffect(()=>{i||setTimeout(()=>{const j=new Set(n.flatMap(c=>c.champions));d(c=>{if(n.length===0)return c.length>0?[]:c;const u=c.filter(f=>j.has(f.id));return u.length!==c.length?u:c})},0)},[n,i]);const x=b.useCallback(j=>{t&&(d(c=>c.map(u=>u.id===j?{...u,isLoading:!0}:u)),vt(t,r,j).then(c=>{d(u=>u.map(f=>f.id===j?{...f,fullInfo:c,isLoading:!1,skinIndex:0}:f))}).catch(c=>{H.error("Failed to load champion info:",c),d(u=>u.map(f=>f.id===j?{...f,isLoading:!1}:f))}))},[t,r]),g=b.useCallback(j=>{d(c=>{if(c.some(S=>S.id===j.id))return c;const f={...j,isLoading:!0,skinIndex:0};return x(j.id),[...c,f]})},[x]),w=b.useCallback(j=>{d(c=>c.filter(u=>u.id!==j))},[]),P=b.useCallback(()=>{d([]),ce(Be)},[]),l=b.useMemo(()=>o.filter(j=>j.fullInfo&&!j.isLoading),[o]),y=b.useMemo(()=>{const j=new Set(n.filter(c=>c.mode==="normal").flatMap(c=>c.champions));return o.filter(c=>j.has(c.id))},[n,o]);return{selectedChampions:o,setSelectedChampions:d,championsWithFullInfo:l,normalTabChampions:y,addChampionToList:g,removeChampion:w,resetChampions:P,loadChampionInfo:x}}function qr({onAddClick:t}){const{t:r}=X();return e.jsx(xt,{className:"border-dashed",children:e.jsxs(Mt,{className:"flex flex-col items-center justify-center py-12 md:py-16",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-muted/50 flex items-center justify-center mb-4",children:e.jsx($e,{className:"w-8 h-8 text-muted-foreground"})}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:r.encyclopedia.emptyState.title}),e.jsx("p",{className:"text-muted-foreground text-center max-w-md text-sm mb-4",children:r.encyclopedia.emptyState.description}),e.jsxs(oe,{onClick:t,variant:"outline",className:"flex flex-row items-center justify-center gap-2 border-2 border-dashed border-muted-foreground/30 hover:border-primary/50 hover:bg-muted/30 group",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-muted/30 flex items-center justify-center group-hover:bg-primary/10 transition-colors",children:e.jsx(Ge,{className:"w-4 h-4 text-muted-foreground group-hover:text-primary transition-colors"})}),e.jsx("span",{className:"text-sm text-muted-foreground group-hover:text-primary transition-colors",children:r.encyclopedia.emptyState.addButton})]})]})})}function Zr({activeTab:t,onTabChange:r,onReset:s}){const{t:n}=X();return e.jsxs("div",{className:"flex items-center justify-between gap-2 border-b border-border overflow-x-auto -mx-4 md:mx-0 px-4 md:px-0",children:[e.jsx(fr,{value:t,onValueChange:a=>r(a),className:"flex-1",children:e.jsxs(xr,{className:"inline-flex h-auto items-center justify-start gap-2 bg-transparent p-0 border-0",children:[e.jsxs("div",{className:"inline-flex items-center gap-2",children:[e.jsx(Ae,{value:"skills",className:"px-4 py-2 text-sm font-medium transition-colors border-b-2 border-transparent text-muted-foreground hover:text-foreground data-[state=active]:border-primary data-[state=active]:text-primary data-[state=active]:bg-transparent rounded-none shadow-none",children:n.encyclopedia.tabs.skills}),e.jsx(Ae,{value:"stats",className:"px-4 py-2 text-sm font-medium transition-colors border-b-2 border-transparent text-muted-foreground hover:text-foreground data-[state=active]:border-primary data-[state=active]:text-primary data-[state=active]:bg-transparent rounded-none shadow-none",children:n.encyclopedia.tabs.stats})]}),e.jsx("div",{className:"h-6 w-px bg-border/70 mx-1"}),e.jsxs("div",{className:"inline-flex items-center gap-2",children:[e.jsx(Ae,{value:"runes",className:"px-4 py-2 text-sm font-medium transition-colors border-b-2 border-transparent text-muted-foreground hover:text-foreground data-[state=active]:border-primary data-[state=active]:text-primary data-[state=active]:bg-transparent rounded-none shadow-none",children:n.encyclopedia.tabs.runes}),e.jsx(Ae,{value:"items",className:"px-4 py-2 text-sm font-medium transition-colors border-b-2 border-transparent text-muted-foreground hover:text-foreground data-[state=active]:border-primary data-[state=active]:text-primary data-[state=active]:bg-transparent rounded-none shadow-none",children:n.encyclopedia.tabs.items})]})]})}),e.jsx("div",{className:"flex items-center gap-2 shrink-0",children:e.jsxs(oe,{variant:"ghost",size:"sm",onClick:s,className:"flex items-center gap-1.5 shrink-0 text-muted-foreground hover:text-primary hover:bg-muted/30 border-0",children:[e.jsx(hr,{className:"h-3 w-3"}),e.jsx("span",{className:"text-[10px]",children:n.encyclopedia.reset})]})})]})}function Jr({version:t,lang:r}){const{t:s}=X(),[n,a]=b.useState(null),[o,d]=b.useState(!1),p=Le()==="mobile",[x,g]=b.useState(null);if(b.useEffect(()=>{let l=!1;return d(!0),dr(t,r).then(y=>{l||a(y)}).finally(()=>{l||d(!1)}),()=>{l=!0}},[t,r]),o&&!n)return e.jsx("div",{className:"mt-4 text-sm text-muted-foreground",children:s.championSelector.loading});if(!n||n.length===0)return e.jsx("div",{className:"mt-4 text-sm text-muted-foreground",children:s.championSelector.emptyList});const w=l=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:`https://ddragon.leagueoflegends.com/cdn/img/${l.icon}`,alt:l.name,className:"w-8 h-8 rounded-full border border-border/60 bg-transparent"}),e.jsx("div",{className:"flex flex-col",children:e.jsx("span",{className:"text-sm font-semibold",children:l.name})})]}),e.jsx("div",{className:"text-xs text-muted-foreground leading-relaxed",children:e.jsx("span",{dangerouslySetInnerHTML:{__html:l.longDesc||l.shortDesc}})})]}),P=(l,y,j,c,u)=>p?e.jsxs("button",{type:"button",onClick:()=>g(l),className:"flex flex-col items-center gap-1 focus:outline-none min-w-0",style:{width:y},children:[e.jsx("img",{src:`https://ddragon.leagueoflegends.com/cdn/img/${l.icon}`,alt:l.name,className:"w-10 h-10 rounded-full border border-border/60 bg-transparent flex-shrink-0"}),e.jsx("span",{className:"text-[10px] text-center leading-tight line-clamp-2 w-full",children:l.name})]}):e.jsxs(rt,{children:[e.jsx(st,{asChild:!0,children:e.jsxs("button",{type:"button",className:"flex flex-col items-center gap-1 focus:outline-none cursor-help min-w-0",style:{width:y},children:[e.jsx("img",{src:`https://ddragon.leagueoflegends.com/cdn/img/${l.icon}`,alt:l.name,className:"w-10 h-10 rounded-full border border-border/60 bg-transparent flex-shrink-0"}),e.jsx("span",{className:"text-[10px] text-center leading-tight line-clamp-2 w-full",children:l.name})]})}),e.jsx(nt,{side:"top",align:"center",sideOffset:8,className:"max-w-xs p-3",children:w(l)})]},l.id);return e.jsx(De,{delayDuration:200,children:e.jsxs("div",{className:"mt-4",children:[e.jsx(Se,{className:"rounded-md border bg-card/40",children:e.jsx("div",{className:"p-4 grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:n.map(l=>e.jsxs(xt,{className:"p-4 flex flex-col gap-3 bg-background/60 border-border/70",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:`https://ddragon.leagueoflegends.com/cdn/img/${l.icon}`,alt:l.name,className:"w-8 h-8 rounded-full border border-border/60 bg-transparent"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold",children:l.name}),e.jsx("span",{className:"text-xs text-muted-foreground",children:l.key})]})]}),e.jsx("div",{className:"space-y-3",children:l.slots.map((y,j)=>{const c=Math.max(...l.slots.map(h=>h.runes.length)),S=`calc((100% - ${(c-1)*.5}rem) / ${c})`;return e.jsxs("div",{className:"flex flex-nowrap justify-between gap-y-2 gap-x-2 md:gap-x-4",children:[y.runes.map((h,v)=>{const N=v===0,C=v===y.runes.length-1;return e.jsx(K.Fragment,{children:P(h,S,N,C,y.runes.length<c)},h.id)}),y.runes.length<c&&Array.from({length:c-y.runes.length}).map((h,v)=>e.jsx("div",{style:{width:S}},`spacer-${v}`))]},j)})})]},l.id))})}),p&&e.jsx(Oe,{open:!!x,onOpenChange:l=>!l&&g(null),children:e.jsxs(pt,{className:"w-[calc(100vw-32px)] max-w-lg max-h-[70vh] h-[70vh] p-0 rounded-xl overflow-hidden flex flex-col",children:[e.jsxs(Ke,{children:[e.jsx(He,{children:(x==null?void 0:x.name)??"Rune"}),e.jsx(Ue,{children:(x==null?void 0:x.name)??"Rune"})]}),e.jsx(Se,{className:"flex-1 min-h-0",children:e.jsx("div",{className:"p-4",children:x&&w(x)})})]})})]})})}function Yr(t){var p;const r=t.tags||[],s=t.name||"",n=t.plaintext||"",a=`${s} ${n}`.toLowerCase(),o=s+n,d=new Set(["3340","3363","3364"]);return new Set(["4638","4643"]).has(t.id)?!1:!!(d.has(t.id)||/포션|영약/.test(o)||a.includes("potion")||a.includes("elixir")||r.includes("Consumable")||r.includes("Trinket")||r.includes("Vision")&&d.has(t.id)||/도란/.test(o)||a.includes("doran")||r.includes("Jungle")||a.includes("jungle")||(((p=t.gold)==null?void 0:p.total)??0)===0)}function Vt(t){const r=!!t.from&&t.from.length>0,s=!!t.into&&t.into.length>0;return Yr(t)?"starter":r?s?"epic":"legendary":"basic"}function Xr(t){var s;return!(!t.maps||!t.maps[11]||!((s=t.tags)==null?void 0:s.includes("Trinket"))&&t.gold&&t.gold.purchasable===!1||t.inStore===!1||t.cdragon&&(t.cdragon.inStore===!1||t.cdragon.displayInItemSets===!1))}function $t(t){const r=t.tags||[],s=t.name.toLowerCase();(t.plaintext||"").toLowerCase();const n=new Set(["3340","3363","3364"]);return new Set(["4638","4643"]).has(t.id)?!1:!!(n.has(t.id)||r.includes("Trinket")||r.includes("Consumable")||s.includes("potion")||s.includes("elixir")||Qr(t))}function Qr(t){const r=t.name,s=t.plaintext||"";return/포션|영약/.test(r+s)}function Lt(t){const r=t.tags||[],s=t.name.toLowerCase();return r.includes("Boots")||s.includes("boots")}function Et(t){const r=t.tags||[],s=t.stats||{},n=Object.keys(s),a=r.includes("AttackDamage")||n.some(p=>p.toLowerCase().includes("attackdamage")),o=r.includes("SpellDamage")||n.some(p=>p.toLowerCase().includes("spelldamage")),d=r.includes("Health")||r.includes("Armor")||r.includes("SpellBlock"),i=r.includes("ManaRegen")||r.includes("HealthRegen")||r.includes("CooldownReduction");return o&&i?"support":d&&(a||o)?"tank":o?"mage":a&&!d?"assassin":a||d?"fighter":"all"}function Gt(t){return!(!t.gold||t.gold.total<=0||t.gold.purchasable===!1||t.inStore===!1)}function At(t,r){const s=t.stats||{},n=[],a=(o,d,i,p=!1)=>{if(!i)return;const x=r==="ko_KR"?o:d;let g=i;p&&Math.abs(i)<=1&&(g=Math.round(i*100));const w=p?`${g}%`:`${g}`;n.push(`+ ${w} ${x}`)};return typeof s.FlatPhysicalDamageMod=="number"&&a("공격력","Attack Damage",s.FlatPhysicalDamageMod),typeof s.FlatMagicDamageMod=="number"&&a("주문력","Ability Power",s.FlatMagicDamageMod),typeof s.FlatCritChanceMod=="number"&&a("치명타 확률","Critical Strike Chance",s.FlatCritChanceMod*100,!0),typeof s.PercentAttackSpeedMod=="number"&&a("공격 속도","Attack Speed",s.PercentAttackSpeedMod,!0),typeof s.FlatHPPoolMod=="number"&&a("체력","Health",s.FlatHPPoolMod),typeof s.FlatMPPoolMod=="number"&&a("마나","Mana",s.FlatMPPoolMod),typeof s.FlatArmorMod=="number"&&a("방어력","Armor",s.FlatArmorMod),typeof s.FlatSpellBlockMod=="number"&&a("마법 저항력","Magic Resist",s.FlatSpellBlockMod),typeof s.PercentLifeStealMod=="number"&&a("생명력 흡수","Life Steal",s.PercentLifeStealMod,!0),typeof s.PercentSpellVampMod=="number"&&a("주문 흡혈","Spell Vamp",s.PercentSpellVampMod,!0),n}function es(t){let r=t.description||"";return r=r.replace(/<\/?mainText>/gi,""),r=r.replace(/<stats>[\s\S]*?<\/stats>/gi,""),r=r.replace(/^(?:\s|&nbsp;|<br\s*\/?>)+/gi,""),r}function Wt(t,r){var d,i;const s=((d=t.gold)==null?void 0:d.total)??0,n=((i=t.gold)==null?void 0:i.base)??0,a=!!t.from&&t.from.length>0;return n===0&&a?r==="ko_KR"?"구매 불가":"Unavailable":s>0||Gt(t)?s.toLocaleString():r==="ko_KR"?"무료":"Free"}const Re=({item:t,version:r,isSelected:s,onSelect:n,lang:a})=>{const o=Wt(t,a),d=a==="ko_KR"&&o==="구매 불가"||a!=="ko_KR"&&o==="Unavailable";return e.jsxs("button",{type:"button",onClick:n,className:`flex flex-col items-center gap-0 rounded-sm px-0.5 py-0 text-center transition-colors w-9 md:w-10 ${s?"bg-primary/20 border border-primary/60 shadow-sm":"hover:bg-muted/60 border border-transparent"}`,children:[e.jsx("img",{src:`https://ddragon.leagueoflegends.com/cdn/${r}/img/item/${t.id}.png`,alt:t.name,className:"w-7 h-7 md:w-8 md:h-8 aspect-square object-cover rounded-sm border border-border/60 bg-black/40 flex-shrink-0"}),e.jsx("span",{className:`${d?"text-[8px] md:text-[9px]":"text-[9px] md:text-[10px]"} text-amber-600 dark:text-amber-400 font-semibold whitespace-nowrap`,children:o})]})};function ts({version:t,lang:r}){const{t:s}=X(),a=Le()==="mobile",[o,d]=b.useState(null),[i,p]=b.useState(!1),[x,g]=b.useState(""),[w,P]=b.useState("all"),[l,y]=b.useState(null),[j,c]=b.useState(!1);b.useEffect(()=>{let m=!1;return p(!0),ur(t,r).then(T=>{if(!m){const M=T.filter(Xr),L=new Set,k=M.filter($=>L.has($.name)?!1:(L.add($.name),!0));d(k),!l&&k.length>0&&y(k[0])}}).finally(()=>{m||p(!1)}),()=>{m=!0}},[t,r]);const u=b.useMemo(()=>o?new Map(o.map(m=>[m.id,m])):new Map,[o]),f=x.trim().toLowerCase(),{itemsByTier:S,flatFiltered:h}=b.useMemo(()=>{const m={itemsByTier:{starter:[],basic:[],epic:[],legendary:[]},flatFiltered:[]};if(!o)return m;const T=k=>f?`${k.name} ${k.plaintext??""}`.toLowerCase().includes(f):!0,M={starter:[],basic:[],epic:[],legendary:[]},L=[];return o.forEach(k=>{if(!T(k))return;if(w==="trinket"){if(!$t(k))return}else if(w==="boots"){if(!Lt(k))return}else if(w!=="all"){if($t(k)||Lt(k))return;const D=Et(k);if(D!=="all"&&D!==w)return}const $=Vt(k);M[$].push(k),L.push(k)}),Object.keys(M).forEach(k=>{M[k].sort(($,D)=>{var F,U;return(((F=$.gold)==null?void 0:F.total)??0)-(((U=D.gold)==null?void 0:U.total)??0)})}),L.sort((k,$)=>{var D,F;return(((D=k.gold)==null?void 0:D.total)??0)-(((F=$.gold)==null?void 0:F.total)??0)}),{itemsByTier:M,flatFiltered:L}},[o,f,w]);if(i&&!o)return e.jsx("div",{className:"mt-4 text-sm text-muted-foreground",children:s.championSelector.loading});if(!o||o.length===0)return e.jsx("div",{className:"mt-4 text-sm text-muted-foreground",children:s.championSelector.emptyList});const v=m=>{const T=[],M=new Set,L=m.into?[...m.into]:[];for(;L.length>0;){const k=L.shift();if(M.has(k))continue;M.add(k);const $=u.get(k);$&&(T.push($),$.into&&$.into.length>0&&L.push(...$.into))}return T.sort((k,$)=>{var D,F;return(((D=k.gold)==null?void 0:D.total)??0)-(((F=$.gold)==null?void 0:F.total)??0)}),T},N=(m,T=0,M=6)=>{if(T>=M)return{item:m,children:[]};const L=[];return m.from&&m.from.length>0&&m.from.forEach(k=>{const $=u.get(k);$&&L.push(N($,T+1,M))}),{item:m,children:L}},C=m=>{if(r==="ko_KR")switch(m){case"all":return"전체";case"fighter":return"전사";case"mage":return"마법사";case"assassin":return"암살자";case"support":return"서포터";case"tank":return"탱커";case"trinket":return"장신구/와드/포션";case"boots":return"신발"}switch(m){case"all":return"All";case"fighter":return"Fighter";case"mage":return"Mage";case"assassin":return"Assassin";case"support":return"Support";case"tank":return"Tank";case"trinket":return"Trinkets";case"boots":return"Boots"}},V=m=>{if(r==="ko_KR")switch(m){case"legendary":return"전설 아이템";case"epic":return"서사급 아이템";case"basic":return"기본 아이템";case"starter":return"시작 아이템"}switch(m){case"legendary":return"Legendary";case"epic":return"Epic";case"basic":return"Basic";case"starter":return"Starter"}},A=l?es(l):"",B=A.replace(/<[^>]*>/g,"").replace(/&nbsp;|\u00a0/gi,"").trim().length>0,I=((l==null?void 0:l.plaintext)||"").trim(),z=!B&&!!I,G=l&&e.jsxs("div",{className:"flex flex-col gap-2 h-full min-h-0",children:[e.jsxs("div",{className:"space-y-0.5 text-[11px] pb-1 border-b border-border/60 flex-shrink-0",children:[e.jsx("div",{className:"font-semibold",children:r==="ko_KR"?"상위 아이템 (Builds into)":"Builds into"}),e.jsx("div",{className:"overflow-x-auto pb-0.5",children:e.jsx("div",{className:"flex flex-nowrap gap-1 min-w-max",children:v(l).length>0?v(l).map(m=>e.jsx(Re,{item:m,version:t,isSelected:l.id===m.id,onSelect:()=>y(m),lang:r},m.id)):e.jsx("span",{className:"text-[10px] text-muted-foreground",children:r==="ko_KR"?"상위 아이템 없음":"No higher items"})})})]}),e.jsxs("div",{className:"space-y-1 text-[11px] py-1 flex-shrink-0",children:[e.jsx("div",{className:"font-semibold",children:r==="ko_KR"?"아이템 트리":"Item Tree"}),(()=>{var M;const m=N(l),T=L=>{const k=L.children.length>0;return e.jsxs("div",{className:"flex flex-col items-center gap-0",children:[e.jsx(Re,{item:L.item,version:t,isSelected:l.id===L.item.id,onSelect:()=>y(L.item),lang:r}),k&&e.jsxs("div",{className:"mt-0 flex flex-col items-stretch",children:[e.jsx("div",{className:"relative flex justify-center",children:e.jsx("div",{className:"h-1 w-[2px] bg-primary/60"})}),e.jsx("div",{className:"relative flex flex-nowrap items-start justify-center gap-y-0 pt-0",children:L.children.map(($,D)=>{const F=L.children.length,U=D===0,Z=D===F-1,re=U?"left-1/2 right-0":Z?"left-0 right-1/2":"left-0 right-0";return e.jsxs("div",{className:"relative flex flex-col items-center gap-0 pt-0.5 px-1",children:[F>1&&e.jsx("div",{className:`pointer-events-none absolute top-0 h-[2px] bg-primary/60 ${re}`}),e.jsx("div",{className:"pointer-events-none absolute top-0 left-1/2 -translate-x-1/2 h-2 w-[2px] bg-primary/60"}),T($)]},`${$.item.id}-${D}`)})})]})]})};return!m.children.length&&!((M=m.item.from)!=null&&M.length)?e.jsx("span",{className:"text-[10px] text-muted-foreground",children:r==="ko_KR"?"구성 아이템 없음":"No components"}):e.jsx("div",{className:"pt-0",children:e.jsx("div",{className:"w-full rounded-md border border-border/60 bg-muted/40 px-2 py-0.5 overflow-x-auto scrollbar-hide",children:e.jsx("div",{className:"min-w-max flex justify-center",children:T(m)})})})})()]}),e.jsx(Se,{className:"flex-1 min-h-0",children:e.jsx("div",{className:"pt-2 pr-3",children:e.jsxs("div",{className:"rounded-md border border-border/70 dark:border-neutral-700/80 bg-card text-foreground dark:bg-neutral-950 dark:text-slate-50 shadow-md px-3 py-2 text-[11px] space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("img",{src:`https://ddragon.leagueoflegends.com/cdn/${t}/img/item/${l.id}.png`,alt:l.name,className:"w-9 h-9 rounded-sm border border-border/60 bg-black/40 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"text-xs font-semibold truncate text-foreground dark:text-amber-200",children:l.name}),Gt(l)&&e.jsx("div",{className:"text-[11px] text-amber-600 dark:text-amber-300 font-semibold whitespace-nowrap",children:Wt(l,r)})]}),e.jsxs("div",{className:"mt-0.5 flex items-center justify-between text-[10px] text-muted-foreground dark:text-slate-300",children:[e.jsx("span",{children:V(Vt(l))}),(()=>{const m=Et(l);if(m==="all")return null;const T=C(m);return e.jsx("span",{className:"text-[10px] text-muted-foreground dark:text-slate-400",children:T})})()]})]})]}),e.jsx("div",{className:"h-px bg-neutral-700/80"}),At(l,r).length>0&&e.jsx("ul",{className:"space-y-0.5 text-[11px] leading-snug",children:At(l,r).map(m=>e.jsx("li",{className:"text-primary",children:m},m))}),z&&e.jsx("p",{className:"text-[11px] leading-snug text-foreground dark:text-slate-100",children:I}),B&&e.jsx("div",{className:"text-[11px] leading-snug text-foreground dark:text-slate-100 [&_br]:block [&_li]:ml-4 [&_li]:list-disc [&_li]:text-[11px] [&_li]:leading-snug",children:e.jsx("span",{dangerouslySetInnerHTML:{__html:A}})})]})})})]});return a?e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(Fe,{value:x,onChange:m=>g(m.target.value),placeholder:r==="ko_KR"?"아이템 이름 검색...":"Search item name...",className:"h-9 text-xs"}),e.jsx("div",{className:"flex gap-1 overflow-x-auto pb-1",children:["all","fighter","mage","assassin","support","tank","trinket","boots"].map(m=>e.jsx("button",{type:"button",onClick:()=>P(m),className:`px-2.5 py-1 rounded-full text-[11px] whitespace-nowrap border ${w===m?"bg-primary text-primary-foreground border-primary":"bg-muted/60 text-muted-foreground border-border/60"}`,children:C(m)},m))})]}),e.jsx("div",{className:"rounded-md border bg-card/40",children:e.jsx("div",{className:"p-1 space-y-1",children:Object.keys(S).map(m=>{const T=S[m];return!T||T.length===0?null:e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("div",{className:"text-[11px] font-semibold text-muted-foreground",children:V(m)}),e.jsx("div",{className:"flex flex-wrap gap-1",children:T.map(M=>e.jsx(Re,{item:M,version:t,isSelected:(l==null?void 0:l.id)===M.id,onSelect:()=>{y(M),c(!0)},lang:r},M.id))})]},m)})})}),e.jsx(Oe,{open:j&&!!l,onOpenChange:m=>{m||c(!1)},children:e.jsxs(pt,{className:"w-[calc(100vw-32px)] max-w-lg max-h-[70vh] h-[70vh] p-0 rounded-xl overflow-hidden flex flex-col",children:[e.jsxs(Ke,{children:[e.jsx(He,{children:(l==null?void 0:l.name)??"Item"}),e.jsx(Ue,{children:(l==null?void 0:l.name)??"Item"})]}),e.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto",children:e.jsx("div",{className:"p-4",children:G})})]})})]}):e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsx("div",{className:"flex flex-wrap gap-1",children:["all","fighter","mage","assassin","support","tank","trinket","boots"].map(m=>e.jsx("button",{type:"button",onClick:()=>P(m),className:`px-2.5 py-1 rounded-full text-[11px] whitespace-nowrap border ${w===m?"bg-primary text-primary-foreground border-primary":"bg-muted/60 text-muted-foreground border-border/60"}`,children:C(m)},m))}),e.jsx(Fe,{value:x,onChange:m=>g(m.target.value),placeholder:r==="ko_KR"?"아이템 이름 검색...":"Search item name...",className:"h-8 text-xs md:text-sm w-full sm:w-52 md:w-64"})]}),e.jsxs("div",{className:"rounded-md border bg-card/40 md:h-[calc(100vh-12rem)] flex flex-col md:flex-row",children:[e.jsxs("div",{className:"md:flex-1 md:border-r border-border/60 flex flex-col min-w-0 min-h-0",children:[e.jsx("div",{className:"px-3 py-2 border-b border-border/60 flex items-center justify-between flex-shrink-0",children:e.jsx("div",{className:"text-[11px] font-semibold text-muted-foreground",children:r==="ko_KR"?"아이템":"Items"})}),e.jsx(Se,{className:"flex-1 min-h-0",children:e.jsx("div",{className:"p-1 space-y-1",children:Object.keys(S).map(m=>{const T=S[m];return!T||T.length===0?null:e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("div",{className:"text-[11px] font-semibold text-muted-foreground",children:V(m)}),e.jsx("div",{className:"flex flex-wrap gap-1",children:T.map(M=>e.jsx(Re,{item:M,version:t,isSelected:(l==null?void 0:l.id)===M.id,onSelect:()=>y(M),lang:r},M.id))})]},m)})})})]}),e.jsx("div",{className:"md:w-[340px] hidden md:flex flex-col p-3 min-h-0",children:l?G:e.jsx("div",{className:"text-xs text-muted-foreground h-full flex items-center justify-center text-center px-4",children:r==="ko_KR"?"왼쪽에서 아이템을 선택하면 여기에서 아이템 트리와 설명을 볼 수 있어요.":"Select an item on the left to see its tree and description here."})})]})]})}const qt="flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-medium transition-colors shrink-0 relative select-none",Zt="bg-primary text-primary-foreground",Jt="bg-muted/50 text-muted-foreground",Yt="touch-none cursor-grab active:cursor-grabbing p-0.5 -ml-1 mr-0.5 opacity-60 hover:opacity-100 transition-opacity select-none",Xt="ml-1 p-0.5 rounded-full hover:bg-muted/50 active:bg-muted transition-colors shrink-0 select-none group",rs="ml-1 p-1 rounded-full hover:bg-muted/50 active:bg-muted transition-colors shrink-0 select-none group";function ss({tab:t,champion:r,version:s,selectedTabId:n,onSelect:a,onRemove:o,onVsClick:d}){const{t:i}=X(),{attributes:p,listeners:x,setNodeRef:g,transform:w,transition:P,isDragging:l}=ye({id:t.id}),y={transform:we.Transform.toString(w),transition:P,opacity:l?.5:1},j=n===t.id,c=j?Zt:Jt;return e.jsxs("div",{ref:g,style:y,"data-tab-id":t.id,className:_(qt,c,l&&"z-50"),onClick:u=>{const f=u.target;f.tagName==="BUTTON"||f.closest("button")||a(t.id)},children:[e.jsx("button",{...p,...x,className:Yt,"aria-label":"Drag to reorder",children:e.jsx(We,{className:"h-3 w-3 pointer-events-none select-none"})}),e.jsxs("div",{className:"flex items-center gap-1.5 flex-1 cursor-pointer select-none",children:[e.jsx("img",{src:ne(s,r.id),alt:r.name,className:"w-5 h-5 rounded-full pointer-events-none select-none",draggable:"false"}),e.jsx("span",{className:"pointer-events-none select-none",children:r.name})]}),e.jsx("button",{onClick:u=>{u.preventDefault(),u.stopPropagation(),d(t.id)},className:rs,"aria-label":`${i.encyclopedia.vs} with ${r.name}`,title:i.encyclopedia.vsStart,type:"button",children:e.jsx(Ie,{className:_("h-3 w-3 transition-colors",j?"text-primary-foreground":"text-muted-foreground")})}),e.jsx("button",{onClick:u=>{u.preventDefault(),u.stopPropagation(),o(t.id)},className:Xt,"aria-label":`Remove ${r.name}`,type:"button",children:e.jsx(ke,{className:_("h-3 w-3 transition-colors",j?"text-primary-foreground":"text-muted-foreground")})})]})}function ns({tab:t,championA:r,championB:s,version:n,selectedTabId:a,onSelect:o,onRemove:d,onChangeChampionA:i,onChangeChampionB:p}){const{t:x}=X(),{attributes:g,listeners:w,setNodeRef:P,transform:l,transition:y,isDragging:j}=ye({id:t.id}),c={transform:we.Transform.toString(l),transition:y,opacity:j?.5:1},u=a===t.id,f=u?Zt:Jt;return e.jsxs("div",{ref:P,style:c,"data-tab-id":t.id,className:_(qt,f,j&&"z-50"),children:[e.jsx("button",{...g,...w,className:Yt,"aria-label":"Drag to reorder",children:e.jsx(We,{className:"h-3 w-3 pointer-events-none select-none"})}),e.jsxs("div",{className:"flex items-center gap-1.5 flex-1 select-none",children:[e.jsx("button",{onClick:S=>{S.preventDefault(),S.stopPropagation(),i(t.id)},className:"flex items-center touch-none hover:opacity-80 transition-opacity select-none",children:e.jsx("img",{src:ne(n,r.id),alt:r.name,className:"w-5 h-5 rounded-full select-none pointer-events-none",draggable:"false"})}),e.jsx("button",{onClick:()=>{o(t.id)},className:"text-[10px] font-semibold touch-none select-none",children:x.encyclopedia.vs}),e.jsx("button",{onClick:S=>{S.preventDefault(),S.stopPropagation(),p(t.id)},className:"flex items-center touch-none hover:opacity-80 transition-opacity select-none",children:e.jsx("img",{src:ne(n,s.id),alt:s.name,className:"w-5 h-5 rounded-full select-none pointer-events-none",draggable:"false"})})]}),e.jsx("button",{onClick:S=>{S.preventDefault(),S.stopPropagation(),d(t.id)},className:Xt,"aria-label":"Remove VS tab",children:e.jsx(ke,{className:_("h-3 w-3 transition-colors",u?"text-primary-foreground":"text-muted-foreground")})})]})}function as({tabs:t,championsWithFullInfo:r,version:s,selectedTabId:n,sensors:a,onDragEnd:o,onSelectTab:d,onRemoveTab:i,onVsClick:p,onChangeChampionA:x,onChangeChampionB:g,onAddClick:w}){const{t:P}=X(),l=b.useRef(null),y=b.useRef(t.length),j=b.useRef(!1),c=b.useRef((u=!0)=>{if(!l.current||!n)return;const f=l.current.querySelector("[data-radix-scroll-area-viewport]");if(!f)return;const S=f.querySelector(`[data-tab-id="${n}"]`);if(S){const h=S.offsetLeft,v=S.offsetWidth,N=f.offsetWidth,C=h-N/2+v/2;u?f.scrollTo({left:Math.max(0,C),behavior:"smooth"}):f.scrollLeft=Math.max(0,C)}});return b.useEffect(()=>{!j.current&&n&&t.length>0&&(j.current=!0,requestAnimationFrame(()=>{requestAnimationFrame(()=>{c.current(!1)})}))},[n,t.length]),b.useEffect(()=>{if(!l.current)return;const u=l.current.querySelector("[data-radix-scroll-area-viewport]");u&&(t.length>y.current&&u.scrollTo({left:u.scrollWidth,behavior:"smooth"}),y.current=t.length)},[t.length]),b.useEffect(()=>{if(j.current&&n){const u=setTimeout(()=>{c.current(!0)},100);return()=>clearTimeout(u)}},[n]),e.jsx("div",{className:"border-b border-border -mx-4 px-4",children:e.jsxs("div",{className:"flex items-center gap-2 pb-2",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground shrink-0 pl-3",children:P.encyclopedia.champion}),e.jsxs(Se,{ref:l,type:"scroll",className:"flex-1",children:[e.jsx(dt,{sensors:a,collisionDetection:ut,onDragEnd:o,children:e.jsx(mt,{items:t.map(u=>u.id),strategy:ft,children:e.jsxs("div",{className:"flex items-center gap-2 w-max select-none pr-2",children:[t.map(u=>{if(u.mode==="vs"){const f=r.find(h=>h.id===u.champions[0]),S=r.find(h=>h.id===u.champions[1]);return!f||!S?null:e.jsx(ns,{tab:u,championA:f,championB:S,version:s,selectedTabId:n,onSelect:d,onRemove:i,onChangeChampionA:x,onChangeChampionB:g},u.id)}else{const f=r.find(S=>S.id===u.champions[0]);return f?e.jsx(ss,{tab:u,champion:f,version:s,selectedTabId:n,onSelect:d,onRemove:i,onVsClick:p},u.id):null}}),e.jsxs(oe,{onClick:w,variant:"outline",size:"sm",className:"flex items-center gap-1.5 shrink-0 border-2 border-dashed border-muted-foreground/30 hover:border-primary hover:bg-primary/10 hover:text-primary h-auto py-1.5 px-3 transition-colors",children:[e.jsx(Ge,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs",children:P.encyclopedia.add})]})]})})}),e.jsx(mr,{orientation:"horizontal"})]})]})})}function ls({open:t,vsSelectorMode:r,tabs:s,championList:n,selectedChampions:a,onSelect:o,onClose:d,onOpenChange:i}){const{t:p}=X();if(!t||!r)return null;const x=s.find(w=>w.id===r.tabId);if(!x||r.mode!=="select-second"&&x.mode!=="vs")return null;const g=r.mode==="change-champion-a"?x.champions[1]:x.champions[0];return g?e.jsx(qe,{championList:n,selectedChampions:a,onSelect:o,onClose:d,open:t,onOpenChange:i,vsMode:{currentChampionId:g,title:p.encyclopedia.selectOpponent}}):null}function os(t){return t==="skills"||t==="stats"||t==="runes"||t==="items"}function is({lang:t,championList:r,version:s,cdragonVersion:n,initialSelectedChampions:a,initialTabs:o,initialSelectedTabId:d}){const[i,p]=or(),g=Le()==="mobile",w=b.useMemo(()=>{const E=i.get("tab");return os(E)?E:null},[i]),P=()=>w||"skills",[l,y]=b.useState(P),j=b.useRef(w),c=b.useRef(P());b.useEffect(()=>{const E=w||"skills",q=j.current||"skills";E!==q&&E!==l&&(y(E),c.current=E),j.current=w},[w,l]),b.useEffect(()=>{const E=w||"skills",q=c.current;if(l!==q&&E!==l){const J=new URLSearchParams(i);l==="skills"?J.delete("tab"):J.set("tab",l),p(J,{replace:!0}),j.current=l==="skills"?null:l}c.current=l},[l,w,i,p]);const[u,f]=b.useState(!1),{cdragonVersion:S}=ht(),{t:h}=X(),{tabs:v,tabsRef:N,selectedTabId:C,setSelectedTabId:V,showVsSelector:A,setShowVsSelector:R,vsSelectorMode:B,setVsSelectorMode:I,removeTab:z,addTab:G,updateTab:m,replaceTab:T,resetTabs:M,handleDragEnd:L,generateTabId:k}=Gr({version:s,initialTabs:o,initialSelectedTabId:d}),{selectedChampions:$,setSelectedChampions:D,championsWithFullInfo:F,normalTabChampions:U,addChampionToList:Z,removeChampion:re,resetChampions:le}=Wr({version:s,lang:t,championList:r,tabs:v,initialSelectedChampions:a}),se=b.useCallback(()=>{try{if($.length>0){const E=$.map(({id:q,key:J})=>({id:q,key:J}));Ye(Be,JSON.stringify(E))}else ce(Be);v.length>0?Ye(Me,JSON.stringify(v)):ce(Me),C?Ye(_e,C):ce(_e)}catch(E){H.error("Failed to persist encyclopedia state to storage:",E)}},[$,v,C]),je=lt(Ne(ct,{activationConstraint:{distance:12}}),Ne(it,{coordinateGetter:ot})),Ce=b.useCallback((E,q)=>{D(J=>Rt(J,E,q))},[D]),ie=b.useCallback(E=>{if(new Set($.map(fe=>fe.id)).has(E.id)){const fe=N.current,Q=fe.some(ee=>ee.mode==="normal"&&ee.champions.length===1&&ee.champions[0]===E.id),Ee=fe.some(ee=>ee.mode==="vs"&&ee.champions.includes(E.id));if(Q){const ee=v.find(Ze=>Ze.mode==="normal"&&Ze.champions.length===1&&Ze.champions[0]===E.id);ee&&z(ee.id),Ee||re(E.id);return}if(Ee){const ee={mode:"normal",champions:[E.id],id:k()};G(ee);return}const bt=v.find(ee=>ee.mode==="normal"&&ee.champions.length===1&&ee.champions[0]===E.id);bt&&z(bt.id),re(E.id);return}Z(E);const J={mode:"normal",champions:[E.id],id:k()};G(J)},[$,v,N,Z,re,G,z,k]),Te=b.useCallback(()=>{le(),M(),ce(Be),ce(Me),ce(_e)},[le,M]),Qt=b.useCallback(E=>{if(!B)return;const{mode:q,tabId:J}=B,fe=v.find(Q=>Q.id===J);if(fe){if(q==="select-second"){const Q={mode:"vs",champions:[fe.champions[0],E.id],id:k()};T(J,Q),$.some(Ee=>Ee.id===E.id)||Z(E)}else q==="change-champion-a"?(m(J,Q=>({...Q,champions:[E.id,Q.champions[1]]})),$.some(Q=>Q.id===E.id)||Z(E)):q==="change-champion-b"&&(m(J,Q=>({...Q,champions:[Q.champions[0],E.id]})),$.some(Q=>Q.id===E.id)||Z(E));R(!1),I(null)}},[B,v,$,Z,m,T,k]),ae=b.useMemo(()=>C&&v.find(E=>E.id===C)||null,[C,v]),de=b.useMemo(()=>ae?ae.champions.map(E=>{var q;return(q=F.find(J=>J.id===E))==null?void 0:q.fullInfo}).filter(E=>E!==void 0):[],[ae,F]),gt=b.useMemo(()=>!g||ae&&ae.mode==="vs"?null:ae&&ae.mode==="normal"&&de.length>0?de[0]:null,[g,ae,de]),er=b.useCallback(E=>{v.forEach(q=>{q.champions.includes(E)&&z(q.id)}),re(E)},[v,re,z]),tr=b.useCallback(E=>{I({mode:"select-second",tabId:E}),R(!0)},[]),rr=b.useCallback(E=>{I({mode:"change-champion-a",tabId:E,championIndex:0}),R(!0)},[]),sr=b.useCallback(E=>{I({mode:"change-champion-b",tabId:E,championIndex:1}),R(!0)},[]);return e.jsxs("div",{className:"w-full max-w-7xl mx-auto px-4 md:px-6 lg:px-8 pb-4 md:pb-5",children:[u&&e.jsx(qe,{championList:r,selectedChampions:U,onSelect:ie,onClose:()=>{f(!1),se()},open:u,onOpenChange:E=>{f(E),E||se()}}),e.jsx(ls,{open:A,vsSelectorMode:B,tabs:v,championList:r,selectedChampions:$,onSelect:Qt,onClose:()=>{R(!1),I(null),se()},onOpenChange:E=>{R(E),E||(I(null),se())}}),e.jsx("div",{className:"mt-3 md:mt-4",children:e.jsx(Zr,{activeTab:l,onTabChange:E=>{y(E)},onReset:Te})}),l==="runes"&&e.jsx(Jr,{version:s,lang:t}),l==="items"&&e.jsx(ts,{version:s,lang:t}),(l==="skills"||l==="stats")&&e.jsxs(e.Fragment,{children:[$.length>0&&F.length>0&&e.jsxs("div",{className:"mt-4 md:mt-6 space-y-4 md:space-y-6",children:[g&&v.length>0&&e.jsx(as,{tabs:v,championsWithFullInfo:F,version:s,selectedTabId:C,sensors:je,onDragEnd:L,onSelectTab:V,onRemoveTab:z,onVsClick:tr,onChangeChampionA:rr,onChangeChampionB:sr,onAddClick:()=>f(!0)}),e.jsx(Hr,{champions:g&&ae&&ae.mode==="vs"&&de.length===2?de:g&&gt?[gt]:F.map(E=>E.fullInfo),version:s,activeTab:l==="skills"?"skills":"stats",championList:r,onAddChampion:g?void 0:ie,onRemoveChampion:er,onReorderChampions:g?void 0:Ce,vsMode:g&&ae&&ae.mode==="vs"&&de.length===2?{championA:de[0],championB:de[1]}:void 0})]}),$.length===0&&e.jsx("div",{className:"mt-4",children:e.jsx(qr,{onAddClick:()=>f(!0)})})]})]})}function xs(t){return e.jsx(Fr,{initialDDragonVersion:t.version,initialCDragonVersion:t.cdragonVersion,children:e.jsx(is,{...t})})}export{xs as default};
