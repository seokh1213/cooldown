import{r as h,j as e,d as J,f as qt,O as Ut,g as Zt,v as qe,w as be,x as Ue,K as Ze,y as Ye,z as Je,A as Xe,E as Qe,F as et,G as je,I as Ne,J as jt,L as Yt,M as Nt,N as vt,Q as yt}from"/cooldown/assets/react-vendor-CrtkgiRr.js";import{c as E,B as ae,u as Q,g as Me,C as X,D as wt,V as Ct,a as St,b as kt,d as ye,l as O,e as Jt,f as tt,P as Xt,S as ot,h as Qt,i as Tt,T as lt,j as it,k as ct,m as He,r as le,n as $e,o as Ae,p as dt,q as Ee,s as er,t as Fe}from"/cooldown/assets/index-Cf-ksDIn.js";import{e as tr,f as ke,X as ve,S as Le,g as Be,G as _e,T as ut,R as rr}from"/cooldown/assets/lucide-icons-DdUfcdEd.js";const rt=h.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:E("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r}));rt.displayName="Card";const sr=h.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:E("flex flex-col space-y-1.5 p-6",t),...r}));sr.displayName="CardHeader";const nr=h.forwardRef(({className:t,...r},s)=>e.jsx("h3",{ref:s,className:E("text-2xl font-semibold leading-none tracking-tight",t),...r}));nr.displayName="CardTitle";const ar=h.forwardRef(({className:t,...r},s)=>e.jsx("p",{ref:s,className:E("text-sm text-muted-foreground",t),...r}));ar.displayName="CardDescription";const st=h.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:E("p-6 pt-0",t),...r}));st.displayName="CardContent";const or=h.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:E("flex items-center p-6 pt-0",t),...r}));or.displayName="CardFooter";const me=h.forwardRef(({className:t,...r},s)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:s,className:E("w-full caption-bottom text-sm",t),...r})}));me.displayName="Table";const fe=h.forwardRef(({className:t,...r},s)=>e.jsx("thead",{ref:s,className:E("[&_tr]:border-b",t),...r}));fe.displayName="TableHeader";const xe=h.forwardRef(({className:t,...r},s)=>e.jsx("tbody",{ref:s,className:E("[&_tr:last-child]:border-0",t),...r}));xe.displayName="TableBody";const lr=h.forwardRef(({className:t,...r},s)=>e.jsx("tfoot",{ref:s,className:E("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...r}));lr.displayName="TableFooter";const q=h.forwardRef(({className:t,...r},s)=>e.jsx("tr",{ref:s,className:E("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...r}));q.displayName="TableRow";const K=h.forwardRef(({className:t,...r},s)=>e.jsx("th",{ref:s,className:E("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...r}));K.displayName="TableHead";const _=h.forwardRef(({className:t,...r},s)=>e.jsx("td",{ref:s,className:E("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...r}));_.displayName="TableCell";const ir=h.forwardRef(({className:t,...r},s)=>e.jsx("caption",{ref:s,className:E("mt-4 text-sm text-muted-foreground",t),...r}));ir.displayName="TableCaption";const Ge=h.forwardRef(({className:t,type:r,...s},n)=>e.jsx("input",{type:r,className:E("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base md:text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...s}));Ge.displayName="Input";function cr({className:t,...r}){return e.jsx("div",{className:E("animate-pulse rounded-md bg-muted",t),...r})}function dr({addChampion:t,data:r,name:s,thumbnailSrc:n,selected:a}){const[i,u]=h.useState(!1),[c,p]=h.useState(!1),[g,b]=h.useState(a);h.useEffect(()=>{b(a)},[a]);const w=h.useCallback(y=>{y.preventDefault(),y.stopPropagation(),b(m=>!m),t(r)},[t,r]),C=h.useCallback(()=>{u(!0)},[]),j=h.useCallback(()=>{p(!0)},[]);return e.jsxs("div",{className:"flex flex-col items-center justify-center m-1 h-fit",children:[e.jsxs(ae,{variant:"ghost",className:"cursor-pointer rounded-full shrink-0 p-0 h-auto w-auto hover:bg-transparent relative touch-manipulation",onClick:w,"aria-label":a?`Deselect ${s}`:`Select ${s}`,"aria-pressed":a,children:[e.jsxs("div",{className:"relative w-12 h-12 md:w-14 md:h-14 shrink-0 overflow-hidden rounded-full",children:[!i&&!c&&e.jsx(cr,{className:"absolute inset-0 rounded-full"}),!i&&!c&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-muted via-muted/80 to-muted/60 blur-sm"}),e.jsx("img",{className:E("absolute inset-0 w-full h-full rounded-full bg-black/5 border-0 box-border transition-all duration-200 ease-out object-cover",!a&&!g&&"hover:scale-105",i?"opacity-100":"opacity-0"),src:n,alt:s,loading:"lazy",decoding:"async",width:"56",height:"56",onLoad:C,onError:j}),(g||a)&&e.jsx("div",{className:"absolute inset-0 rounded-full pointer-events-none z-10",style:{boxShadow:"inset 0 0 0 2px hsl(var(--primary)), 0 0 0 3px hsl(var(--primary) / 0.3)"}})]}),(g||a)&&e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-4 h-4 md:w-5 md:h-5 bg-primary rounded-full flex items-center justify-center pointer-events-none z-20 shadow-lg border-2 border-background",children:e.jsx(tr,{className:"w-2.5 h-2.5 md:w-3 md:h-3 text-primary-foreground stroke-[3]"})})]}),e.jsx("div",{className:"text-xs md:text-sm whitespace-nowrap mt-0.5",children:s})]})}const mt=J.memo(dr);function ur(t,r){const{lang:s}=Q();return h.useMemo(()=>{if(!t)return[];if(!r)return t;const a=Me(r,s);return t.filter(i=>a.some(u=>{const c=u.toLowerCase();return!!(i.name.toLowerCase().includes(c)||i.hangul&&i.hangul.toLowerCase().includes(c)||i.id.toLowerCase().includes(c)||s==="ko_KR"&&(Me(i.name,s).some(g=>g.toLowerCase().includes(c))||i.hangul&&Me(i.hangul,s).some(b=>b.toLowerCase().includes(c))))}))},[t,r,s])}const ft="championSelectorScrollPosition";function mr(t,r,s){h.useEffect(()=>{if(!r||!s)return;const n=()=>{if(t.current){const a=sessionStorage.getItem(ft);if(a){const i=parseInt(a,10);t.current.scrollTop=i}}};n(),requestAnimationFrame(()=>{n()}),setTimeout(()=>{n()},200)},[r,s,t]),h.useEffect(()=>{const n=t.current;if(!n||!r||!s)return;let a;const i=()=>{clearTimeout(a),a=setTimeout(()=>{sessionStorage.setItem(ft,n.scrollTop.toString())},100)};return n.addEventListener("scroll",i,{passive:!0}),()=>{clearTimeout(a),n.removeEventListener("scroll",i)}},[r,s,t])}function fr({championList:t,selectedChampions:r,onSelect:s,onClose:n,slotIndex:a,open:i,onOpenChange:u,vsMode:c}){const{t:p}=Q(),[g,b]=h.useState(!1),w=i!==void 0,C=w?!!i:g,j=w?u||(()=>{}):b,[y,m]=h.useState(""),[o,l]=h.useState(-1),f=h.useRef(null),v=h.useRef(null),d=h.useRef(null),N=n!==void 0,x=n||(()=>{}),S=ur(t,y),k=h.useMemo(()=>new Set(r.map(T=>T.id)),[r]),P=h.useMemo(()=>c&&(r.find(T=>T.id===c.currentChampionId)||(t==null?void 0:t.find(T=>T.id===c.currentChampionId)))||null,[c,r,t]),A=h.useMemo(()=>c?S.filter(T=>T.id!==c.currentChampionId):S,[S,c]),B=h.useCallback(T=>{const V=T.target;f.current&&!f.current.contains(V)&&(j(!1),m(""),l(-1))},[j]);h.useEffect(()=>{if(C&&!N)return document.addEventListener("mousedown",B),()=>{document.removeEventListener("mousedown",B)}},[C,B,N]);const I=h.useCallback(T=>{j(T),T||(m(""),l(-1),n&&n()),u&&u(T)},[n,u]),M=h.useCallback(T=>{s(T),N?l(-1):(j(!1),l(-1),document.body.style.overflow="",x())},[s,n,N]),z=h.useCallback(T=>{if(!(!C&&!N||!t))if(T.key==="ArrowDown")T.preventDefault(),l(V=>V<S.length-1?V+1:V);else if(T.key==="ArrowUp")T.preventDefault(),l(V=>V>0?V-1:-1);else if(T.key==="Enter"&&o>=0){T.preventDefault();const V=S[o];V&&M(V)}else T.key==="Escape"&&I(!1)},[C,N,t,S,o,M,I,k]);return h.useEffect(()=>{if(o>=0&&d.current){const T=d.current.querySelectorAll("[data-champion-item]");T[o]&&T[o].scrollIntoView({block:"nearest"})}},[o]),h.useEffect(()=>{w||j(!!N)},[N,w,j]),mr(d,N,C),h.useEffect(()=>{N&&C&&requestAnimationFrame(()=>{var T;(T=v.current)==null||T.focus()})},[N,C]),N?w&&!C?null:e.jsx(wt,{open:C,onOpenChange:I,children:e.jsxs(qt,{children:[e.jsx(Ut,{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm"}),e.jsxs(Zt,{ref:f,className:"fixed inset-0 left-0 top-0 translate-x-0 translate-y-0 md:inset-auto md:left-[50%] md:top-[50%] md:translate-x-[-50%] md:translate-y-[-50%] w-full h-full md:w-[600px] md:h-[500px] lg:w-[800px] lg:h-[600px] p-0 flex flex-col overflow-hidden max-w-none md:max-w-[600px] lg:max-w-[800px] max-h-none md:max-h-[500px] lg:max-h-[600px] rounded-none md:rounded-xl z-50 border bg-background shadow-lg",onInteractOutside:()=>{I(!1)},onEscapeKeyDown:()=>{I(!1)},children:[e.jsxs(Ct,{children:[e.jsx(St,{children:c?p.championSelector.vsSelectOpponent:p.championSelector.selectChampion}),e.jsx(kt,{children:c?p.championSelector.vsSelectOpponentDescription:p.championSelector.selectChampionDescription})]}),c&&P&&e.jsxs("div",{className:"p-4 border-b-2 border-destructive/30 bg-destructive/5 flex items-center gap-3 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:X(P.version||"",P.id),alt:P.name,className:"w-10 h-10 rounded-full border-2 border-destructive/50"}),e.jsx("div",{className:"absolute -top-1 -right-1 bg-destructive rounded-full p-0.5",children:e.jsx(Le,{className:"h-3 w-3 text-white"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-semibold text-foreground",children:P.name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:p.championSelector.currentChampion})]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-destructive",children:[e.jsx(Le,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-semibold",children:"VS"})]})]}),e.jsxs("div",{className:E("p-4 border-b border-border flex items-center gap-2 shrink-0",c?"bg-muted/30":"bg-card"),children:[e.jsx(ke,{className:E("h-5 w-5 shrink-0",c?"text-destructive":"text-muted-foreground")}),e.jsx(Ge,{ref:v,type:"text",placeholder:c?p.championSelector.vsSearchPlaceholder:p.championSelector.searchPlaceholder,value:y,onChange:T=>{m(T.target.value),l(-1)},onKeyDown:z,className:"flex-1",autoFocus:!0}),e.jsx(ae,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0 hover:bg-muted hover:text-foreground",onClick:()=>I(!1),children:e.jsx(ve,{className:"h-4 w-4"})})]}),e.jsx("div",{ref:d,className:"overflow-y-auto overflow-x-hidden p-4 flex-1 min-h-0 md:flex-none md:w-[600px] md:h-[427px] lg:w-[800px] lg:h-[527px]",children:t?(c?A:S).length>0?e.jsxs(e.Fragment,{children:[c&&e.jsx("div",{className:"mb-3 pb-2 border-b border-destructive/20",children:e.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[e.jsx(Le,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-semibold",children:p.championSelector.selectOpponentLabel})]})}),e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10 gap-2",children:(c?A:S).map((T,V)=>{const D=o===V,L=c?!1:k.has(T.id);return e.jsx("div",{"data-champion-item":!0,className:E(D&&"ring-2 ring-offset-1 rounded-md",c?"ring-destructive":"ring-primary"),children:e.jsx(mt,{addChampion:R=>M(R),data:T,name:T.name,selected:L,thumbnailSrc:X(T.version||"",T.id)})},T.id)})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground min-h-[200px] space-y-2",children:[e.jsx(ke,{className:"h-12 w-12 opacity-50"}),e.jsx("p",{className:"text-base font-medium",children:y?p.championSelector.noResults:p.championSelector.emptyList})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground min-h-[200px]",children:p.championSelector.loading})})]})]})}):e.jsxs("div",{ref:f,className:"w-full",children:[e.jsxs(ae,{onClick:()=>{j(!0),setTimeout(()=>{var T;return(T=v.current)==null?void 0:T.focus()},0)},variant:"ghost",className:E("w-full flex flex-col items-center justify-center space-y-2","text-muted-foreground hover:text-foreground","py-4 h-auto"),children:[e.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-dashed border-muted-foreground/30 flex items-center justify-center",children:e.jsx(ke,{className:"w-6 h-6"})}),e.jsx("span",{className:"text-sm font-medium",children:p.championSelector.selectChampion})]}),C&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 md:hidden",onClick:()=>{j(!1),m(""),document.body.style.overflow="",x()},"aria-hidden":"true"}),e.jsxs("div",{className:E("fixed inset-0 z-50 md:absolute md:inset-auto md:top-full md:left-0 md:right-0 md:mt-2 md:z-10 md:rounded-lg md:border md:border-border md:shadow-lg bg-card md:max-h-[60vh] flex flex-col",N&&"md:relative md:inset-0 md:mt-0 md:rounded-lg md:border md:shadow-lg"),children:[e.jsxs("div",{className:"p-4 border-b border-border flex items-center gap-2 sticky top-0 bg-card z-10",children:[e.jsx(ke,{className:"h-5 w-5 text-muted-foreground shrink-0"}),e.jsx(Ge,{ref:v,type:"text",placeholder:p.championSelector.searchPlaceholder,value:y,onChange:T=>{m(T.target.value),l(-1)},onKeyDown:z,className:"flex-1",autoFocus:!0}),e.jsx(ae,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0 hover:bg-muted hover:text-foreground",onClick:()=>{j(!1),m(""),document.body.style.overflow="",x()},children:e.jsx(ve,{className:"h-4 w-4"})})]}),e.jsx("div",{ref:d,className:"flex-1 overflow-auto p-4",style:{maxHeight:"calc(100vh - 120px)"},children:t?e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10 gap-2",children:S.map((T,V)=>{const D=o===V,L=k.has(T.id);return e.jsx("div",{"data-champion-item":!0,className:E(D&&"ring-2 ring-primary ring-offset-1 rounded-md"),children:e.jsx(mt,{addChampion:R=>M(R),data:T,name:T.name,selected:L,thumbnailSrc:X(T.version||"",T.id)})},T.id)})}):e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:p.championSelector.loading})})]})]})]})}const De=J.memo(fr);function Vt(t="ko_KR"){const r=ye(t);return[{key:"hp",label:r.stats.health,format:s=>Math.round(s)},{key:"hpperlevel",label:r.stats.healthPerLevel,format:s=>s.toFixed(1)},{key:"mp",label:r.stats.mana,format:s=>Math.round(s)},{key:"mpperlevel",label:r.stats.manaPerLevel,format:s=>s.toFixed(1)},{key:"movespeed",label:r.stats.movespeed,format:s=>Math.round(s)},{key:"armor",label:r.stats.armor,format:s=>Math.round(s)},{key:"armorperlevel",label:r.stats.armorPerLevel,format:s=>s.toFixed(1)},{key:"spellblock",label:r.stats.spellblock,format:s=>Math.round(s)},{key:"spellblockperlevel",label:r.stats.spellblockPerLevel,format:s=>s.toFixed(1)},{key:"attackdamage",label:r.stats.attackdamage,format:s=>Math.round(s)},{key:"attackdamageperlevel",label:r.stats.attackdamagePerLevel,format:s=>s.toFixed(1)},{key:"attackspeed",label:r.stats.attackspeed,format:s=>s.toFixed(3)},{key:"attackspeedperlevel",label:r.stats.attackspeedPerLevel,format:s=>`${(s*100).toFixed(1)}%`},{key:"attackrange",label:r.stats.attackrange,format:s=>Math.round(s)},{key:"crit",label:r.stats.crit,format:s=>`${(s*100).toFixed(1)}%`},{key:"critperlevel",label:r.stats.critPerLevel,format:s=>`${(s*100).toFixed(1)}%`},{key:"hpregen",label:r.stats.hpregen,format:s=>s.toFixed(1)},{key:"hpregenperlevel",label:r.stats.hpregenPerLevel,format:s=>s.toFixed(1)},{key:"mpregen",label:r.stats.mpregen,format:s=>s.toFixed(1)},{key:"mpregenperlevel",label:r.stats.mpregenPerLevel,format:s=>s.toFixed(1)}]}const he=["Q","W","E","R"];function xr({champions:t,version:r,championList:s,onAddChampion:n,onRemoveChampion:a,onReorderChampions:i}){const{t:u,lang:c}=Q(),[p,g]=h.useState(!1),b=Vt(c),w=qe(be(Ye,{activationConstraint:{distance:8}}),be(Ze,{coordinateGetter:Ue})),C=o=>{},j=o=>{const{active:l,over:f}=o;if(f&&l.id!==f.id&&i){const v=t.findIndex(N=>N.id===l.id),d=t.findIndex(N=>N.id===f.id);v!==-1&&d!==-1&&i(v,d)}},y=({champion:o,children:l,className:f})=>{const{setNodeRef:v,transform:d,transition:N,isDragging:x}=je({id:o.id,disabled:!0}),k={transform:d?Ne.Transform.toString(d):void 0,transition:x?N:void 0,opacity:x?.5:1};return e.jsx(_,{ref:v,style:k,className:f,children:l})},m=({champion:o,index:l})=>{const{attributes:f,listeners:v,setNodeRef:d,transform:N,transition:x,isDragging:S}=je({id:o.id}),P={transform:N?Ne.Transform.toString(N):void 0,transition:S?x:void 0,opacity:S?.5:1};return e.jsx(K,{ref:d,style:P,className:E("text-center p-1.5 text-[11px] font-semibold text-foreground w-[100px] min-w-[100px] select-none",l<t.length-1&&"border-r border-border/30",S&&"z-50"),children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-1.5 relative",children:[i&&e.jsx("button",{...f,...v,className:"cursor-grab active:cursor-grabbing p-1 opacity-60 hover:opacity-100 transition-opacity absolute -left-2 top-1/2 -translate-y-1/2","aria-label":"Drag to reorder",children:e.jsx(_e,{className:"h-4 w-4 text-muted-foreground"})}),e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:X(r,o.id),alt:o.name,className:"w-8 h-8 rounded-full"}),a&&e.jsx(ae,{variant:"ghost",size:"icon",className:E("absolute -top-1 -right-1 h-4 w-4 rounded-full","bg-destructive/90 hover:bg-destructive text-white","hover:scale-110 transition-transform","shadow-md"),onClick:A=>{A.stopPropagation(),a(o.id)},"aria-label":`Remove ${o.name}`,children:e.jsx(ve,{className:"h-2.5 w-2.5"})})]}),e.jsx("div",{className:"text-[10px] font-semibold leading-tight text-center break-words text-foreground",children:o.name})]})})};return e.jsxs("div",{className:"relative",children:[e.jsx(Je,{sensors:w,collisionDetection:Xe,onDragStart:C,onDragEnd:j,children:e.jsx("div",{className:"border border-border/30 rounded-lg overflow-hidden",children:e.jsxs(me,{className:"border-collapse table-fixed w-auto",children:[e.jsx(fe,{children:e.jsxs(q,{className:"border-b border-border/30 select-none",children:[e.jsx(K,{className:"text-left p-1.5 pl-2 text-[11px] font-semibold text-foreground sticky left-0 bg-card z-20 w-[90px] min-w-[90px] border-r border-border/30 select-none",style:{left:0},children:u.stats.label}),e.jsx(Qe,{items:t.map(o=>o.id),strategy:et,children:t.map((o,l)=>e.jsx(m,{champion:o,index:l},o.id))}),n&&e.jsx(K,{className:"text-center p-1.5 text-[11px] font-semibold text-foreground w-[100px] min-w-[100px] border-l border-border/30 select-none",children:e.jsxs(ae,{onClick:()=>g(!0),variant:"outline",className:"w-full flex flex-row items-center justify-center gap-2 p-1.5 h-auto border-2 border-dashed border-muted-foreground/30 hover:border-primary/50 hover:bg-muted/30 group",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-muted/30 flex items-center justify-center group-hover:bg-primary/10 transition-colors",children:e.jsx(Be,{className:"w-4 h-4 text-muted-foreground group-hover:text-primary transition-colors"})}),e.jsx("div",{className:"text-[10px] text-muted-foreground group-hover:text-primary transition-colors whitespace-nowrap",children:"추가"})]})})]})}),e.jsx(xe,{children:b.map(o=>{const l=t.map(d=>{var N;return((N=d.stats)==null?void 0:N[o.key])??0}),f=Math.max(...l),v=Math.min(...l);return e.jsxs(q,{className:"border-b border-border/30 hover:bg-muted/30 transition-colors",children:[e.jsx(_,{className:"p-1.5 pl-2 text-[11px] font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",style:{wordBreak:"keep-all",left:0},children:o.label}),t.map((d,N)=>{var P;const x=((P=d.stats)==null?void 0:P[o.key])??0,S=x===f&&f!==v,k=x===v&&f!==v;return e.jsx(y,{champion:d,className:E("p-1.5 text-[11px] text-center",N<t.length-1&&"border-r border-border/30",S&&"text-primary font-semibold",k&&"text-muted-foreground"),children:o.format(x)},d.id)}),n&&e.jsx(_,{className:"p-1.5 text-center border-l border-border/30",children:e.jsx("div",{className:"w-full h-full min-h-[24px]"})})]},o.key)})})]})})}),p&&n&&s&&e.jsx(De,{championList:s,selectedChampions:t,onSelect:o=>{n(o)},onClose:()=>g(!1)})]})}function pr({champions:t,version:r,vsMode:s}){const{t:n,lang:a}=Q(),i=Vt(a);if(s&&t.length===2){const u=s.championA,c=s.championB;return e.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:e.jsx("div",{className:"min-w-full",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"border border-border/30 rounded-lg overflow-hidden",children:e.jsxs(me,{className:"border-collapse table-fixed w-auto min-w-full",children:[e.jsx(fe,{children:e.jsxs(q,{className:"border-b border-border/30 select-none",children:[e.jsx(K,{className:"text-left p-1.5 pl-2 text-[10px] font-semibold text-foreground sticky left-0 bg-card z-20 w-[50px] min-w-[50px] border-r border-border/30 select-none",style:{left:0},children:n.stats.label}),e.jsx(K,{className:"text-center p-1.5 text-[10px] font-semibold text-foreground w-1/2 border-r border-border/30 select-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-0.5",children:[e.jsx("img",{src:X(r,u.id),alt:u.name,className:"w-6 h-6 rounded-full",draggable:"false"}),e.jsx("div",{className:"text-xs font-semibold leading-tight text-center text-foreground",children:u.name})]})}),e.jsx(K,{className:"text-center p-1.5 text-[10px] font-semibold text-foreground w-[40px] min-w-[40px] border-r border-border/30 bg-muted/20 select-none",children:e.jsx("div",{className:"text-[9px] font-bold",children:"VS"})}),e.jsx(K,{className:"text-center p-1.5 text-[10px] font-semibold text-foreground w-1/2 select-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-0.5",children:[e.jsx("img",{src:X(r,c.id),alt:c.name,className:"w-6 h-6 rounded-full",draggable:"false"}),e.jsx("div",{className:"text-xs font-semibold leading-tight text-center text-foreground",children:c.name})]})})]})}),e.jsx(xe,{children:i.map(p=>{var j,y;const g=((j=u.stats)==null?void 0:j[p.key])??0,b=((y=c.stats)==null?void 0:y[p.key])??0,w=Math.max(g,b),C=Math.min(g,b);return e.jsxs(q,{className:"border-b border-border/30 hover:bg-muted/30 transition-colors",children:[e.jsx(_,{className:"p-1.5 pl-2 text-[10px] font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",style:{wordBreak:"keep-all",left:0},children:p.label}),e.jsx(_,{className:E("p-1.5 text-[10px] text-center border-r border-border/30",g===w&&w!==C&&"text-primary font-semibold",g===C&&w!==C&&"text-muted-foreground"),children:p.format(g)}),e.jsx(_,{className:"p-1.5 border-r border-border/30 bg-muted/20 select-none"}),e.jsx(_,{className:E("p-1.5 text-[10px] text-center",b===w&&w!==C&&"text-primary font-semibold",b===C&&w!==C&&"text-muted-foreground"),children:p.format(b)})]},p.key)})})]})})})})})}return e.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:e.jsx("div",{className:"min-w-full",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"border border-border/30 rounded-lg overflow-hidden",children:e.jsxs(me,{className:"border-collapse table-fixed w-auto min-w-full",children:[e.jsx(fe,{children:e.jsxs(q,{className:"border-b border-border/30 select-none",children:[e.jsx(K,{className:"text-left p-1.5 pl-2 text-[11px] font-semibold text-foreground sticky left-0 bg-card z-20 w-[70px] min-w-[70px] border-r border-border/30 select-none",style:{left:0},children:n.stats.label}),t.map(u=>e.jsx(K,{className:"text-center p-1.5 text-[11px] font-semibold text-foreground w-full select-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-1",children:[e.jsx("img",{src:X(r,u.id),alt:u.name,className:"w-8 h-8 rounded-full",draggable:"false"}),e.jsx("div",{className:"text-sm font-semibold leading-tight text-center text-foreground",children:u.name})]})},u.id))]})}),e.jsx(xe,{children:i.map(u=>{const c=t.map(b=>{var w;return((w=b.stats)==null?void 0:w[u.key])??0}),p=Math.max(...c),g=Math.min(...c);return e.jsxs(q,{className:"border-b border-border/30 hover:bg-muted/30 transition-colors",children:[e.jsx(_,{className:"p-1.5 pl-2 text-[11px] font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",style:{wordBreak:"keep-all",left:0},children:u.label}),t.map(b=>{var y;const w=((y=b.stats)==null?void 0:y[u.key])??0,C=w===p&&p!==g,j=w===g&&p!==g;return e.jsx(_,{className:E("p-1.5 text-[11px] text-center",C&&"text-primary font-semibold",j&&"text-muted-foreground"),children:u.format(w)},b.id)})]},u.key)})})]})})})})})}async function gr(t,r,s){let n={},a=null;try{a=await Jt(t,s),n=a.spellDataMap}catch(i){O.warn(`Failed to load Community Dragon data for ${t}:`,i)}return r.map((i,u)=>{let c={};if(n[u.toString()])c=n[u.toString()];else{const p=i.id.replace(t,"");for(const g of Object.keys(n))if(g.toLowerCase().includes(p.toLowerCase())||g.toLowerCase().includes(i.id.toLowerCase())){c=n[g];break}}return{spell:i,communityDragonData:c,spellIndex:u,ddragonVersion:(a==null?void 0:a.ddragonVersion)??s,cdragonVersion:(a==null?void 0:a.cdragonVersion)??null}})}async function Pt(t,r){const s={},n=t.map(async a=>{if(!a.spells||a.spells.length===0){s[a.id]=[];return}try{s[a.id]=await gr(a.id,a.spells,r)}catch(i){O.warn(`Failed to get integrated spell data for ${a.id}:`,i),s[a.id]=a.spells.map((u,c)=>({spell:u,communityDragonData:{},spellIndex:c}))}});return await Promise.all(n),s}const ze={physicalDamage:{tag:"span",className:"text-red-600 dark:text-red-500 font-semibold"},magicDamage:{tag:"span",className:"text-blue-600 dark:text-blue-500 font-semibold"},trueDamage:{tag:"span",className:"text-yellow-600 dark:text-yellow-500 font-semibold"},status:{tag:"span",className:"text-purple-600 dark:text-purple-500"},lifeSteal:{tag:"span",className:"text-green-600 dark:text-green-500"},scaleAD:{tag:"span",className:"text-orange-600 dark:text-orange-500"},scaleAP:{tag:"span",className:"text-blue-600 dark:text-blue-400"},scaleArmor:{tag:"span",className:"text-orange-600 dark:text-orange-400"},scaleLevel:{tag:"span",className:"text-gray-600 dark:text-gray-400"},healing:{tag:"span",className:"text-green-600 dark:text-green-400"},speed:{tag:"span",className:"text-cyan-600 dark:text-cyan-500"},keywordMajor:{tag:"span",className:"text-yellow-600 dark:text-yellow-400 font-semibold"},keywordStealth:{tag:"span",className:"text-purple-600 dark:text-purple-400 font-semibold"},spellPassive:{tag:"span",className:"text-gray-600 dark:text-gray-500 italic"},spellActive:{tag:"span",className:"text-gray-900 dark:text-white font-semibold"},recast:{tag:"span",className:"text-yellow-600 dark:text-yellow-300"},damage:{tag:"span",className:"text-red-600 dark:text-red-400"},shield:{tag:"span",className:"text-blue-600 dark:text-blue-300"},mana:{tag:"span",className:"text-blue-600 dark:text-blue-400"},energy:{tag:"span",className:"text-yellow-600 dark:text-yellow-400"},health:{tag:"span",className:"text-red-600 dark:text-red-400"},cooldown:{tag:"span",className:"text-gray-600 dark:text-gray-300"},range:{tag:"span",className:"text-cyan-600 dark:text-cyan-400"},radius:{tag:"span",className:"text-purple-600 dark:text-purple-400"},width:{tag:"span",className:"text-indigo-600 dark:text-indigo-400"},length:{tag:"span",className:"text-pink-600 dark:text-pink-400"},rules:{tag:"span",className:"text-gray-600 dark:text-gray-400 italic"}};function hr(t){let r=t;r=r.replace(/<font\s+color=['"]([^'"]+)['"]\s*>/gi,'<span style="color: $1">'),r=r.replace(/<\/font>/gi,"</span>"),Object.entries(ze).forEach(([n,{tag:a,className:i}])=>{const u=new RegExp(`</${n}>`,"gi");r=r.replace(u,`</${a}>`);const c=new RegExp(`<${n}>`,"gi");r=r.replace(c,`<${a}${i?` class="${i}"`:""}>`)});const s=["keywordMajor","keywordStealth","rules","recast"];return s.forEach(n=>{r=r.replace(new RegExp(`</${n}>`,"gi"),"</span>"),n==="rules"?r=r.replace(new RegExp(`<${n}>`,"gi"),'<span class="text-gray-600 dark:text-gray-400 italic">'):n==="keywordStealth"?r=r.replace(new RegExp(`<${n}>`,"gi"),'<span class="text-purple-600 dark:text-purple-400 font-semibold">'):r=r.replace(new RegExp(`<${n}>`,"gi"),'<span class="text-yellow-600 dark:text-yellow-400 font-semibold">')}),r=r.replace(/<(\w+)(?![\\w])>/gi,(n,a)=>ze[a]||s.includes(a)||a==="font"||a==="br"?n:"<span>"),r=r.replace(/<\/(\w+)(?![\\w])>/gi,(n,a)=>ze[a]||s.includes(a)||a==="font"||a==="br"?n:"</span>"),r}function $t(t){const r=t.trim(),s=/^([a-zA-Z_][a-zA-Z0-9_]*)\s*([*+\/-])\s*(-?\d+(?:\.\d+)?)$/,n=r.match(s);if(n){const a=n[2];return{type:"formula",variable:n[1],operator:a,operand:parseFloat(n[3])}}return{type:"variable",variable:r}}function At(t,r,s){if(!r||typeof r!="string")return null;const n=Object.entries(t).find(([p])=>p!=null&&p.toLowerCase()===r.toLowerCase());if(!n)return null;const[,a]=n,i=a.slice(1,s+1);if(i.length===0)return null;const u=i[0];return i.every(p=>p===u)?u:i}function Et(t,r){if(r.type!=="formula"||!r.operator||r.operand==null)return t;const{operator:s,operand:n}=r;return s==="*"?Array.isArray(t)?t.map(a=>a*n):t*n:s==="+"?Array.isArray(t)?t.map(a=>a+n):t+n:s==="-"?Array.isArray(t)?t.map(a=>a-n):t-n:s==="/"?Array.isArray(t)?t.map(a=>a/n):t/n:t}function ce(t){if(t==null||t==="")return"";const r=typeof t=="number"?t:parseFloat(String(t));return isNaN(r)?String(t):r%1===0?r.toString():parseFloat(r.toFixed(3)).toString()}function xt(t,r,s=!1){if(!t||t.length===0)return"";const n=s&&t.length>1?1:0,i=t.slice(n).filter(b=>b!=null&&b!==""&&b!=="0");if(i.length===0)return"";const u=r?i.slice(0,r):i;if(u.length===0)return"";const c=u.map(b=>ce(b)),p=c[0];return c.every(b=>b===p)?p:c.join("/")}function br(t){let r=t;return r=r.replace(/<br\s*\/?>/gi,"<br />"),r=r.replace(/[^\S\r\n]+/g," "),r}function Y(t){return Array.isArray(t)}function pt(t,r){return Array.isArray(t)?t:Array.from({length:r},()=>t)}function Lt(t,r,s){if(!Y(t)&&!Y(r))return s(t,r);const n=Y(t)?t:pt(t,Y(r)?r.length:1),a=Y(r)?r:pt(r,n.length);if(n.length!==a.length)throw new Error(`Vector length mismatch: ${n.length} vs ${a.length}`);return n.map((i,u)=>s(i,a[u]))}function Ce(t,r){return Lt(t,r,(s,n)=>s+n)}function Se(t,r){return Lt(t,r,(s,n)=>s*n)}function Re(t){return Y(t)?t.every(s=>s===t[0])?ce(t[0]):t.map(s=>ce(s)).join("/"):ce(t)}function Oe(t){return Y(t)?t.map(r=>r*100):t*100}function gt(t,r,s="ko_KR"){const n=ye(s),a=t!=null,i=r!=null;if(!a&&!i)return n.stats.abilityPower;const u=t??r;return u===2?t===2&&r===2?n.stats.bonusAttackDamage:n.stats.attackDamage:u===12?t===12&&r===2?n.stats.bonusHealth:n.stats.health:u===1?t===1&&r===2?n.stats.bonusArmor:n.stats.armor:u===6?t===6&&r===2?n.stats.bonusMagicResist:n.stats.magicResist:u===18?t===18&&r===2?n.stats.bonusLifesteal:n.stats.lifesteal:""}function Rt(t,r,s){const n=s==null?void 0:s.DataValues;if(!n)return null;const a=At(n,t.variable,r.maxrank);if(a==null)return null;const i=Et(a,t);return Re(i)}function ht(t,r){const s=n=>Number.isFinite(n)?n.toFixed(r).replace(/\.?0+$/,""):String(n);if(Y(t)){const n=t.map(u=>s(u)),a=n[0];return n.every(u=>u===a)?a:n.join("/")}return s(t)}function jr(t,r,s,n="ko_KR"){const a=s==null?void 0:s.mSpellCalculations,i=s==null?void 0:s.DataValues;if(!a)return null;const u=Object.entries(a).find(([d])=>d!=null&&d.toLowerCase()===t.variable.toLowerCase());if(!u)return null;const[c]=u;function p(d){if(!d||typeof d!="string")return O.debug(`DataValue name is invalid: ${d}`),null;if(!i)return O.debug("dataValues is undefined"),null;const N=At(i,d,r.maxrank);return N??(O.debug(`DataValue "${d}" missing`),null)}function g(d,N=new Set){var S;if(!a)throw new Error("spellCalcs is undefined");const x=a[d];if(!x)throw new Error(`SpellCalculation "${d}" not found`);if(N.has(d))throw new Error(`Circular reference in mSpellCalculations: ${d}`);if(N.add(d),x.__type==="GameCalculationModified"){const k=x;if(!k.mModifiedGameCalculation)throw new Error("mModifiedGameCalculation is missing");const P=g(k.mModifiedGameCalculation,N);if(!k.mMultiplier)return P;let A=null;if(k.mMultiplier.mDataValue){if(A=p(k.mMultiplier.mDataValue),A==null)return P}else k.mMultiplier.mNumber!=null&&(A=k.mMultiplier.mNumber);if(A==null)return P;const B=Se(P.base,A),I=P.statParts.map(M=>({name:M.name,ratio:Se(M.ratio,A)}));return{base:B,statParts:I,isPercent:P.isPercent,precision:P.precision}}if(x.__type==="GameCalculation"){const k=x,P=k.mFormulaParts??[];let A=0;const B=[],I=!!k.mDisplayAsPercent;if(P.length===1&&P[0].__type==="ByCharLevelBreakpointsCalculationPart"&&k.mSimpleTooltipCalculationDisplay===6){const V=P[0],D=V.mLevel1Value??0;let L=D;for(const G of V.mBreakpoints??[])typeof G.mAdditionalBonusAtThisLevel=="number"&&(L+=G.mAdditionalBonusAtThisLevel);return{base:[D,L],statParts:[],isPercent:I,isBreakpointRange:!0,precision:void 0}}if(P.length===1&&P[0].__type==="ByCharLevelBreakpointsCalculationPart"&&I){const V=P[0],D=V.mLevel1Value??0,L=V.mInitialBonusPerLevel??0,R=(V.mBreakpoints??[])[0];if(L!==0&&(R!=null&&R.mLevel)){const F=R.mLevel-1,G=Math.max(F-1,0),ee=D+G*L;return{base:[D,ee],statParts:[],isPercent:!0,isCharLevelRange:!0,precision:void 0}}}if(P.length===1&&P[0].__type==="ByCharLevelInterpolationCalculationPart"&&I){const V=P[0],D=V.mStartValue??0,L=V.mEndValue??D;return{base:[D,L],statParts:[],isPercent:!0,isCharLevelRange:!0,precision:void 0}}for(const V of P){const D=V.__type;if(D==="NamedDataValueCalculationPart"){const L=V;if(!L.mDataValue){O.debug("NamedDataValueCalculationPart missing mDataValue",V);continue}const R=p(L.mDataValue);if(R==null)continue;A=Ce(A,R)}else if(D==="EffectValueCalculationPart"){const R=V.mEffectIndex??0,F=((S=r.effectBurn)==null?void 0:S[R])??null;if(!F)O.debug(`EffectValueCalculationPart: effectBurn[${R}] is missing`,{spellId:r.id});else{const G=F.split("/").map(ee=>parseFloat(ee)).filter(ee=>!Number.isNaN(ee));if(G.length>0){const ee=G.length>r.maxrank?G.slice(0,r.maxrank):G;A=Ce(A,ee)}}}else if(D==="StatByNamedDataValueCalculationPart"){const L=V;if(!L.mDataValue){O.debug("StatByNamedDataValueCalculationPart missing mDataValue",V);continue}const R=p(L.mDataValue);if(R==null)continue;const F=gt(L.mStat,L.mStatFormula,n);B.push({name:F,ratio:R})}else if(D==="StatByCoefficientCalculationPart"){const L=V;if(L.mCoefficient==null){O.debug("StatByCoefficientCalculationPart missing mCoefficient",V);continue}const R=gt(L.mStat,L.mStatFormula,n),F=L.mCoefficient;B.push({name:R,ratio:F,isCoefficient:!0})}else if(D==="AbilityResourceByCoefficientCalculationPart"){const L=V;if(L.mCoefficient==null){O.debug("AbilityResourceByCoefficientCalculationPart missing mCoefficient",V);continue}const R=ye(n);let F=R.common.mana;if(r.costType){const ne=r.costType.trim();ne&&!ne.includes("{{")?F=ne:r.resource&&!r.resource.includes("{{")&&(F=r.resource)}else r.resource&&!r.resource.includes("{{")&&(F=r.resource);const ee=L.mStatFormula===2?`${R.common.bonus} ${F}`:F,te=L.mCoefficient;B.push({name:ee,ratio:te,isCoefficient:!0})}else if(D==="NumberCalculationPart"){const R=V.mNumber??0;A=Ce(A,R)}else if(D==="ByCharLevelBreakpointsCalculationPart"){const L=V;let R=L.mLevel1Value||0;for(const F of L.mBreakpoints??[])F.mAdditionalBonusAtThisLevel!=null&&(R+=F.mAdditionalBonusAtThisLevel);A=Ce(A,R)}else if(D==="ProductOfSubPartsCalculationPart"){const L=V,R=te=>{var Te;if(!te||!te.__type)return 0;const ne=te.__type;if(ne==="NamedDataValueCalculationPart"){const pe=te;if(!pe.mDataValue)return O.debug("ProductOfSubPartsCalculationPart: NamedDataValueCalculationPart missing mDataValue",te),0;const H=p(pe.mDataValue);return H??0}if(ne==="NumberCalculationPart")return te.mNumber??0;if(ne==="EffectValueCalculationPart"){const H=te.mEffectIndex??0,re=((Te=r.effectBurn)==null?void 0:Te[H])??null;if(!re)return O.debug(`ProductOfSubPartsCalculationPart: EffectValueCalculationPart missing effectBurn[${H}]`,{spellId:r.id}),0;let ge;if(re.includes("/")){const oe=re.split("/").map(we=>Number.parseFloat(we)).filter(we=>!Number.isNaN(we));if(oe.length===0)return 0;ge=oe.length===1?oe[0]:oe}else{const oe=Number.parseFloat(re);if(Number.isNaN(oe))return 0;ge=oe}return ge}return O.debug(`ProductOfSubPartsCalculationPart: unsupported sub part type "${ne}"`,te),0},F=R(L.mPart1),G=R(L.mPart2),ee=Se(F,G);A=Ce(A,ee)}}let M=A,z=B;if(k.mMultiplier){let V=null;k.mMultiplier.mDataValue?(V=p(k.mMultiplier.mDataValue),V==null&&(V=null)):k.mMultiplier.mNumber!=null&&(V=k.mMultiplier.mNumber),V!=null&&(M=Se(M,V),z=z.map(D=>({...D,ratio:Se(D.ratio,V)})))}let T;return typeof k.mPrecision=="number"&&k.mPrecision>=0?T=k.mPrecision+1:T=void 0,{base:M,statParts:z,isPercent:I,precision:T}}throw new Error(`Unsupported mSpellCalculation type: ${x.__type}`)}let b;try{b=g(c)}catch(d){return O.error("Failed to evaluate calculation:",d),null}let w;const C=b.precision;b.isPercent?C!=null?Y(b.base)?w=b.base.map(d=>d*100):w=b.base*100:w=Oe(b.base):w=b.base;const j=b.statParts.map(d=>{if(d.isCoefficient){const N=C!=null?Y(d.ratio)?d.ratio.map(x=>x*100):d.ratio*100:Oe(d.ratio);return{...d,ratio:N}}if(C!=null){const N=Y(d.ratio)?d.ratio.map(x=>x*100):d.ratio*100;return{...d,ratio:N}}return{...d,ratio:Oe(d.ratio)}});let y=null;const m=Y(w)&&w.length>0&&w.every(d=>d===0),o=!Y(w)&&w===0;if(!m&&!o)if(b.isCharLevelRange&&Y(w)&&w.length===2){const[d,N]=w,x=ce(d),S=ce(N);y=`(${x}% ~ ${S}%)`}else if(b.isBreakpointRange&&Y(w)&&w.length===2){const[d,N]=w,x=ce(d),S=ce(N);y=b.isPercent?`(${x}% ~ ${S}%)`:`(${x} ~ ${S})`}else{const d=C!=null?ht(w,C):Re(w);y=b.isPercent?`${d}%`:d}const l=j.map(d=>{const N=C!=null?ht(d.ratio,C):Re(d.ratio);return d.name?`(${N}% ${d.name})`:`(${N}%)`}),f=[];if(y&&f.push(y),f.push(...l),f.length===0)return null;const v=f.join(" + ");return f.length===1?v:`(${v})`}function Nr(t,r){return!Number.isFinite(r)||r<0?t:t.replace(/-?\d+(?:\.\d+)?/g,s=>{const n=Number.parseFloat(s);return Number.isFinite(n)?n.toFixed(r):s})}function Bt(t,r,s,n="ko_KR"){if(!r)return t;let a=t;a=a.replace(/(}})\s*\+\s*(\S)/g,"$1 + $2").replace(/(\S)\s*\+\s*({{)/g,"$1 + $2").replace(/(\S)\s*~\s*(\S)/g,"$1 ~ $2"),a=a.replace(/\{\{([^}]*\{\{[^}]*}}[^}]*)}}/g,()=>""),a=a.replace(/\{\{Spell_[^}]*Tooltip[^}]*}}/gi,""),a=a.replace(/\{\{spellmodifierdescriptionappend}}/gi,"");const i=/\{\{([^}]+)}}/g;return a=a.replace(i,(u,c)=>{const p=c.trim();if(p==="spellmodifierdescriptionappend"||p.includes("gamemodeinteger")||p.includes("Spell_")&&p.includes("Tooltip"))return"";let g=p,b;const w=/^([a-zA-Z_][a-zA-Z0-9_]*)(?:\.(\d+))(.*)$/.exec(p);if(w){const[,j,y,m]=w,o=Number.parseInt(y,10);Number.isFinite(o)&&(b=o,g=`${j}${m}`)}const C=vr(g,r,s,n);return C!==null?b!==void 0?Nr(C,b):C:""}),a=a.replace(/\{\{\s*\}/g,""),a=a.replace(/\}\}/g,""),a=a.replace(/\{\{/g,""),a=a.replace(/%[^\s:%]+:[^\s%]+%/g,""),a=a.replace(/\s+%\s+/g," "),a=a.replace(new RegExp("(?<!\\d)\\s*%\\s*(?!\\d)","g"),""),a=a.replace(/^\s*%\s*(?!\d)/g,""),a=a.replace(new RegExp("(?<!\\d)\\s*%\\s*$","g"),""),a=a.replace(/[^\S\r\n]+/g," "),a}function vr(t,r,s,n="ko_KR"){const a=$t(t),i=yr(a,r,s);if(i!==null)return i;const u=Rt(a,r,s);return u!==null?u:jr(a,r,s,n)}function yr(t,r,s){const n=t.variable,a=/^e(\d+)$/i.exec(n);if(!a)return null;const i=Number.parseInt(a[1],10);if(!Number.isFinite(i)||i<=0)return null;const u=(s==null?void 0:s.effectBurn)??r.effectBurn;if(!u)return null;const c=u[i];if(!c)return null;let p;if(c.includes("/")){const b=c.split("/").map(w=>Number.parseFloat(w)).filter(w=>!Number.isNaN(w));if(b.length===0)return null;p=b.length===1?b[0]:b}else{const b=Number.parseFloat(c);if(Number.isNaN(b))return null;p=b}const g=Et(p,t);return Re(g)}function Ke(t,r,s,n="ko_KR"){if(!t)return"";let a=t;return a=hr(a),a=Bt(a,r,s,n),a=br(a),a=a.replace(/\n/g,"<br />"),a}function bt(t,r,s="ko_KR"){const n=ye(s);if(!t.leveltip||!t.leveltip.label||!t.leveltip.effect)return"";let a;r&&(r.DataValues?a=r:a={DataValues:r});const{label:i,effect:u}=t.leveltip,c=[];for(let p=0;p<i.length&&p<u.length;p++){const g=i[p],w=u[p].match(/\{\{\s*([^}]+)\s*\}\}/);if(!w)continue;const C=w[1].trim();let j=null;if(a)try{const o=$t(C),l=Rt(o,t,a);if(l&&l.trim()!==""){let f=l;(g.includes("%")||g.toLowerCase().includes("percent")||g.toLowerCase().includes("퍼센트")||g.toLowerCase().includes("둔화"))&&!f.includes("%")&&(f=f.split("/").map(x=>x&&`${x}%`).join("/"));let d=n.common.mana;if(t.costType){const x=t.costType.trim();x&&!x.includes("{{")?d=x:t.resource&&!t.resource.includes("{{")&&(d=t.resource)}else t.resource&&!t.resource.includes("{{")&&(d=t.resource);const N=g.replace("@AbilityResourceName@",d);if(N.includes("{{")||N.includes("}}"))continue;c.push(`${N}: [${f}]`);continue}}catch{}const y=C;j=null;const m=y.match(/^e(\d+)$/i);if(m){const o=parseInt(m[1]);if(t.effectBurn&&t.effectBurn.length>o){const l=t.effectBurn[o];l&&l!==null&&l!=="0"&&(j=l)}}else if(y.toLowerCase()==="cost"||y.toLowerCase().includes("cost"))t.costBurn&&(j=t.costBurn);else if(y.toLowerCase().includes("cooldown"))t.cooldownBurn&&(j=t.cooldownBurn);else if(y.toLowerCase().includes("ammorechargetime")||y.toLowerCase().includes("ammorecharge")){const o=(r==null?void 0:r.DataValues)||r;if(o&&o.mAmmoRechargeTime){const l=o.mAmmoRechargeTime;if(Array.isArray(l)&&l.length>1){const v=l.slice(1).map(N=>typeof N=="number"?N:parseFloat(String(N))),d=xt(v,t.maxrank,!1);d&&(j=d)}}}if(j){const o=xt(j.includes("/")?j.split("/"):[j],t.maxrank);if(o){let l=n.common.mana;if(t.costType){const d=t.costType.trim();d&&!d.includes("{{")?l=d:t.resource&&!t.resource.includes("{{")&&(l=t.resource)}else t.resource&&!t.resource.includes("{{")&&(l=t.resource);const f=g.replace("@AbilityResourceName@",l);if(f.includes("{{")||f.includes("}}"))continue;let v=o;(g.includes("%")||g.toLowerCase().includes("slow")||g.toLowerCase().includes("둔화"))&&(o.includes("%")||(v=o.split("/").map(d=>`${d}%`).join("/"))),c.push(`${f}: [${v}]`)}}}return c.length===0?"":c.join("<br />")}function wr(t,r,s="ko_KR"){var c,p;const n=ye(s);if(!t||!t.cooldown||!Array.isArray(t.cooldown)||t.cooldown.length===0)return null;const a=((c=r==null?void 0:r.communityDragonData)==null?void 0:c.DataValues)||(r==null?void 0:r.communityDragonData),i=a==null?void 0:a.mAmmoRechargeTime;if(t.cooldown[0]===0&&i&&Array.isArray(i)&&i.length>1&&i){const g=i[1],b=((p=t.effectBurn)==null?void 0:p[1])||"3";return`${n.common.rechargeTime} ${g}${n.common.seconds} (${n.common.max}: ${b}${n.common.items})`}if(t.cooldownBurn){const g=t.cooldownBurn.split("/");return g.length>1&&g.every(b=>b===g[0])?`${g[0]}${n.common.seconds}`:`${t.cooldownBurn}${n.common.seconds}`}if(t.cooldown&&t.cooldown.length>0){const g=t.cooldown[0];return t.cooldown.every(b=>b===g)?`${g}${n.common.seconds}`:`${t.cooldown.join("/")}${n.common.seconds}`}return null}function ue(t){if(!t)return t;let r=t.replace(/\(\s*\)/g,"");return r=r.replace(/\s{2,}/g," ").trim(),r}function Cr(t,r,s="ko_KR"){var c;const n=ye(s);if(!t)return null;const a=Array.isArray(t.cost)&&t.cost.length>0,i=a&&t.cost.every(p=>p===0),u=t.costBurn==="0";if((u||i)&&typeof t.resource=="string"&&t.resource.includes("{{")){const p=t.resource.trim(),g=((c=r==null?void 0:r.communityDragonData)==null?void 0:c.DataValues)||(r==null?void 0:r.communityDragonData);if(g){const w=Bt(p,t,{DataValues:g}).trim();if(w)return ue(w)}return ue(n.common.noCost)}if(u||i)return ue(n.common.noCost);if(t.costBurn){const p=t.costBurn.split("/");return p.length>1&&p.every(g=>g===p[0])?ue(`${n.common.mana} ${p[0]}`):ue(`${n.common.mana} ${t.costBurn}`)}if(a){const p=t.cost[0];return t.cost.every(g=>g===p)?ue(`${n.common.mana} ${p}`):ue(`${n.common.mana} ${t.cost.join("/")}`)}return null}function _t(t,r,s){var c;const n=((c=s==null?void 0:s.communityDragonData)==null?void 0:c.DataValues)||(s==null?void 0:s.communityDragonData),a=n==null?void 0:n.mAmmoRechargeTime,i=t.cooldown[r-1];return i===0&&a&&Array.isArray(a)&&a.length>r&&a?a[r]!==void 0?String(a[r]):"":i!=null?String(i):""}function ie({skill:t,skillIdx:r,version:s,spellData:n,isPassive:a,passiveName:i,passiveDescription:u,passiveImageFull:c,size:p="default"}){const{t:g,lang:b}=Q(),C=tt()==="mobile",[j,y]=J.useState(!1),m=J.useRef(null),o=a&&c?null:wr(t,n,b),l=a&&c?null:Cr(t,n,b),f=p==="small",v=f?"min-w-6 min-h-6 w-6 h-6":"min-w-8 min-h-8 w-8 h-8",d=f?"text-[8px]":"text-[9px]",N=e.jsx("div",{ref:m,className:`flex flex-col items-center gap-0.5 p-1 -m-1 touch-manipulation ${C?"cursor-pointer":"cursor-help"}`,onClick:S=>{C&&(S.stopPropagation(),y(k=>!k))},onTouchStart:S=>{C&&(S.stopPropagation(),y(k=>!k))},children:a&&c?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:Xt(s,c),alt:"Passive",className:E(v,"rounded")}),e.jsx("span",{className:E(d,"font-semibold"),children:"P"})]}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:ot(s,t.id),alt:he[r],className:E(v,"rounded")}),e.jsx("span",{className:E(d,"font-semibold"),children:he[r]})]})}),x=()=>a&&c?e.jsxs(e.Fragment,{children:[i&&e.jsx("div",{className:`font-semibold text-sm ${C?"pr-10":""}`,children:i}),u&&e.jsx("div",{className:"text-xs leading-relaxed",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:Ke(u,void 0,void 0,b)}})}),e.jsxs("div",{className:"text-xs text-muted-foreground leading-relaxed border-t pt-3 mt-3 flex items-start gap-1.5",children:[e.jsx(ut,{className:"w-3 h-3 mt-0.5 text-yellow-600 dark:text-yellow-500 flex-shrink-0"}),e.jsx("span",{children:g.skillTooltip.warningPassive})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`flex items-start gap-3 border-b pb-3 ${C?"pr-10":""}`,children:[e.jsx("img",{src:ot(s,t.id),alt:he[r],className:"w-12 h-12 min-w-12 min-h-12 rounded flex-shrink-0"}),e.jsx("div",{className:"flex-1 min-w-0",children:t.name&&e.jsxs("div",{className:"font-semibold text-sm",children:["[",he[r],"] ",t.name]})}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[o&&e.jsx("div",{className:"text-xs text-muted-foreground",children:o.includes(" (")?e.jsxs(e.Fragment,{children:[o.split(" (")[0],e.jsx("br",{}),"(",o.split(" (")[1]]}):o}),l&&e.jsx("div",{className:"text-xs text-muted-foreground mt-1 whitespace-nowrap",children:l})]})]}),t.description&&e.jsx("div",{className:"text-xs leading-relaxed",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:Ke(t.description,t,n==null?void 0:n.communityDragonData,b).replace(/<br\s*\/?>/gi," ")}})}),t.tooltip&&e.jsx("div",{className:"text-xs text-muted-foreground leading-relaxed",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:Ke(t.tooltip,t,n==null?void 0:n.communityDragonData,b)}})}),n&&bt(t,n.communityDragonData,b)&&e.jsx("div",{className:"text-[11px] leading-relaxed text-muted-foreground border-t pt-3 mt-3",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:bt(t,n.communityDragonData,b)}})}),e.jsxs("div",{className:"text-xs text-muted-foreground leading-relaxed border-t pt-3 mt-3 flex items-start gap-1.5",children:[e.jsx(ut,{className:"w-3 h-3 mt-0.5 text-yellow-600 dark:text-yellow-500 flex-shrink-0"}),e.jsx("span",{children:g.skillTooltip.warningSkill})]})]});return C?e.jsxs(e.Fragment,{children:[N,e.jsx(wt,{open:j,onOpenChange:y,children:e.jsxs(Qt,{className:"w-[calc(100vw-32px)] max-w-lg h-[70vh] max-h-[70vh] p-0 rounded-xl overflow-hidden flex flex-col",children:[e.jsxs(Ct,{children:[e.jsx(St,{children:a&&c?`${i||g.skillTooltip.passive} ${g.skillTooltip.skillInfo}`:`[${he[r]}] ${t.name||g.skillTooltip.skill} ${g.skillTooltip.skillInfo}`}),e.jsx(kt,{children:a&&c?`${i||g.skillTooltip.passive} ${g.skillTooltip.skillDescription}`:`[${he[r]}] ${t.name||g.skillTooltip.skill} ${g.skillTooltip.skillDescription}`})]}),e.jsx(Tt,{className:"flex-1 min-h-0",children:e.jsx("div",{className:"p-4 flex flex-col gap-3",children:x()})})]})})]}):a&&c?e.jsxs(lt,{children:[e.jsx(it,{asChild:!0,children:N}),e.jsx(ct,{side:"top",align:"center",sideOffset:8,className:"max-w-xs p-3 space-y-2",children:x()})]}):e.jsxs(lt,{children:[e.jsx(it,{asChild:!0,children:N}),e.jsx(ct,{side:"top",align:"center",sideOffset:8,className:"max-w-sm p-4 space-y-3",children:x()})]})}const Dt=h.createContext(void 0);function Sr({initialDDragonVersion:t=null,initialCDragonVersion:r=null,children:s}){const[n,a]=h.useState(t??null),[i,u]=h.useState(r??null),c=h.useMemo(()=>({ddragonVersion:n,cdragonVersion:i,setDDragonVersion:a,setCDragonVersion:u}),[n,i]);return e.jsx(Dt.Provider,{value:c,children:s})}function nt(){const t=h.useContext(Dt);if(!t)throw new Error("useVersionContext must be used within VersionProvider");return t}function kr({champions:t,version:r,championList:s,onAddChampion:n,onRemoveChampion:a,onReorderChampions:i,vsMode:u}){const{t:c}=Q(),{cdragonVersion:p,setCDragonVersion:g}=nt(),[b,w]=h.useState(!1),[C,j]=J.useState({}),y=qe(be(Ye,{activationConstraint:{distance:8}}),be(Ze,{coordinateGetter:Ue})),m=x=>{},o=x=>{const{active:S,over:k}=x;if(k&&S.id!==k.id&&i){const P=t.findIndex(B=>B.id===S.id),A=t.findIndex(B=>B.id===k.id);P!==-1&&A!==-1&&i(P,A)}};J.useEffect(()=>{const x=async()=>{try{const S=await Pt(t,r);if(j(S),!p)try{let k=null;for(const P of Object.keys(S)){const A=S[P];if(A&&A.length>0&&(k=A[0].cdragonVersion??null,k))break}k&&g(k)}catch(k){O.warn("Failed to extract CDragon version from integrated spell data:",k)}}catch(S){O.warn("Failed to load integrated spell data:",S),j({})}};t.length>0&&x()},[t,r]);const l=J.useMemo(()=>Math.max(...t.map(x=>x.spells?Math.max(...x.spells.map(S=>S.maxrank)):0)),[t]),f=J.useCallback((x,S)=>{const k=C[x];return!k||k.length<=S?null:k[S]},[C]),v=J.useMemo(()=>Array.from({length:l},(x,S)=>{const k=S+1;return{level:k,skills:t.map(P=>P.spells?P.spells.map((A,B)=>{const I=f(P.id,B),M=_t(A,k,I);return{skill:A,cooldown:M}}):null)}}),[t,l,f]),d=({champion:x,children:S,className:k})=>{const{setNodeRef:P,transform:A,transition:B,isDragging:I}=je({id:x.id,disabled:!0}),z={transform:A?Ne.Transform.toString(A):void 0,transition:I?B:void 0,opacity:I?.5:1};return e.jsx(_,{ref:P,style:z,className:k,children:S})},N=({champion:x,index:S})=>{const{attributes:k,listeners:P,setNodeRef:A,transform:B,transition:I,isDragging:M}=je({id:x.id}),T={transform:B?Ne.Transform.toString(B):void 0,transition:M?I:void 0,opacity:M?.5:1};return e.jsx(K,{ref:A,style:T,className:E("text-center p-2 text-xs font-semibold text-foreground w-[220px] lg:w-[240px] min-w-[200px] lg:min-w-[220px] select-none",S<t.length-1&&"border-r border-border/30",M&&"z-50"),children:e.jsxs("div",{className:"flex flex-row items-center justify-center gap-2 relative",children:[i&&e.jsx("button",{...k,...P,className:"cursor-grab active:cursor-grabbing p-1 opacity-60 hover:opacity-100 transition-opacity -ml-1","aria-label":"Drag to reorder",children:e.jsx(_e,{className:"h-4 w-4 text-muted-foreground"})}),e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:X(r,x.id),alt:x.name,className:"w-8 h-8 rounded-full"}),a&&e.jsx(ae,{variant:"ghost",size:"icon",className:E("absolute -top-1 -right-1 h-4 w-4 rounded-full","bg-destructive/90 hover:bg-destructive text-white","hover:scale-110 transition-transform","shadow-md"),onClick:V=>{V.stopPropagation(),a(x.id)},"aria-label":`Remove ${x.name}`,children:e.jsx(ve,{className:"h-2.5 w-2.5"})})]}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("div",{className:"text-[11px] font-semibold leading-tight text-foreground",children:x.name}),e.jsx("div",{className:"text-[9px] text-muted-foreground leading-tight",children:x.title})]})]})})};return e.jsx(He,{delayDuration:0,skipDelayDuration:150,children:e.jsxs("div",{className:"relative",children:[e.jsx(Je,{sensors:y,collisionDetection:Xe,onDragStart:m,onDragEnd:o,children:e.jsx("div",{className:"border border-border/30 rounded-lg overflow-hidden",children:e.jsxs(me,{className:"border-collapse table-fixed w-auto",children:[e.jsx(fe,{children:e.jsxs(q,{className:"border-b border-border/30 select-none",children:[e.jsx(K,{className:"text-left p-2 pl-3 text-xs font-semibold text-foreground sticky left-0 bg-card z-20 w-[80px] min-w-[80px] border-r border-border/30 select-none",style:{left:0},children:c.common.level}),e.jsx(Qe,{items:t.map(x=>x.id),strategy:et,children:t.map((x,S)=>e.jsx(N,{champion:x,index:S},x.id))}),n&&e.jsx(K,{className:"text-center p-2 text-xs font-semibold text-foreground w-[220px] lg:w-[240px] min-w-[200px] lg:min-w-[220px] border-l border-border/30 select-none",children:e.jsxs(ae,{onClick:()=>w(!0),variant:"outline",className:"w-full flex flex-row items-center justify-center gap-2 p-1.5 h-auto border-2 border-dashed border-muted-foreground/30 hover:border-primary/50 hover:bg-muted/30 group",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-muted/30 flex items-center justify-center group-hover:bg-primary/10 transition-colors",children:e.jsx(Be,{className:"w-4 h-4 text-muted-foreground group-hover:text-primary transition-colors"})}),e.jsx("div",{className:"text-[10px] text-muted-foreground group-hover:text-primary transition-colors whitespace-nowrap",children:"추가"})]})})]})}),e.jsxs(xe,{children:[e.jsxs(q,{className:"border-b-2 border-border/30 bg-muted/30 select-none",children:[e.jsx(_,{className:"p-2 pl-3 text-xs font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",style:{left:0},children:c.skills.label}),t.map((x,S)=>{var k;return e.jsx(d,{champion:x,className:E("p-2",S<t.length-1&&"border-r border-border/30"),children:e.jsxs("div",{className:"flex justify-center gap-1.5",children:[x.passive&&e.jsx(ie,{isPassive:!0,passiveName:x.passive.name,passiveDescription:x.passive.description,passiveImageFull:x.passive.image.full,skill:{},skillIdx:0,version:r}),(k=x.spells)==null?void 0:k.map((P,A)=>{const B=f(x.id,A);return e.jsx(ie,{skill:P,skillIdx:A,version:r,spellData:B},P.id)})]})},x.id)}),n&&e.jsx(_,{className:"p-2 text-center border-l border-border/30",children:e.jsx("div",{className:"w-full h-full min-h-[32px]"})})]}),v.map((x,S)=>e.jsxs(q,{className:"border-b border-border/30 hover:bg-muted/30 transition-colors",children:[e.jsxs(_,{className:E("p-2 pl-3 text-xs font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",S===v.length-1&&"rounded-bl-lg"),style:{left:0},children:[x.level,c.common.level]}),x.skills.map((k,P)=>{const A=t[P];return e.jsx(d,{champion:A,className:E("p-2",P<t.length-1&&"border-r border-border/30"),children:k?e.jsxs("div",{className:"flex justify-center gap-1.5",children:[e.jsx("div",{className:"flex flex-col items-center min-w-[32px]",children:e.jsx("span",{className:"text-xs text-muted-foreground",children:"-"})}),k.map((B,I)=>e.jsx("div",{className:"flex flex-col items-center min-w-[32px]",children:e.jsx("span",{className:"text-xs font-semibold",children:B.cooldown!==""?`${B.cooldown}${c.common.seconds}`:"-"})},I))]}):e.jsx("span",{className:"text-xs text-muted-foreground",children:"-"})},A.id)}),n&&e.jsx(_,{className:"p-2 text-center border-l border-border/30",children:e.jsx("div",{className:"w-full h-full min-h-[32px]"})})]},x.level))]})]})})}),b&&n&&s&&e.jsx(De,{championList:s,selectedChampions:t,onSelect:x=>{n(x)},onClose:()=>w(!1)})]})})}function Tr({champions:t,version:r,vsMode:s}){var w,C;const{t:n}=Q(),{cdragonVersion:a,setCDragonVersion:i}=nt(),[u,c]=J.useState({});J.useEffect(()=>{const j=async()=>{try{const y=await Pt(t,r);if(c(y),!a)try{let m=null;for(const o of Object.keys(y)){const l=y[o];if(l&&l.length>0&&(m=l[0].cdragonVersion??null,m))break}m&&i(m)}catch(m){O.warn("Failed to extract CDragon version from integrated spell data (mobile):",m)}}catch(y){O.warn("Failed to load integrated spell data:",y),c({})}};t.length>0&&j()},[t,r]);const p=J.useMemo(()=>Math.max(...t.map(j=>j.spells?Math.max(...j.spells.map(y=>y.maxrank)):0)),[t]),g=J.useCallback((j,y)=>{const m=u[j];return!m||m.length<=y?null:m[y]},[u]),b=J.useMemo(()=>Array.from({length:p},(j,y)=>{const m=y+1;return{level:m,skills:t.map(o=>o.spells?o.spells.map((l,f)=>{const v=g(o.id,f),d=_t(l,m,v);return{skill:l,cooldown:d}}):null)}}),[t,p,g]);if(s&&t.length===2){const j=s.championA,y=s.championB;return e.jsx(He,{delayDuration:0,skipDelayDuration:150,children:e.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:e.jsx("div",{className:"min-w-full",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"border border-border/30 rounded-lg overflow-hidden",children:e.jsxs(me,{className:"border-collapse table-fixed w-auto min-w-full",children:[e.jsx(fe,{children:e.jsxs(q,{className:"border-b border-border/30 select-none",children:[e.jsx(K,{className:"text-left p-1.5 pl-2 text-[10px] font-semibold text-foreground sticky left-0 bg-card z-20 w-[50px] min-w-[50px] border-r border-border/30 select-none",style:{left:0},children:n.common.level}),e.jsx(K,{className:"text-center p-1.5 text-[10px] font-semibold text-foreground w-[calc((100%-90px)/2)] min-w-[100px] border-r border-border/30 select-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-0.5",children:[e.jsx("img",{src:X(r,j.id),alt:j.name,className:"w-6 h-6 rounded-full",draggable:"false"}),e.jsx("div",{className:"text-xs font-semibold leading-tight text-center text-foreground",children:j.name})]})}),e.jsx(K,{className:"text-center p-1.5 text-[10px] font-semibold text-foreground w-[40px] min-w-[40px] border-r border-border/30 bg-muted/20 select-none",children:e.jsx("div",{className:"text-[9px] font-bold",children:"VS"})}),e.jsx(K,{className:"text-center p-1.5 text-[10px] font-semibold text-foreground w-[calc((100%-90px)/2)] min-w-[100px] select-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-0.5",children:[e.jsx("img",{src:X(r,y.id),alt:y.name,className:"w-6 h-6 rounded-full",draggable:"false"}),e.jsx("div",{className:"text-xs font-semibold leading-tight text-center text-foreground",children:y.name})]})})]})}),e.jsxs(xe,{children:[e.jsxs(q,{className:"border-b-2 border-border/30 bg-muted/30 select-none",children:[e.jsx(_,{className:"p-1.5 pl-2 text-[10px] font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",style:{left:0},children:n.skills.label}),e.jsx(_,{className:"p-1.5 border-r border-border/30",children:e.jsxs("div",{className:"flex justify-center gap-0.5",children:[j.passive&&e.jsx(ie,{isPassive:!0,passiveName:j.passive.name,passiveDescription:j.passive.description,passiveImageFull:j.passive.image.full,skill:{},skillIdx:0,version:r,size:"small"}),(w=j.spells)==null?void 0:w.map((m,o)=>{const l=g(j.id,o);return e.jsx(ie,{skill:m,skillIdx:o,version:r,spellData:l,size:"small"},m.id)})]})}),e.jsx(_,{className:"p-1.5 border-r border-border/30 bg-muted/20 select-none"}),e.jsx(_,{className:"p-1.5",children:e.jsxs("div",{className:"flex justify-center gap-0.5",children:[y.passive&&e.jsx(ie,{isPassive:!0,passiveName:y.passive.name,passiveDescription:y.passive.description,passiveImageFull:y.passive.image.full,skill:{},skillIdx:0,version:r,size:"small"}),(C=y.spells)==null?void 0:C.map((m,o)=>{const l=g(y.id,o);return e.jsx(ie,{skill:m,skillIdx:o,version:r,spellData:l,size:"small"},m.id)})]})})]}),b.map((m,o)=>{const l=m.skills[0],f=m.skills[1];return e.jsxs(q,{className:"border-b border-border/30 hover:bg-muted/30 transition-colors",children:[e.jsxs(_,{className:E("p-1.5 pl-2 text-[10px] font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",o===b.length-1&&"rounded-bl-lg"),style:{left:0},children:[m.level,n.common.level]}),e.jsx(_,{className:"p-1.5 border-r border-border/30",children:l?e.jsxs("div",{className:"flex justify-center gap-0.5",children:[e.jsx("div",{className:"flex flex-col items-center min-w-[20px]",children:e.jsx("span",{className:"text-[9px] text-muted-foreground",children:"-"})}),l.map((v,d)=>e.jsx("div",{className:"flex flex-col items-center min-w-[20px]",children:e.jsx("span",{className:"text-[9px] font-semibold",children:v.cooldown!==""?`${v.cooldown}${n.common.seconds}`:"-"})},d))]}):e.jsx("span",{className:"text-[9px] text-muted-foreground",children:"-"})}),e.jsx(_,{className:"p-1.5 border-r border-border/30 bg-muted/20 select-none"}),e.jsx(_,{className:"p-1.5",children:f?e.jsxs("div",{className:"flex justify-center gap-0.5",children:[e.jsx("div",{className:"flex flex-col items-center min-w-[20px]",children:e.jsx("span",{className:"text-[9px] text-muted-foreground",children:"-"})}),f.map((v,d)=>e.jsx("div",{className:"flex flex-col items-center min-w-[20px]",children:e.jsx("span",{className:"text-[9px] font-semibold",children:v.cooldown!==""?`${v.cooldown}${n.common.seconds}`:"-"})},d))]}):e.jsx("span",{className:"text-[9px] text-muted-foreground",children:"-"})})]},m.level)})]})]})})})})})})}return e.jsx(He,{delayDuration:0,skipDelayDuration:150,children:e.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:e.jsx("div",{className:"min-w-full",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"border border-border/30 rounded-lg overflow-hidden",children:e.jsxs(me,{className:"border-collapse table-fixed w-auto min-w-full",children:[e.jsx(fe,{children:e.jsxs(q,{className:"border-b border-border/30 select-none",children:[e.jsx(K,{className:"text-left p-2 pl-3 text-xs font-semibold text-foreground sticky left-0 bg-card z-20 w-[60px] min-w-[60px] border-r border-border/30 select-none",style:{left:0},children:n.common.level}),t.map(j=>e.jsx(K,{className:"text-center p-2 text-xs font-semibold text-foreground w-full select-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-1",children:[e.jsx("img",{src:X(r,j.id),alt:j.name,className:"w-8 h-8 rounded-full",draggable:"false"}),e.jsx("div",{className:"text-sm font-semibold leading-tight text-center text-foreground",children:j.name})]})},j.id))]})}),e.jsxs(xe,{children:[e.jsxs(q,{className:"border-b-2 border-border/30 bg-muted/30 select-none",children:[e.jsx(_,{className:"p-2 pl-3 text-xs font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",style:{left:0},children:n.skills.label}),t.map(j=>{var y;return e.jsx(_,{className:"p-2",children:e.jsxs("div",{className:"flex justify-center gap-1",children:[j.passive&&e.jsx(ie,{isPassive:!0,passiveName:j.passive.name,passiveDescription:j.passive.description,passiveImageFull:j.passive.image.full,skill:{},skillIdx:0,version:r}),(y=j.spells)==null?void 0:y.map((m,o)=>{const l=g(j.id,o);return e.jsx(ie,{skill:m,skillIdx:o,version:r,spellData:l},m.id)})]})},j.id)})]}),b.map((j,y)=>e.jsxs(q,{className:"border-b border-border/30 hover:bg-muted/30 transition-colors",children:[e.jsxs(_,{className:E("p-2 pl-3 text-xs font-medium sticky left-0 bg-card z-20 border-r border-border/30 select-none",y===b.length-1&&"rounded-bl-lg"),style:{left:0},children:[j.level,n.common.level]}),j.skills.map((m,o)=>e.jsx(_,{className:"p-2",children:m?e.jsxs("div",{className:"flex justify-center gap-1",children:[e.jsx("div",{className:"flex flex-col items-center min-w-[24px]",children:e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"-"})}),m.map((l,f)=>e.jsx("div",{className:"flex flex-col items-center min-w-[24px]",children:e.jsx("span",{className:"text-[10px] font-semibold",children:l.cooldown!==""?`${l.cooldown}${n.common.seconds}`:"-"})},f))]}):e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"-"})},t[o].id))]},j.level))]})]})})})})})})}function Vr({champions:t,version:r,activeTab:s,championList:n,onAddChampion:a,onRemoveChampion:i,onReorderChampions:u,vsMode:c}){const p=tt();if(t.length===0)return null;const g=p==="mobile";return e.jsx(rt,{children:e.jsx(st,{className:"p-0",children:s==="stats"?g?e.jsx(pr,{champions:t,version:r,championList:n,onAddChampion:a,onRemoveChampion:i,vsMode:c}):e.jsx(xr,{champions:t,version:r,championList:n,onAddChampion:a,onRemoveChampion:i,onReorderChampions:u}):g?e.jsx(Tr,{champions:t,version:r,championList:n,onAddChampion:a,onRemoveChampion:i,vsMode:c}):e.jsx(kr,{champions:t,version:r,championList:n,onAddChampion:a,onRemoveChampion:i,onReorderChampions:u})})})}const Pr=J.memo(Vr),$r=()=>`tab-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;function Ar({version:t,initialTabs:r,initialSelectedTabId:s}){const[n,a]=h.useState([]),i=h.useRef([]),[u,c]=h.useState(null),[p,g]=h.useState(!1),[b,w]=h.useState(null);h.useEffect(()=>{i.current=n},[n]),h.useEffect(()=>{t&&(r&&r.length>0&&a(r),s&&c(s))},[t,r,s]),h.useEffect(()=>{!u&&n.length>0&&c(n[0].id)},[n,u]),h.useEffect(()=>{u&&!n.find(f=>f.id===u)&&c(n.length>0?n[0].id:null)},[n,u]);const C=h.useCallback(f=>{a(v=>{const d=v.findIndex(x=>x.id===f),N=v.filter(x=>x.id!==f);return c(x=>{if(x&&x!==f&&N.some(A=>A.id===x))return x;if(N.length===0)return null;const S=d>0?d-1:0;return(N[S]??N[0]).id}),N})},[c]),j=h.useCallback(f=>{a(v=>[...v,f]),c(f.id)},[]),y=h.useCallback((f,v)=>{a(d=>d.map(N=>N.id===f?v(N):N))},[]),m=h.useCallback((f,v)=>{a(d=>{const N=d.findIndex(S=>S.id===f);if(N===-1)return[...d,v];const x=[...d];return x[N]=v,x}),c(v.id)},[]),o=h.useCallback(()=>{a([]),c(null),le($e),le(Ae)},[]),l=h.useCallback(f=>{const{active:v,over:d}=f;d&&v.id!==d.id&&a(N=>{const x=N.findIndex(k=>k.id===v.id),S=N.findIndex(k=>k.id===d.id);return x===-1||S===-1?N:jt(N,x,S)})},[]);return{tabs:n,setTabs:a,tabsRef:i,selectedTabId:u,setSelectedTabId:c,showVsSelector:p,setShowVsSelector:g,vsSelectorMode:b,setVsSelectorMode:w,removeTab:C,addTab:j,updateTab:y,replaceTab:m,resetTabs:o,handleDragEnd:l,generateTabId:$r}}function Er({version:t,lang:r,championList:s,tabs:n,initialSelectedChampions:a}){const[i,u]=h.useState([]),[c,p]=h.useState(!0);h.useEffect(()=>{if(!t||!s){setTimeout(()=>{p(!1)},0);return}try{if(a&&a.length>0){const m=a.map(o=>{const l=s.find(f=>f.id===o.id||f.key===o.key);return l?{...l,isLoading:!1}:null}).filter(o=>o!==null);m.length>0&&setTimeout(()=>{u(m),m.forEach(o=>{o.id&&(u(l=>l.map(f=>f.id===o.id?{...f,isLoading:!0}:f)),dt(t,r,o.id).then(l=>{u(f=>f.map(v=>v.id===o.id?{...v,fullInfo:l,isLoading:!1}:v))}).catch(l=>{O.error("Failed to load champion info:",l),u(f=>f.map(v=>v.id===o.id?{...v,isLoading:!1}:v))}))})},0)}setTimeout(()=>{p(!1)},0)}catch(m){O.error("Failed to load initial selected champions:",m),setTimeout(()=>{p(!1)},0)}},[t,r,s,a]),h.useEffect(()=>{s&&i.length>0&&setTimeout(()=>{u(m=>m.map(o=>{const l=s.find(f=>f.id===o.id||f.key===o.key);return l?{...o,name:l.name,title:l.title}:o}))},0)},[s,i.length]),h.useEffect(()=>{c||setTimeout(()=>{const m=new Set(n.flatMap(o=>o.champions));u(o=>{if(n.length===0)return o.length>0?[]:o;const l=o.filter(f=>m.has(f.id));return l.length!==o.length?l:o})},0)},[n,c]);const g=h.useCallback(m=>{t&&(u(o=>o.map(l=>l.id===m?{...l,isLoading:!0}:l)),dt(t,r,m).then(o=>{u(l=>l.map(f=>f.id===m?{...f,fullInfo:o,isLoading:!1,skinIndex:0}:f))}).catch(o=>{O.error("Failed to load champion info:",o),u(l=>l.map(f=>f.id===m?{...f,isLoading:!1}:f))}))},[t,r]),b=h.useCallback(m=>{u(o=>{if(o.some(v=>v.id===m.id))return o;const f={...m,isLoading:!0,skinIndex:0};return g(m.id),[...o,f]})},[g]),w=h.useCallback(m=>{u(o=>o.filter(l=>l.id!==m))},[]),C=h.useCallback(()=>{u([]),le(Ee)},[]),j=h.useMemo(()=>i.filter(m=>m.fullInfo&&!m.isLoading),[i]),y=h.useMemo(()=>{const m=new Set(n.filter(o=>o.mode==="normal").flatMap(o=>o.champions));return i.filter(o=>m.has(o.id))},[n,i]);return{selectedChampions:i,setSelectedChampions:u,championsWithFullInfo:j,normalTabChampions:y,addChampionToList:b,removeChampion:w,resetChampions:C,loadChampionInfo:g}}function Lr({onAddClick:t}){const{t:r}=Q();return e.jsx(rt,{className:"border-dashed",children:e.jsxs(st,{className:"flex flex-col items-center justify-center py-12 md:py-16",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-muted/50 flex items-center justify-center mb-4",children:e.jsx(ke,{className:"w-8 h-8 text-muted-foreground"})}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:r.encyclopedia.emptyState.title}),e.jsx("p",{className:"text-muted-foreground text-center max-w-md text-sm mb-4",children:r.encyclopedia.emptyState.description}),e.jsxs(ae,{onClick:t,variant:"outline",className:"flex flex-row items-center justify-center gap-2 border-2 border-dashed border-muted-foreground/30 hover:border-primary/50 hover:bg-muted/30 group",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-muted/30 flex items-center justify-center group-hover:bg-primary/10 transition-colors",children:e.jsx(Be,{className:"w-4 h-4 text-muted-foreground group-hover:text-primary transition-colors"})}),e.jsx("span",{className:"text-sm text-muted-foreground group-hover:text-primary transition-colors",children:r.encyclopedia.emptyState.addButton})]})]})})}const Rr=Yt,It=h.forwardRef(({className:t,...r},s)=>e.jsx(Nt,{ref:s,className:E("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...r}));It.displayName=Nt.displayName;const We=h.forwardRef(({className:t,...r},s)=>e.jsx(vt,{ref:s,className:E("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-0 focus-visible:ring-offset-0 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...r}));We.displayName=vt.displayName;const Br=h.forwardRef(({className:t,...r},s)=>e.jsx(yt,{ref:s,className:E("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r}));Br.displayName=yt.displayName;function _r({activeTab:t,onTabChange:r,onReset:s}){const{t:n}=Q();return e.jsxs("div",{className:"flex items-center justify-between gap-2 border-b border-border overflow-x-auto -mx-4 md:mx-0 px-4 md:px-0",children:[e.jsx(Rr,{value:t,onValueChange:a=>r(a),className:"flex-1",children:e.jsxs(It,{className:"inline-flex h-auto items-center justify-start gap-2 bg-transparent p-0 border-0",children:[e.jsx(We,{value:"skills",className:"px-4 py-2 text-sm font-medium transition-colors border-b-2 border-transparent text-muted-foreground hover:text-foreground data-[state=active]:border-primary data-[state=active]:text-primary data-[state=active]:bg-transparent rounded-none shadow-none",children:n.encyclopedia.tabs.skills}),e.jsx(We,{value:"stats",className:"px-4 py-2 text-sm font-medium transition-colors border-b-2 border-transparent text-muted-foreground hover:text-foreground data-[state=active]:border-primary data-[state=active]:text-primary data-[state=active]:bg-transparent rounded-none shadow-none",children:n.encyclopedia.tabs.stats})]})}),e.jsx("div",{className:"flex items-center gap-2 shrink-0",children:e.jsxs(ae,{variant:"ghost",size:"sm",onClick:s,className:"flex items-center gap-1.5 shrink-0 text-muted-foreground hover:text-primary hover:bg-muted/30 border-0",children:[e.jsx(rr,{className:"h-3 w-3"}),e.jsx("span",{className:"text-[10px]",children:n.encyclopedia.reset})]})})]})}const Mt="flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-medium transition-colors shrink-0 relative select-none",Ft="bg-primary text-primary-foreground",zt="bg-muted/50 text-muted-foreground",Ot="touch-none cursor-grab active:cursor-grabbing p-0.5 -ml-1 mr-0.5 opacity-60 hover:opacity-100 transition-opacity select-none",Kt="ml-1 p-0.5 rounded-full hover:bg-muted/50 active:bg-muted transition-colors shrink-0 select-none group",Dr="ml-1 p-1 rounded-full hover:bg-muted/50 active:bg-muted transition-colors shrink-0 select-none group";function Ir({tab:t,champion:r,version:s,selectedTabId:n,onSelect:a,onRemove:i,onVsClick:u}){const{t:c}=Q(),{attributes:p,listeners:g,setNodeRef:b,transform:w,transition:C,isDragging:j}=je({id:t.id}),y={transform:Ne.Transform.toString(w),transition:C,opacity:j?.5:1},m=n===t.id,o=m?Ft:zt;return e.jsxs("div",{ref:b,style:y,"data-tab-id":t.id,className:E(Mt,o,j&&"z-50"),onClick:l=>{const f=l.target;f.tagName==="BUTTON"||f.closest("button")||a(t.id)},children:[e.jsx("button",{...p,...g,className:Ot,"aria-label":"Drag to reorder",children:e.jsx(_e,{className:"h-3 w-3 pointer-events-none select-none"})}),e.jsxs("div",{className:"flex items-center gap-1.5 flex-1 cursor-pointer select-none",children:[e.jsx("img",{src:X(s,r.id),alt:r.name,className:"w-5 h-5 rounded-full pointer-events-none select-none",draggable:"false"}),e.jsx("span",{className:"pointer-events-none select-none",children:r.name})]}),e.jsx("button",{onClick:l=>{l.preventDefault(),l.stopPropagation(),u(t.id)},className:Dr,"aria-label":`${c.encyclopedia.vs} with ${r.name}`,title:c.encyclopedia.vsStart,type:"button",children:e.jsx(Le,{className:E("h-3 w-3 transition-colors",m?"text-primary-foreground":"text-muted-foreground")})}),e.jsx("button",{onClick:l=>{l.preventDefault(),l.stopPropagation(),i(t.id)},className:Kt,"aria-label":`Remove ${r.name}`,type:"button",children:e.jsx(ve,{className:E("h-3 w-3 transition-colors",m?"text-primary-foreground":"text-muted-foreground")})})]})}function Mr({tab:t,championA:r,championB:s,version:n,selectedTabId:a,onSelect:i,onRemove:u,onChangeChampionA:c,onChangeChampionB:p}){const{t:g}=Q(),{attributes:b,listeners:w,setNodeRef:C,transform:j,transition:y,isDragging:m}=je({id:t.id}),o={transform:Ne.Transform.toString(j),transition:y,opacity:m?.5:1},l=a===t.id,f=l?Ft:zt;return e.jsxs("div",{ref:C,style:o,"data-tab-id":t.id,className:E(Mt,f,m&&"z-50"),children:[e.jsx("button",{...b,...w,className:Ot,"aria-label":"Drag to reorder",children:e.jsx(_e,{className:"h-3 w-3 pointer-events-none select-none"})}),e.jsxs("div",{className:"flex items-center gap-1.5 flex-1 select-none",children:[e.jsx("button",{onClick:v=>{v.preventDefault(),v.stopPropagation(),c(t.id)},className:"flex items-center touch-none hover:opacity-80 transition-opacity select-none",children:e.jsx("img",{src:X(n,r.id),alt:r.name,className:"w-5 h-5 rounded-full select-none pointer-events-none",draggable:"false"})}),e.jsx("button",{onClick:()=>{i(t.id)},className:"text-[10px] font-semibold touch-none select-none",children:g.encyclopedia.vs}),e.jsx("button",{onClick:v=>{v.preventDefault(),v.stopPropagation(),p(t.id)},className:"flex items-center touch-none hover:opacity-80 transition-opacity select-none",children:e.jsx("img",{src:X(n,s.id),alt:s.name,className:"w-5 h-5 rounded-full select-none pointer-events-none",draggable:"false"})})]}),e.jsx("button",{onClick:v=>{v.preventDefault(),v.stopPropagation(),u(t.id)},className:Kt,"aria-label":"Remove VS tab",children:e.jsx(ve,{className:E("h-3 w-3 transition-colors",l?"text-primary-foreground":"text-muted-foreground")})})]})}function Fr({tabs:t,championsWithFullInfo:r,version:s,selectedTabId:n,sensors:a,onDragEnd:i,onSelectTab:u,onRemoveTab:c,onVsClick:p,onChangeChampionA:g,onChangeChampionB:b,onAddClick:w}){const{t:C}=Q(),j=h.useRef(null),y=h.useRef(t.length),m=h.useRef(!1),o=h.useRef((l=!0)=>{if(!j.current||!n)return;const f=j.current.querySelector("[data-radix-scroll-area-viewport]");if(!f)return;const v=f.querySelector(`[data-tab-id="${n}"]`);if(v){const d=v.offsetLeft,N=v.offsetWidth,x=f.offsetWidth,S=d-x/2+N/2;l?f.scrollTo({left:Math.max(0,S),behavior:"smooth"}):f.scrollLeft=Math.max(0,S)}});return h.useEffect(()=>{!m.current&&n&&t.length>0&&(m.current=!0,requestAnimationFrame(()=>{requestAnimationFrame(()=>{o.current(!1)})}))},[n,t.length]),h.useEffect(()=>{if(!j.current)return;const l=j.current.querySelector("[data-radix-scroll-area-viewport]");l&&(t.length>y.current&&l.scrollTo({left:l.scrollWidth,behavior:"smooth"}),y.current=t.length)},[t.length]),h.useEffect(()=>{if(m.current&&n){const l=setTimeout(()=>{o.current(!0)},100);return()=>clearTimeout(l)}},[n]),e.jsx("div",{className:"border-b border-border -mx-4 px-4",children:e.jsxs("div",{className:"flex items-center gap-2 pb-2",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground shrink-0 pl-3",children:C.encyclopedia.champion}),e.jsxs(Tt,{ref:j,type:"scroll",className:"flex-1",children:[e.jsx(Je,{sensors:a,collisionDetection:Xe,onDragEnd:i,children:e.jsx(Qe,{items:t.map(l=>l.id),strategy:et,children:e.jsxs("div",{className:"flex items-center gap-2 w-max select-none pr-2",children:[t.map(l=>{if(l.mode==="vs"){const f=r.find(d=>d.id===l.champions[0]),v=r.find(d=>d.id===l.champions[1]);return!f||!v?null:e.jsx(Mr,{tab:l,championA:f,championB:v,version:s,selectedTabId:n,onSelect:u,onRemove:c,onChangeChampionA:g,onChangeChampionB:b},l.id)}else{const f=r.find(v=>v.id===l.champions[0]);return f?e.jsx(Ir,{tab:l,champion:f,version:s,selectedTabId:n,onSelect:u,onRemove:c,onVsClick:p},l.id):null}}),e.jsxs(ae,{onClick:w,variant:"outline",size:"sm",className:"flex items-center gap-1.5 shrink-0 border-2 border-dashed border-muted-foreground/30 hover:border-primary hover:bg-primary/10 hover:text-primary h-auto py-1.5 px-3 transition-colors",children:[e.jsx(Be,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs",children:C.encyclopedia.add})]})]})})}),e.jsx(er,{orientation:"horizontal"})]})]})})}function zr({open:t,vsSelectorMode:r,tabs:s,championList:n,selectedChampions:a,onSelect:i,onClose:u,onOpenChange:c}){const{t:p}=Q();if(!t||!r)return null;const g=s.find(w=>w.id===r.tabId);if(!g||r.mode!=="select-second"&&g.mode!=="vs")return null;const b=r.mode==="change-champion-a"?g.champions[1]:g.champions[0];return b?e.jsx(De,{championList:n,selectedChampions:a,onSelect:i,onClose:u,open:t,onOpenChange:c,vsMode:{currentChampionId:b,title:p.encyclopedia.selectOpponent}}):null}function Pe(t){if(!t)return null;const r=t.split(".");return r.length>=2?`${r[0]}.${r[1]}`:t}function Or({lang:t,championList:r,version:s,cdragonVersion:n,initialSelectedChampions:a,initialTabs:i,initialSelectedTabId:u}){const[c,p]=h.useState("skills"),[g,b]=h.useState(!1),C=tt()==="mobile",{cdragonVersion:j}=nt(),{t:y}=Q(),{tabs:m,tabsRef:o,selectedTabId:l,setSelectedTabId:f,showVsSelector:v,setShowVsSelector:d,vsSelectorMode:N,setVsSelectorMode:x,removeTab:S,addTab:k,updateTab:P,replaceTab:A,resetTabs:B,handleDragEnd:I,generateTabId:M}=Ar({version:s,initialTabs:i,initialSelectedTabId:u}),{selectedChampions:z,setSelectedChampions:T,championsWithFullInfo:V,normalTabChampions:D,addChampionToList:L,removeChampion:R,resetChampions:F}=Er({version:s,lang:t,championList:r,tabs:m,initialSelectedChampions:a}),G=h.useCallback(()=>{try{if(z.length>0){const $=z.map(({id:W,key:se})=>({id:W,key:se}));Fe(Ee,JSON.stringify($))}else le(Ee);m.length>0?Fe($e,JSON.stringify(m)):le($e),l?Fe(Ae,l):le(Ae)}catch($){O.error("Failed to persist encyclopedia state to storage:",$)}},[z,m,l]),ee=qe(be(Ye,{activationConstraint:{distance:12}}),be(Ze,{coordinateGetter:Ue})),te=h.useCallback(($,W)=>{T(se=>jt(se,$,W))},[T]),ne=h.useCallback($=>{if(new Set(z.map(de=>de.id)).has($.id)){const de=o.current,U=de.some(Z=>Z.mode==="normal"&&Z.champions.length===1&&Z.champions[0]===$.id),Ve=de.some(Z=>Z.mode==="vs"&&Z.champions.includes($.id));if(U){const Z=m.find(Ie=>Ie.mode==="normal"&&Ie.champions.length===1&&Ie.champions[0]===$.id);Z&&S(Z.id),Ve||R($.id);return}if(Ve){const Z={mode:"normal",champions:[$.id],id:M()};k(Z);return}const at=m.find(Z=>Z.mode==="normal"&&Z.champions.length===1&&Z.champions[0]===$.id);at&&S(at.id),R($.id);return}L($);const se={mode:"normal",champions:[$.id],id:M()};k(se)},[z,m,o,L,R,k,S,M]),Te=h.useCallback(()=>{F(),B(),le(Ee),le($e),le(Ae)},[F,B]),pe=h.useCallback($=>{if(!N)return;const{mode:W,tabId:se}=N,de=m.find(U=>U.id===se);if(de){if(W==="select-second"){const U={mode:"vs",champions:[de.champions[0],$.id],id:M()};A(se,U),z.some(Ve=>Ve.id===$.id)||L($)}else W==="change-champion-a"?(P(se,U=>({...U,champions:[$.id,U.champions[1]]})),z.some(U=>U.id===$.id)||L($)):W==="change-champion-b"&&(P(se,U=>({...U,champions:[U.champions[0],$.id]})),z.some(U=>U.id===$.id)||L($));d(!1),x(null)}},[N,m,z,L,P,A,M]),H=h.useMemo(()=>l&&m.find($=>$.id===l)||null,[l,m]),re=h.useMemo(()=>H?H.champions.map($=>{var W;return(W=V.find(se=>se.id===$))==null?void 0:W.fullInfo}).filter($=>$!==void 0):[],[H,V]),ge=h.useMemo(()=>!C||H&&H.mode==="vs"?null:H&&H.mode==="normal"&&re.length>0?re[0]:null,[C,H,re]),oe=h.useCallback($=>{m.forEach(W=>{W.champions.includes($)&&S(W.id)}),R($)},[m,R,S]),we=h.useCallback($=>{x({mode:"select-second",tabId:$}),d(!0)},[]),Ht=h.useCallback($=>{x({mode:"change-champion-a",tabId:$,championIndex:0}),d(!0)},[]),Gt=h.useCallback($=>{x({mode:"change-champion-b",tabId:$,championIndex:1}),d(!0)},[]),Wt=h.useMemo(()=>{const $=Pe(s),W=Pe(j);return!$||!W?!1:$!==W},[s,j]);return e.jsxs("div",{className:"w-full max-w-7xl mx-auto px-4 md:px-6 lg:px-8 py-4 md:py-5",children:[Wt&&e.jsxs("div",{className:"mb-3 md:mb-4 rounded-md border border-amber-400/60 bg-amber-50/90 px-3 py-2 text-xs md:text-sm text-amber-950 shadow-sm",children:[e.jsx("div",{className:"font-semibold mb-0.5",children:y.versionNotice.title}),e.jsx("div",{className:"text-[11px] md:text-xs text-amber-900/90 mb-1.5",children:y.versionNotice.description}),e.jsxs("div",{className:"flex flex-wrap gap-x-3 gap-y-0.5 text-[10px] md:text-[11px] text-amber-900/80",children:[e.jsxs("span",{children:[e.jsxs("span",{className:"font-semibold",children:[y.versionNotice.cdragonLabel,":"]})," ",Pe(j)??"-"]}),e.jsxs("span",{children:[e.jsxs("span",{className:"font-semibold",children:[y.versionNotice.ddragonLabel,":"]})," ",Pe(s)??"-"]})]})]}),g&&e.jsx(De,{championList:r,selectedChampions:D,onSelect:ne,onClose:()=>{b(!1),G()},open:g,onOpenChange:$=>{b($),$||G()}}),e.jsx(zr,{open:v,vsSelectorMode:N,tabs:m,championList:r,selectedChampions:z,onSelect:pe,onClose:()=>{d(!1),x(null),G()},onOpenChange:$=>{d($),$||(x(null),G())}}),z.length>0&&V.length>0&&e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsx(_r,{activeTab:c,onTabChange:p,onReset:Te}),C&&m.length>0&&e.jsx(Fr,{tabs:m,championsWithFullInfo:V,version:s,selectedTabId:l,sensors:ee,onDragEnd:I,onSelectTab:f,onRemoveTab:S,onVsClick:we,onChangeChampionA:Ht,onChangeChampionB:Gt,onAddClick:()=>b(!0)}),e.jsx(Pr,{champions:C&&H&&H.mode==="vs"&&re.length===2?re:C&&ge?[ge]:V.map($=>$.fullInfo),version:s,activeTab:c,championList:r,onAddChampion:C?void 0:ne,onRemoveChampion:oe,onReorderChampions:C?void 0:te,vsMode:C&&H&&H.mode==="vs"&&re.length===2?{championA:re[0],championB:re[1]}:void 0})]}),z.length===0&&e.jsx(Lr,{onAddClick:()=>b(!0)})]})}function Wr(t){return e.jsx(Sr,{initialDDragonVersion:t.version,initialCDragonVersion:t.cdragonVersion,children:e.jsx(Or,{...t})})}export{Wr as default};
